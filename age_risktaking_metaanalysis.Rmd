---
title: "Age differences in risk-taking propensity: A coordinated analysis of longitudinal panels"

author:
  - name: Yunrui Liu
    url: https://psychologie.unibas.ch/de/personen/liu-yunrui/
    affiliation: Center for Cognitive and Decision Sciences, University of Basel
    affiliation_url: https://psychologie.unibas.ch/de/fakultaet/abteilungen/cognitive-and-decision-sciences-305/
  - name: Alexandra Bagaïni
    url: https://psychologie.unibas.ch/de/personen/bagaini-alexandra/
    affiliation: Center for Cognitive and Decision Sciences, University of Basel
    affiliation_url: https://psychologie.unibas.ch/de/fakultaet/abteilungen/cognitive-and-decision-sciences-305/
  - name: Madlaina Kapoor
    url: https://psychologie.unibas.ch/de/personen/kapoor-madlaina/
    affiliation: Center for Cognitive and Decision Sciences, University of Basel
    affiliation_url: https://psychologie.unibas.ch/de/fakultaet/abteilungen/cognitive-and-decision-sciences-305/
  - name:  Gayoung Son
    url: https://psychologie.unibas.ch/de/personen/gayoung-son/
    affiliation: Center for Cognitive and Decision Sciences, University of Basel
    affiliation_url: https://psychologie.unibas.ch/de/fakultaet/abteilungen/cognitive-and-decision-sciences-305/
  - name:  Rui Mata
    url: https://psychologie.unibas.ch/de/personen/rui-mata/
    affiliation: Center for Cognitive and Decision Sciences, University of Basel
    affiliation_url: https://psychologie.unibas.ch/de/fakultaet/abteilungen/cognitive-and-decision-sciences-305/

output: 
      html_document:
        number_sections: FALSE
        toc: true
        toc_float: true
        theme: cerulean
        df_print: paged
---
        
```{r setup, include=FALSE}
library(tidyverse)
library(metafor)
library(ggplot2)
library(gridExtra)
library(grid)
library(latex2exp)
library(DT)
knitr::opts_chunk$set(echo = FALSE)
```
<div style="margin-bottom:40px;">
</div>

## 1. Overview of the project 

&nbsp; &nbsp;&nbsp; &nbsp; How does risk-taking propensity change across the life span? We contribute to answering this question using a coordinated analysis of longitudinal panels and obtaining meta-analytic estimates of age differences in risk-taking propensity across several domains. Specifically, we report results from 10 longitudinal panels (166'523 unique respondents) covering general and domain-specific risk-taking propensity (financial, driving, recreational, occupational, health, social) across three or more waves spanning up to 28 years. The meta-analytic results revealed a negative relation between age and both general and domain-specific risk-taking propensity. Age differences, however, were more pronounced in specific domains, with age showing larger negative effects in the recreational and occupational domains. This work suggests there is need to understand the domain-specific nature of age differences in risk-taking propensity across the life span.

&nbsp; &nbsp;&nbsp; &nbsp;The following document contains results from all analyses conducted for the manuscript entitled “Age differences in risk-taking propensity: A coordinated analysis of longitudinal panels”. This document is organized by different domains of risk-taking propensity, including general, financial, driving, recreational, occupational, health and social domains. For each risk-taking propensity, we create 7 models (comprising intercept-only model, fixed-effect model, linear model, linear with gender model, linear with gender interaction model, quadratic model and quadratic with gender model) and provide a table summarizing individual study model results, the meta-analytic results and  trajectory plots. We also tested individual predictors that are not included in the simple trajectory model in meta-regression: continent, mean age and scale range. The results from these models are available below. The code used to compile this file is available in the Github repository (https://github.com/cdsbasel/ageriskmeta).

<div style="margin-bottom:40px;">
</div>

## 2. Overview of panel data 

### 2.1 Number of observations
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 16, fig.height = 10,  fig.cap = "Figure: Total number of observations by sample.", fig.align="center"}

setwd("../data/process_z_data")

panels <- c("DHS","GCOE_Japan","GCOE_USA","HILDA","HRS","LIKS","PHF","SAVE","SHARE_Austria","SHARE_Belgium","SHARE_Czech_Republic","SHARE_Denmark", "SHARE_Estonia", "SHARE_France", "SHARE_Germany","SHARE_Israel", "SHARE_Italy","SHARE_Netherlands","SHARE_Slovenia","SHARE_Spain","SHARE_Sweden","SHARE_Switzerland","SOEP","USoc")

# load data
for (i in 1:length(panels)) {
  data_name <- paste0(panels[i], "_process_z") 
  file_name <- paste0(panels[i], "_process_z.Rds") 
  data <- readRDS(file = file_name)
  data$panel <- panels[i]
  assign(data_name, value = data)
}

#merge data
All_data <- Reduce(function(x, y) merge(x, y, all=TRUE), list(SOEP_process_z, HRS_process_z, SAVE_process_z, DHS_process_z, PHF_process_z, SHARE_Austria_process_z, SHARE_Germany_process_z, SHARE_Sweden_process_z, SHARE_Netherlands_process_z, SHARE_Spain_process_z, SHARE_Italy_process_z, SHARE_France_process_z, SHARE_Denmark_process_z, SHARE_Switzerland_process_z, SHARE_Belgium_process_z, SHARE_Israel_process_z, SHARE_Czech_Republic_process_z, SHARE_Slovenia_process_z, SHARE_Estonia_process_z, USoc_process_z, GCOE_Japan_process_z, GCOE_USA_process_z, HILDA_process_z, LIKS_process_z))

All_data$panel <- factor(All_data$panel, levels = panels )
All_data$panel <- fct_rev(All_data$panel)

#plot
ggplot(data = All_data, aes(x = panel, fill = panel)) +
  geom_bar(width = 0.5) +
  geom_text(stat='count',aes(label=..count..), hjust=-0.2) +
  labs(x= "Sample", y= "Count, observations") +
  scale_y_continuous(breaks = c(0, 50000, 100000, 150000, 200000, 250000, 300000, 350000)) +
  coord_flip() +
  theme_minimal() +
  theme(legend.position = "none") +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(axis.text=element_text(size=14), axis.title.x = element_text(size = 22, face="bold"), axis.title.y = element_text(size = 22, face="bold"), plot.title = element_text(size=25, face="bold"))
```

<div style="margin-bottom:40px;">
  </div>
  
### 2.2 Histogram of age distributions (all observations)
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 20, fig.height = 10, fig.cap = "Figure: Histogram of age distributions (all observations) by sample.", fig.align="center"}
ggplot(data = All_data, aes(x = age_bins, fill = panel)) +
  geom_bar(width = 0.5) +
  labs(x= "Age", y= "Count, observations")+
  theme_minimal() +
  theme(axis.text=element_text(size=14), axis.title.x = element_text(size = 22, face="bold"), axis.title.y = element_text(size = 22, face="bold"), plot.title = element_text(size=25, face="bold"))
```

<div style="margin-bottom:40px;">
  </div>
  
### 2.3 Histograms and density plots for every panel {.tabset}

This section offers a detailed overview of the different samples included in the analyses of the paper *Age differences in risk-taking propensity: A coordinated analysis of longitudinal panels*.

**Each panel is described in a separate tab. We include the following:**

- **Panel name:** Full name of the panel.

- **Description:** This is a general description of the objectives of the panel.

- **Country/Countries:** Country or countries in which data are collected.

- **Waves:** Waves available in the raw data set *(not all waves were necessarily included in the data analysis as not every wave had collected data on the variables of interest)*

- **Data collection period:** Data collection period of the waves available in the raw data set.

- **Dataset(s) version number/name:** Version number(s) or name(s) or raw dataset(s).

- **Data access:** Link to directly access or request access to the raw dataset(s).

- **Age distribution:** The density of each age and the number of observations in each age-bin(s).

- **Risk-taking propensity density:** The raw score and standard Z-score risk-taking propensity density in every domain(s).
<br>
<br>

#### DHS
**Panel Name:** DNB Household Survey (DHS)

**Description:** The DNB Household Survey, undertaken by CentERdata at Tilburg University since 1993, provides annual financial information on 2,000 Dutch households. DNB Household Survey topics include: work, pensions, accommodation, mortgages, income, assets, liabilities, health, perception of personal financial situation and perception of risks.  

More information at: https://www.eui.eu/Research/Library/ResearchGuides/Economics/Statistics/DataPortal/DNB

**Country/Countries:** Netherlands

**Waves:** 1993-2020

**Data collection period:** 1993-2020

**Dataset(s) version number/name:** NA

**Data access:** https://statements.centerdata.nl/

**Age distribution**: Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
DHS_process_z$Gender[DHS_process_z$Gender == "1"] <- "Male"
DHS_process_z$Gender[DHS_process_z$Gender == "2"] <- "Female"
DHS_process_z$Gender <- as.factor(DHS_process_z$Gender)

ggplot(DHS_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(DHS_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3.5) +
  #labs(title="DHS", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
DHS_process_z_Financial <- DHS_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, Financial, Financial_z) %>%
    dplyr::filter(Financial >= 0) %>%
    dplyr::filter(Financial <= 10)

ggplot(DHS_process_z_Financial) +
  geom_histogram(aes(x=Financial, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(DHS_process_z_Financial$Financial, na.rm = TRUE), sd =sd(DHS_process_z_Financial$Financial, na.rm = TRUE))) +
  labs(x= "Financial") +
  theme_minimal()

ggplot(DHS_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(DHS_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(DHS_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```

#### GCOE_Japan
**Panel Name:** Preference Parameters Study (GCOE) Japan Sample

**Description:** The Preference Parameters Study of Osaka University is an extensive panel study in 4 different countries (Japan, United States, China and India). It aims to calculate parameters of preferences defining utility function; time preference, risk aversion, habit formation, externality, as well as sociodemographic characteristics. In China and India, surveys were conducted separately in urban and rural areas. 

The panel survey in Japan has been conducted annually since 2003 using a random sample drawn from men and women aged 20-69 years old by a self-administered placement method. Fresh samples were selected and added in respondents to the survey for wave 2004, 2006 and 2009.

More information at: https://www.iser.osaka-u.ac.jp/survey_data/eng_panelsummary.html

**Country/Countries:** Japan

**Waves:** 2004-2010

**Data collection period:** 2003-2018

**Dataset(s) version number/name:** NA

**Data access:** https://www.iser.osaka-u.ac.jp/survey_data/eng_application.html

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
GCOE_Japan_process_z$Gender[GCOE_Japan_process_z$Gender == "1"] <- "Male"
GCOE_Japan_process_z$Gender[GCOE_Japan_process_z$Gender == "2"] <- "Female"
GCOE_Japan_process_z$Gender <- as.factor(GCOE_Japan_process_z$Gender)

ggplot(GCOE_Japan_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(GCOE_Japan_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3.5) +
  #labs(title="GCOE_Japan", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*General*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
GCOE_Japan_process_z_General <- GCOE_Japan_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, General, General_z) %>%
    dplyr::filter(General >= 0) %>%
    dplyr::filter(General <= 10)

ggplot(GCOE_Japan_process_z_General) +
  geom_histogram(aes(x=General, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(GCOE_Japan_process_z_General$General, na.rm = TRUE), sd =sd(GCOE_Japan_process_z_General$General, na.rm = TRUE))) +
  labs(x= "General") +
  theme_minimal()

ggplot(GCOE_Japan_process_z_General) +
  geom_histogram(aes(x=General_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(GCOE_Japan_process_z_General$General_z, na.rm = TRUE), sd =sd(GCOE_Japan_process_z_General$General_z, na.rm = TRUE))) +
  labs(x= "General_z") +
  theme_minimal()
```

#### GCOE_USA
**Panel Name:** Preference Parameters Study (GCOE) USA Sample

**Description:** The Preference Parameters Study of Osaka University is an extensive panel study in 4 different countries (Japan, United States, China and India). It aims to calculate parameters of preferences defining utility function; time preference, risk aversion, habit formation, externality, as well as sociodemographic characteristics. In China and India, surveys were conducted separately in urban and rural areas. 

The panel survey for the GCOE USA sample has been conducted annually since 2005 using a random sample drawn from men and women aged 18-99 years old by a self-administered placement method. Fresh samples were selected and added in respondents to the survey for wave 2007, 2008 and 2009.

More information at: https://www.iser.osaka-u.ac.jp/survey_data/eng_panelsummary.html

**Country/Countries:** United States

**Waves:** 2005-2010

**Data collection period:** 2005-2013

**Dataset(s) version number/name:** NA

**Data access:** https://www.iser.osaka-u.ac.jp/survey_data/eng_application.html

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
GCOE_USA_process_z$Gender[GCOE_USA_process_z$Gender == "1"] <- "Male"
GCOE_USA_process_z$Gender[GCOE_USA_process_z$Gender == "2"] <- "Female"
GCOE_USA_process_z$Gender <- as.factor(GCOE_USA_process_z$Gender)

ggplot(GCOE_USA_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(GCOE_USA_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3.5) +
  #labs(title="GCOE_USA", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*General*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
GCOE_USA_process_z_General <- GCOE_USA_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, General, General_z) %>%
    dplyr::filter(General >= 0) %>%
    dplyr::filter(General <= 10)

ggplot(GCOE_USA_process_z_General) +
  geom_histogram(aes(x=General, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(GCOE_USA_process_z_General$General, na.rm = TRUE), sd =sd(GCOE_USA_process_z_General$General, na.rm = TRUE))) +
  labs(x= "General") +
  theme_minimal()

ggplot(GCOE_USA_process_z_General) +
  geom_histogram(aes(x=General_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(GCOE_USA_process_z_General$General_z, na.rm = TRUE), sd =sd(GCOE_USA_process_z_General$General_z, na.rm = TRUE))) +
  labs(x= "General_z") +
  theme_minimal()
```

#### HILDA
**Panel Name:** Household, Income and Labour Dynamics in Australia (HILDA)

**Description:** The Household, Income and Labour Dynamics in Australia (HILDA) Survey is a household-based panel study that collects information about economic and personal well-being, labour market dynamics and family life of participants. Since 2001, the study has been following more than 17,000 Australian participants each year.

More information at: https://melbourneinstitute.unimelb.edu.au/hilda

**Country/Countries:** Australia

**Waves:** Wave I - Wave 19

**Data collection period:** 2001-present

**Dataset(s) version number/name:** NA

**Data access:** https://melbourneinstitute.unimelb.edu.au/hilda/for-data-users

**Age distribution** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
HILDA_process_z$Gender[HILDA_process_z$Gender == "1"] <- "Male"
HILDA_process_z$Gender[HILDA_process_z$Gender == "2"] <- "Female"
HILDA_process_z$Gender <- as.factor(HILDA_process_z$Gender)

ggplot(HILDA_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(HILDA_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3.5) +
  #labs(title="HILDA", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "30%"}
HILDA_process_z_Financial <- HILDA_process_z %>%
  dplyr::select(ID, age, Gender, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

ggplot(HILDA_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(HILDA_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(HILDA_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_minimal()

ggplot(HILDA_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(HILDA_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(HILDA_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_minimal()

ggplot(HILDA_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(HILDA_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(HILDA_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```

#### HRS
**Panel Name:** Health and Retirement Study (HRS)

**Description:** The Health and Retirement Study (HRS) is a longitudinal panel study that surveys a representative sample of approximately 20,000 people in America. The target population for the first wave of the HRS was adults residing in households in the contiguous United States born between 1931 and 1941 (i.e., those who were between the ages of 51–61 in 1992 when the study began). One particular strength of the HRS sample design is the use of a steady-state sampling design: a new cohort of individuals age 51–56 is added every 6 years. Individuals and their spouses or partners are followed until their death. Data have been collected biannually since 1992.

More information at: https://hrs.isr.umich.edu/about

**Country/Countries:** United States

**Waves:** 2014-2018

**Data collection period:** 1984-present

**Dataset(s) version number/name:** Core Waves 1992-2018

**Data access:** https://hrsdata.isr.umich.edu/data-products/public-survey-data

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
HRS_process_z$Gender[HRS_process_z$Gender == "1"] <- "Male"
HRS_process_z$Gender[HRS_process_z$Gender == "2"] <- "Female"
HRS_process_z$Gender <- as.factor(HRS_process_z$Gender)

ggplot(HRS_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(HRS_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3.5) +
  #labs(title="HRS", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*General*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
HRS_process_z_General <- HRS_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, General, General_z) %>%
    dplyr::filter(General >= 0) %>%
    dplyr::filter(General <= 10)

ggplot(HRS_process_z_General) +
  geom_histogram(aes(x=General, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(HRS_process_z_General$General, na.rm = TRUE), sd =sd(HRS_process_z_General$General, na.rm = TRUE))) +
  labs(x= "General") +
  theme_minimal()

ggplot(HRS_process_z_General) +
  geom_histogram(aes(x=General_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(HRS_process_z_General$General_z, na.rm = TRUE), sd =sd(HRS_process_z_General$General_z, na.rm = TRUE))) +
  labs(x= "General_z") +
  theme_minimal()
```
<br>
*Driving*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
HRS_process_z_Driving <- HRS_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, Driving, Driving_z) %>%
    dplyr::filter(Driving >= 0) %>%
    dplyr::filter(Driving <= 10)

ggplot(HRS_process_z_Driving) +
  geom_histogram(aes(x=Driving, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(HRS_process_z_Driving$Driving, na.rm = TRUE), sd =sd(HRS_process_z_Driving$Driving, na.rm = TRUE))) +
  labs(x= "Driving") +
  theme_minimal()

ggplot(HRS_process_z_Driving) +
  geom_histogram(aes(x=Driving_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(HRS_process_z_Driving$Driving_z, na.rm = TRUE), sd =sd(HRS_process_z_Driving$Driving_z, na.rm = TRUE))) +
  labs(x= "Driving_z") +
  theme_minimal()
```
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
HRS_process_z_Financial <- HRS_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, Financial, Financial_z) %>%
    dplyr::filter(Financial >= 0) %>%
    dplyr::filter(Financial <= 10)

ggplot(HRS_process_z_Financial) +
  geom_histogram(aes(x=Financial, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(HRS_process_z_Financial$Financial, na.rm = TRUE), sd =sd(HRS_process_z_Financial$Financial, na.rm = TRUE))) +
  labs(x= "Financial") +
  theme_minimal()

ggplot(HRS_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(HRS_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(HRS_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```
<br>
*Recreational*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
HRS_process_z_Recreational <- HRS_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, Recreational, Recreational_z) %>%
    dplyr::filter(Recreational >= 0) %>%
    dplyr::filter(Recreational <= 10)

ggplot(HRS_process_z_Recreational) +
  geom_histogram(aes(x=Recreational, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(HRS_process_z_Recreational$Recreational, na.rm = TRUE), sd =sd(HRS_process_z_Recreational$Recreational, na.rm = TRUE))) +
  labs(x= "Recreational") + 
  theme_minimal()

ggplot(HRS_process_z_Recreational) +
  geom_histogram(aes(x=Recreational_z, y = ..density..), binwidth = 0.5, fill ="#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(HRS_process_z_Recreational$Recreational_z, na.rm = TRUE), sd =sd(HRS_process_z_Recreational$Recreational_z, na.rm = TRUE))) +
  labs(x= "Recreational_z") +
  theme_minimal()
```
<br>
*Occupational*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
HRS_process_z_Occupational <- HRS_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, Occupational, Occupational_z) %>%
    dplyr::filter(Occupational >= 0) %>%
    dplyr::filter(Occupational <= 10)

ggplot(HRS_process_z_Occupational) +
  geom_histogram(aes(x=Occupational, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(HRS_process_z_Occupational$Occupational, na.rm = TRUE), sd =sd(HRS_process_z_Occupational$Occupational, na.rm = TRUE))) +
  labs(x= "Occupational") + 
  theme_minimal()

ggplot(HRS_process_z_Occupational) +
  geom_histogram(aes(x=Occupational_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(HRS_process_z_Occupational$Occupational_z, na.rm = TRUE), sd =sd(HRS_process_z_Occupational$Occupational_z, na.rm = TRUE))) +
  labs(x= "Occupational_z") +
  theme_minimal() 
```
<br>
*Health*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
HRS_process_z_Health <- HRS_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, Health, Health_z) %>%
    dplyr::filter(Health >= 0) %>%
    dplyr::filter(Health <= 10)

ggplot(HRS_process_z_Health) +
  geom_histogram(aes(x=Health, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(HRS_process_z_Health$Health, na.rm = TRUE), sd =sd(HRS_process_z_Health$Health, na.rm = TRUE))) +
  labs(x= "Health") + 
  theme_minimal() 

ggplot(HRS_process_z_Health) +
  geom_histogram(aes(x=Health_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(HRS_process_z_Health$Health_z, na.rm = TRUE), sd =sd(HRS_process_z_Health$Health_z, na.rm = TRUE))) +
  labs(x= "Health_z") +
  theme_minimal() 
```


#### LIKS
**Panel Name:** Life in Kyrgyzstan (LIKS)

**Description:** The "Life in Kyrgyzstan" Study is a longitudinal survey of households and individuals in Kyrgyzstan. It tracks the same 3,000 households and 8,000 individuals over time in all seven Kyrgyz regions (oblasts) and the two cities of Bishkek and Osh. The data are representative nationally and at the regional level (East, West, North, South).
The survey interviews all adult household members about household demographics, assets, expenditure, migration, employment, agricultural markets, shocks, social networks, subjective well-being, and many other topics. Some of these topics are addressed in each wave while other topics are only addressed in selected waves. All members of the households in 2010 are tracked for each wave and new household members are added to the survey and tracked as well. The survey was first conducted in 2010 and it has been repeated four times in 2011, 2012, 2013 and 2016. The sixth wave of the LiK Study was conducted during November 2019-February 2020.

More information at: https://lifeinkyrgyzstan.org/about/

**Country/Countries:** Kyrgyzstan

**Waves:** 2010, 2011, 2012, 2013, 2016

**Data collection period:** 2010-present

**Dataset(s) version number/name:** NA

**Data access:** https://lifeinkyrgyzstan.org/data-access/

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
LIKS_process_z$Gender[LIKS_process_z$Gender == "1"] <- "Male"
LIKS_process_z$Gender[LIKS_process_z$Gender == "2"] <- "Female"
LIKS_process_z$Gender <- as.factor(LIKS_process_z$Gender)

ggplot(LIKS_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(LIKS_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3.5) +
  #labs(title="LIKS", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*General*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
LIKS_process_z_General <- LIKS_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, General, General_z) %>%
    dplyr::filter(General >= 0) %>%
    dplyr::filter(General <= 10)

ggplot(LIKS_process_z_General) +
  geom_histogram(aes(x=General, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(LIKS_process_z_General$General, na.rm = TRUE), sd =sd(LIKS_process_z_General$General, na.rm = TRUE))) +
  labs(x= "General") +
  theme_minimal()

ggplot(LIKS_process_z_General) +
  geom_histogram(aes(x=General_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(LIKS_process_z_General$General_z, na.rm = TRUE), sd =sd(LIKS_process_z_General$General_z, na.rm = TRUE))) +
  labs(x= "General_z") +
  theme_minimal()
```

#### PHF
**Panel Name:** Panel on Household Finances (PHF)

**Description:** The German Panel on Household Finances (PHF) is a panel survey on household finance and wealth in Germany, covering the balance sheet, pension, income, work life and other demographic characteristics of private households living in Germany. The first wave of the PHF was carried out in 2010/2011, the second and third wave in 2014 and 2017, respectively. In the first wave, around 3,500 randomly selected households participated, from which about 2,200 also participated in the second wave. The fourth wave was scheduled to start in spring 2021.

More information at: https://www.bundesbank.de/en/bundesbank/research/panel-on-household-finances

**Country/Countries:** Germany

**Waves:**  Wave 1-Wave 3

**Data collection period:** 2010-present

**Dataset(s) version number/name:** NA

**Data access:** https://www.bundesbank.de/en/bundesbank/research/panel-on-household-finances/data-access-and-data-protection

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
PHF_process_z$Gender <- as.numeric(PHF_process_z$Gender)
PHF_process_z$Gender[PHF_process_z$Gender == "1"] <- "Male"
PHF_process_z$Gender[PHF_process_z$Gender == "2"] <- "Female"
PHF_process_z$Gender <- as.factor(PHF_process_z$Gender)

ggplot(PHF_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(PHF_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3.5) +
  #labs(title="PHF", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*General*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
PHF_process_z_General <- PHF_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, General, General_z) %>%
    dplyr::filter(General >= 0) %>%
    dplyr::filter(General <= 10)

ggplot(PHF_process_z_General) +
  geom_histogram(aes(x=General, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(PHF_process_z_General$General, na.rm = TRUE), sd =sd(PHF_process_z_General$General, na.rm = TRUE))) +
  labs(x= "General") +
  theme_minimal()

ggplot(PHF_process_z_General) +
  geom_histogram(aes(x=General_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(PHF_process_z_General$General_z, na.rm = TRUE), sd =sd(PHF_process_z_General$General_z, na.rm = TRUE))) +
  labs(x= "General_z") +
  theme_minimal()
```
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "30%"}
PHF_process_z_Financial <- PHF_process_z %>%
  dplyr::select(ID, age, Gender, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

ggplot(PHF_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(PHF_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(PHF_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_minimal()

ggplot(PHF_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(PHF_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(PHF_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_minimal()

ggplot(PHF_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(PHF_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(PHF_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```

#### SAVE
**Panel Name:** Sparen und Altersvorsorge in Deutschland (SAVE)

**Description:** The Sparen und Altersvorsorge in Deutschland (SAVE) is a representative, longitudinal study on households’ financial behavior with a special focus on savings and old-age provision. SAVE collected data on households’ financial structure and relevant socio- and psychological aspects between 2001 and 2013.

More information at: https://www.mpisoc.mpg.de/en/social-policy-mea/research/save-2001-2013/

**Country/Countries:** Germany

**Waves:** 2001-2013

**Data collection period:** 2001-2013

**Dataset(s) version number/name:** NA

**Data access:** https://dbk.gesis.org/dbksearch/GDESC2.asp?no=0014&search=save&search2=&DB=d&tab=0&notabs=&nf=1&af=&ll=10

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
SAVE_process_z$Gender[SAVE_process_z$Gender == "1"] <- "Male"
SAVE_process_z$Gender[SAVE_process_z$Gender == "2"] <- "Female"
SAVE_process_z$Gender <- as.factor(SAVE_process_z$Gender)

ggplot(SAVE_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(SAVE_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3.5) +
  #labs(title="SAVE", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*Driving*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
SAVE_process_z_Driving <- SAVE_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, Driving, Driving_z) %>%
    dplyr::filter(Driving >= 0) %>%
    dplyr::filter(Driving <= 10)

ggplot(SAVE_process_z_Driving) +
  geom_histogram(aes(x=Driving, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SAVE_process_z_Driving$Driving, na.rm = TRUE), sd =sd(SAVE_process_z_Driving$Driving, na.rm = TRUE))) +
  labs(x= "Driving") +
  theme_minimal()

ggplot(SAVE_process_z_Driving) +
  geom_histogram(aes(x=Driving_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SAVE_process_z_Driving$Driving_z, na.rm = TRUE), sd =sd(SAVE_process_z_Driving$Driving_z, na.rm = TRUE))) +
  labs(x= "Driving_z") +
  theme_minimal()
```
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
SAVE_process_z_Financial <- SAVE_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, Financial, Financial_z) %>%
    dplyr::filter(Financial >= 0) %>%
    dplyr::filter(Financial <= 10)

ggplot(SAVE_process_z_Financial) +
  geom_histogram(aes(x=Financial, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SAVE_process_z_Financial$Financial, na.rm = TRUE), sd =sd(SAVE_process_z_Financial$Financial, na.rm = TRUE))) +
  labs(x= "Financial") +
  theme_minimal()

ggplot(SAVE_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SAVE_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SAVE_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```
<br>
*Recreational*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
SAVE_process_z_Recreational <- SAVE_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, Recreational, Recreational_z) %>%
    dplyr::filter(Recreational >= 0) %>%
    dplyr::filter(Recreational <= 10)

ggplot(SAVE_process_z_Recreational) +
  geom_histogram(aes(x=Recreational, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SAVE_process_z_Recreational$Recreational, na.rm = TRUE), sd =sd(SAVE_process_z_Recreational$Recreational, na.rm = TRUE))) +
  labs(x= "Recreational") + 
  theme_minimal()

ggplot(SAVE_process_z_Recreational) +
  geom_histogram(aes(x=Recreational_z, y = ..density..), binwidth = 0.5, fill ="#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SAVE_process_z_Recreational$Recreational_z, na.rm = TRUE), sd =sd(SAVE_process_z_Recreational$Recreational_z, na.rm = TRUE))) +
  labs(x= "Recreational_z") +
  theme_minimal()
```
<br>
*Occupational*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
SAVE_process_z_Occupational <- SAVE_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, Occupational, Occupational_z) %>%
    dplyr::filter(Occupational >= 0) %>%
    dplyr::filter(Occupational <= 10)

ggplot(SAVE_process_z_Occupational) +
  geom_histogram(aes(x=Occupational, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SAVE_process_z_Occupational$Occupational, na.rm = TRUE), sd =sd(SAVE_process_z_Occupational$Occupational, na.rm = TRUE))) +
  labs(x= "Occupational") + 
  theme_minimal()

ggplot(SAVE_process_z_Occupational) +
  geom_histogram(aes(x=Occupational_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SAVE_process_z_Occupational$Occupational_z, na.rm = TRUE), sd =sd(SAVE_process_z_Occupational$Occupational_z, na.rm = TRUE))) +
  labs(x= "Occupational_z") +
  theme_minimal() 
```
<br>
*Health*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
SAVE_process_z_Health <- SAVE_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, Health, Health_z) %>%
    dplyr::filter(Health >= 0) %>%
    dplyr::filter(Health <= 10)

ggplot(SAVE_process_z_Health) +
  geom_histogram(aes(x=Health, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SAVE_process_z_Health$Health, na.rm = TRUE), sd =sd(SAVE_process_z_Health$Health, na.rm = TRUE))) +
  labs(x= "Health") + 
  theme_minimal() 

ggplot(SAVE_process_z_Health) +
  geom_histogram(aes(x=Health_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SAVE_process_z_Health$Health_z, na.rm = TRUE), sd =sd(SAVE_process_z_Health$Health_z, na.rm = TRUE))) +
  labs(x= "Health_z") +
  theme_minimal() 
```


#### SHARE_Austria
**Panel Name:** Survey of Health, Ageing and Retirement in Europe (SHARE) Austria Sample

**Description:** The Survey of Health, Ageing and Retirement in Europe (SHARE) is a research infrastructure for studying the effects of health, social, economic and environmental policies over the life-course of European citizens and beyond. From 2004 until today, 140,000 people aged 50 or older from 28 European countries and Israel have been interviewed in 7 waves. SHARE is the largest pan-European social science panel study providing internationally comparable longitudinal micro data that allow insights in the fields of public health and socioeconomic living conditions of European individuals.

More information at: http://www.share-project.org/home0.html

**Country/Countries:** Austria

**Waves:**2007, 2011, 2013, 2015, 2017, 2019

**Data collection period:** 2007, 2011, 2013, 2015, 2017, 2019

**Dataset(s) version number/name:** NA

**Data access:** http://www.share-project.org/data-access.html

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
SHARE_Austria_process_z$Gender[SHARE_Austria_process_z$Gender == "1"] <- "Male"
SHARE_Austria_process_z$Gender[SHARE_Austria_process_z$Gender == "2"] <- "Female"
SHARE_Austria_process_z$Gender <- as.factor(SHARE_Austria_process_z$Gender)

ggplot(SHARE_Austria_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(SHARE_Austria_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3) +
  #labs(title="SHARE_Austria", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "30%"}
SHARE_Austria_process_z_Financial <- SHARE_Austria_process_z %>%
  dplyr::select(ID, age, Gender, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

ggplot(SHARE_Austria_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Austria_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Austria_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_minimal()

ggplot(SHARE_Austria_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Austria_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Austria_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_minimal()

ggplot(SHARE_Austria_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-2,5,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Austria_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Austria_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```

#### SHARE_Belgium
**Panel Name:** Survey of Health, Ageing and Retirement in Europe (SHARE) Belgium Sample

**Description:** The Survey of Health, Ageing and Retirement in Europe (SHARE) is a research infrastructure for studying the effects of health, social, economic and environmental policies over the life-course of European citizens and beyond. From 2004 until today, 140,000 people aged 50 or older from 28 European countries and Israel have been interviewed in 7 waves. SHARE is the largest pan-European social science panel study providing internationally comparable longitudinal micro data that allow insights in the fields of public health and socioeconomic living conditions of European individuals.

More information at: http://www.share-project.org/home0.html

**Country/Countries:** Belgium

**Waves:**2007, 2011, 2013, 2015, 2017, 2019

**Data collection period:** 2007, 2011, 2013, 2015, 2017, 2019

**Dataset(s) version number/name:** NA

**Data access:** http://www.share-project.org/data-access.html

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
SHARE_Belgium_process_z$Gender[SHARE_Belgium_process_z$Gender == "1"] <- "Male"
SHARE_Belgium_process_z$Gender[SHARE_Belgium_process_z$Gender == "2"] <- "Female"
SHARE_Belgium_process_z$Gender <- as.factor(SHARE_Belgium_process_z$Gender)

ggplot(SHARE_Belgium_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(SHARE_Belgium_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3) +
  #labs(title="SHARE_Belgium", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "30%"}
SHARE_Belgium_process_z_Financial <- SHARE_Belgium_process_z %>%
  dplyr::select(ID, age, Gender, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

ggplot(SHARE_Belgium_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Belgium_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Belgium_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_minimal()

ggplot(SHARE_Belgium_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Belgium_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Belgium_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_minimal()

ggplot(SHARE_Belgium_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-2,5,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Belgium_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Belgium_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```

#### SHARE_Czech_Republic
**Panel Name:** Survey of Health, Ageing and Retirement in Europe (SHARE) Czech Republic Sample

**Description:** The Survey of Health, Ageing and Retirement in Europe (SHARE) is a research infrastructure for studying the effects of health, social, economic and environmental policies over the life-course of European citizens and beyond. From 2004 until today, 140,000 people aged 50 or older from 28 European countries and Israel have been interviewed in 7 waves. SHARE is the largest pan-European social science panel study providing internationally comparable longitudinal micro data that allow insights in the fields of public health and socioeconomic living conditions of European individuals.

More information at: http://www.share-project.org/home0.html

**Country/Countries:** Czech Republic

**Waves:**2007, 2011, 2013, 2015, 2017

**Data collection period:** 2007, 2011, 2013, 2015, 2017, 2019

**Dataset(s) version number/name:** NA

**Data access:** http://www.share-project.org/data-access.html

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
SHARE_Czech_Republic_process_z$Gender[SHARE_Czech_Republic_process_z$Gender == "1"] <- "Male"
SHARE_Czech_Republic_process_z$Gender[SHARE_Czech_Republic_process_z$Gender == "2"] <- "Female"
SHARE_Czech_Republic_process_z$Gender <- as.factor(SHARE_Czech_Republic_process_z$Gender)

ggplot(SHARE_Czech_Republic_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(SHARE_Czech_Republic_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3) +
  #labs(title="SHARE_Czech_Republic", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "30%"}
SHARE_Czech_Republic_process_z_Financial <- SHARE_Czech_Republic_process_z %>%
  dplyr::select(ID, age, Gender, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

ggplot(SHARE_Czech_Republic_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Czech_Republic_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Czech_Republic_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_minimal()

ggplot(SHARE_Czech_Republic_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Czech_Republic_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Czech_Republic_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_minimal()

ggplot(SHARE_Czech_Republic_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-2,5,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Czech_Republic_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Czech_Republic_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```

#### SHARE_Denmark
**Panel Name:** Survey of Health, Ageing and Retirement in Europe (SHARE) Denmark Sample

**Description:** The Survey of Health, Ageing and Retirement in Europe (SHARE) is a research infrastructure for studying the effects of health, social, economic and environmental policies over the life-course of European citizens and beyond. From 2004 until today, 140,000 people aged 50 or older from 28 European countries and Israel have been interviewed in 7 waves. SHARE is the largest pan-European social science panel study providing internationally comparable longitudinal micro data that allow insights in the fields of public health and socioeconomic living conditions of European individuals.

More information at: http://www.share-project.org/home0.html

**Country/Countries:** Denmark

**Waves:**2007, 2011, 2013, 2015, 2017

**Data collection period:** 2007, 2011, 2013, 2015, 2017, 2019

**Dataset(s) version number/name:** NA

**Data access:** http://www.share-project.org/data-access.html

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
SHARE_Denmark_process_z$Gender[SHARE_Denmark_process_z$Gender == "1"] <- "Male"
SHARE_Denmark_process_z$Gender[SHARE_Denmark_process_z$Gender == "2"] <- "Female"
SHARE_Denmark_process_z$Gender <- as.factor(SHARE_Denmark_process_z$Gender)

ggplot(SHARE_Denmark_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(SHARE_Denmark_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3) +
  #labs(title="SHARE_Denmark", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "30%"}
SHARE_Denmark_process_z_Financial <- SHARE_Denmark_process_z %>%
  dplyr::select(ID, age, Gender, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

ggplot(SHARE_Denmark_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Denmark_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Denmark_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_minimal()

ggplot(SHARE_Denmark_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Denmark_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Denmark_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_minimal()

ggplot(SHARE_Denmark_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-2,5,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Denmark_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Denmark_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```

#### SHARE_Estonia
**Panel Name:** Survey of Health, Ageing and Retirement in Europe (SHARE) Estonia Sample

**Description:** The Survey of Health, Ageing and Retirement in Europe (SHARE) is a research infrastructure for studying the effects of health, social, economic and environmental policies over the life-course of European citizens and beyond. From 2004 until today, 140,000 people aged 50 or older from 28 European countries and Israel have been interviewed in 7 waves. SHARE is the largest pan-European social science panel study providing internationally comparable longitudinal micro data that allow insights in the fields of public health and socioeconomic living conditions of European individuals.

More information at: http://www.share-project.org/home0.html

**Country/Countries:** Estonia

**Waves:**2011, 2013, 2015

**Data collection period:** 2011, 2013, 2015, 2019

**Dataset(s) version number/name:** NA

**Data access:** http://www.share-project.org/data-access.html

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
SHARE_Estonia_process_z$Gender[SHARE_Estonia_process_z$Gender == "1"] <- "Male"
SHARE_Estonia_process_z$Gender[SHARE_Estonia_process_z$Gender == "2"] <- "Female"
SHARE_Estonia_process_z$Gender <- as.factor(SHARE_Estonia_process_z$Gender)

ggplot(SHARE_Estonia_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(SHARE_Estonia_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3) +
  #labs(title="SHARE_Estonia", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "30%"}
SHARE_Estonia_process_z_Financial <- SHARE_Estonia_process_z %>%
  dplyr::select(ID, age, Gender, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

ggplot(SHARE_Estonia_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Estonia_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Estonia_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_minimal()

ggplot(SHARE_Estonia_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Estonia_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Estonia_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_minimal()

ggplot(SHARE_Estonia_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-2,5,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Estonia_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Estonia_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```

#### SHARE_France
**Panel Name:** Survey of Health, Ageing and Retirement in Europe (SHARE) France Sample

**Description:** TThe Survey of Health, Ageing and Retirement in Europe (SHARE) is a research infrastructure for studying the effects of health, social, economic and environmental policies over the life-course of European citizens and beyond. From 2004 until today, 140,000 people aged 50 or older from 28 European countries and Israel have been interviewed in 7 waves. SHARE is the largest pan-European social science panel study providing internationally comparable longitudinal micro data that allow insights in the fields of public health and socioeconomic living conditions of European individuals.

More information at: http://www.share-project.org/home0.html

**Country/Countries:** France

**Waves:** 2007, 2011, 2013, 2015, 2017

**Data collection period:** 2007, 2011, 2013, 2015, 2017, 2019

**Dataset(s) version number/name:** NA

**Data access:** http://www.share-project.org/data-access.html

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
SHARE_France_process_z$Gender[SHARE_France_process_z$Gender == "1"] <- "Male"
SHARE_France_process_z$Gender[SHARE_France_process_z$Gender == "2"] <- "Female"
SHARE_France_process_z$Gender <- as.factor(SHARE_France_process_z$Gender)

ggplot(SHARE_France_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(SHARE_France_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3) +
  #labs(title="SHARE_France", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "30%"}
SHARE_France_process_z_Financial <- SHARE_France_process_z %>%
  dplyr::select(ID, age, Gender, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

ggplot(SHARE_France_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_France_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_France_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_minimal()

ggplot(SHARE_France_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_France_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_France_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_minimal()

ggplot(SHARE_France_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-2,5,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_France_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_France_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```

#### SHARE_Germany
**Panel Name:** Survey of Health, Ageing and Retirement in Europe (SHARE) Germany Sample

**Description:** The Survey of Health, Ageing and Retirement in Europe (SHARE) is a research infrastructure for studying the effects of health, social, economic and environmental policies over the life-course of European citizens and beyond. From 2004 until today, 140,000 people aged 50 or older from 28 European countries and Israel have been interviewed in 7 waves. SHARE is the largest pan-European social science panel study providing internationally comparable longitudinal micro data that allow insights in the fields of public health and socioeconomic living conditions of European individuals.

More information at: http://www.share-project.org/home0.html

**Country/Countries:** Germany

**Waves:** 2007, 2011, 2013, 2015, 2017, 2019

**Data collection period:** 2007, 2011, 2013, 2015, 2017, 2019

**Dataset(s) version number/name:** NA

**Data access:** http://www.share-project.org/data-access.html

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
SHARE_Germany_process_z$Gender[SHARE_Germany_process_z$Gender == "1"] <- "Male"
SHARE_Germany_process_z$Gender[SHARE_Germany_process_z$Gender == "2"] <- "Female"
SHARE_Germany_process_z$Gender <- as.factor(SHARE_Germany_process_z$Gender)

ggplot(SHARE_Germany_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(SHARE_Germany_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3) +
  #labs(title="SHARE_Germany", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "30%"}
SHARE_Germany_process_z_Financial <- SHARE_Germany_process_z %>%
  dplyr::select(ID, age, Gender, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

ggplot(SHARE_Germany_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Germany_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Germany_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_minimal()

ggplot(SHARE_Germany_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Germany_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Germany_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_minimal()

ggplot(SHARE_Germany_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-2,5,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Germany_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Germany_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```

#### SHARE_Israel
**Panel Name:** Survey of Health, Ageing and Retirement in Europe (SHARE) Israel Sample

**Description:** The Survey of Health, Ageing and Retirement in Europe (SHARE) is a research infrastructure for studying the effects of health, social, economic and environmental policies over the life-course of European citizens and beyond. From 2004 until today, 140,000 people aged 50 or older from 28 European countries and Israel have been interviewed in 7 waves. SHARE is the largest pan-European social science panel study providing internationally comparable longitudinal micro data that allow insights in the fields of public health and socioeconomic living conditions of European individuals.

More information at: http://www.share-project.org/home0.html

**Country/Countries:** Israel

**Waves:** 2007, 2013, 2015

**Data collection period:** 2007, 2013, 2015, 2019

**Dataset(s) version number/name:** NA

**Data access:** http://www.share-project.org/data-access.html

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
SHARE_Israel_process_z$Gender[SHARE_Israel_process_z$Gender == "1"] <- "Male"
SHARE_Israel_process_z$Gender[SHARE_Israel_process_z$Gender == "2"] <- "Female"
SHARE_Israel_process_z$Gender <- as.factor(SHARE_Israel_process_z$Gender)

ggplot(SHARE_Israel_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(SHARE_Israel_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3) +
  #labs(title="SHARE_Israel", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "30%"}
SHARE_Israel_process_z_Financial <- SHARE_Israel_process_z %>%
  dplyr::select(ID, age, Gender, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

ggplot(SHARE_Israel_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Israel_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Israel_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_minimal()

ggplot(SHARE_Israel_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Israel_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Israel_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_minimal()

ggplot(SHARE_Israel_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-2,5,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Israel_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Israel_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```

#### SHARE_Italy
**Panel Name:** Survey of Health, Ageing and Retirement in Europe (SHARE) Italy Sample

**Description:** The Survey of Health, Ageing and Retirement in Europe (SHARE) is a research infrastructure for studying the effects of health, social, economic and environmental policies over the life-course of European citizens and beyond. From 2004 until today, 140,000 people aged 50 or older from 28 European countries and Israel have been interviewed in 7 waves. SHARE is the largest pan-European social science panel study providing internationally comparable longitudinal micro data that allow insights in the fields of public health and socioeconomic living conditions of European individuals.

More information at: http://www.share-project.org/home0.html

**Country/Countries:** Italy

**Waves:** 2007, 2011, 2013, 2015, 2017, 2019

**Data collection period:** 2007, 2011, 2013, 2015, 2017, 2019

**Dataset(s) version number/name:** NA

**Data access:** http://www.share-project.org/data-access.html

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
SHARE_Italy_process_z$Gender[SHARE_Italy_process_z$Gender == "1"] <- "Male"
SHARE_Italy_process_z$Gender[SHARE_Italy_process_z$Gender == "2"] <- "Female"
SHARE_Italy_process_z$Gender <- as.factor(SHARE_Italy_process_z$Gender)

ggplot(SHARE_Italy_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(SHARE_Italy_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3) +
  #labs(title="SHARE_Italy", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "30%"}
SHARE_Italy_process_z_Financial <- SHARE_Italy_process_z %>%
  dplyr::select(ID, age, Gender, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

ggplot(SHARE_Italy_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Italy_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Italy_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_minimal()

ggplot(SHARE_Italy_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Italy_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Italy_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_minimal()

ggplot(SHARE_Italy_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-2,5,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Italy_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Italy_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```

#### SHARE_Netherlands
**Panel Name:** Survey of Health, Ageing and Retirement in Europe (SHARE) Netherlands Sample

**Description:** The Survey of Health, Ageing and Retirement in Europe (SHARE) is a research infrastructure for studying the effects of health, social, economic and environmental policies over the life-course of European citizens and beyond. From 2004 until today, 140,000 people aged 50 or older from 28 European countries and Israel have been interviewed in 7 waves. SHARE is the largest pan-European social science panel study providing internationally comparable longitudinal micro data that allow insights in the fields of public health and socioeconomic living conditions of European individuals.

More information at: http://www.share-project.org/home0.html

**Country/Countries:** Netherlands

**Waves:** 2007, 2011, 2013, 2019

**Data collection period:** 2007, 2011, 2013, 2019

**Dataset(s) version number/name:** NA

**Data access:** http://www.share-project.org/data-access.html

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
SHARE_Netherlands_process_z$Gender[SHARE_Netherlands_process_z$Gender == "1"] <- "Male"
SHARE_Netherlands_process_z$Gender[SHARE_Netherlands_process_z$Gender == "2"] <- "Female"
SHARE_Netherlands_process_z$Gender <- as.factor(SHARE_Netherlands_process_z$Gender)

ggplot(SHARE_Netherlands_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(SHARE_Netherlands_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3) +
  #labs(title="SHARE_Netherlands", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "30%"}
SHARE_Netherlands_process_z_Financial <- SHARE_Netherlands_process_z %>%
  dplyr::select(ID, age, Gender, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

ggplot(SHARE_Netherlands_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Netherlands_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Netherlands_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_minimal()

ggplot(SHARE_Netherlands_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Netherlands_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Netherlands_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_minimal()

ggplot(SHARE_Netherlands_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-2,5,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Netherlands_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Netherlands_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```

#### SHARE_Slovenia
**Panel Name:** Survey of Health, Ageing and Retirement in Europe (SHARE) Slovenia Sample

**Description:** The Survey of Health, Ageing and Retirement in Europe (SHARE) is a research infrastructure for studying the effects of health, social, economic and environmental policies over the life-course of European citizens and beyond. From 2004 until today, 140,000 people aged 50 or older from 28 European countries and Israel have been interviewed in 7 waves. SHARE is the largest pan-European social science panel study providing internationally comparable longitudinal micro data that allow insights in the fields of public health and socioeconomic living conditions of European individuals.

More information at: http://www.share-project.org/home0.html

**Country/Countries:** Slovenia

**Waves:** 2011, 2013, 2015, 2019

**Data collection period:** 2011, 2013, 2015, 2019

**Dataset(s) version number/name:** NA

**Data access:** http://www.share-project.org/data-access.html

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
SHARE_Slovenia_process_z$Gender[SHARE_Slovenia_process_z$Gender == "1"] <- "Male"
SHARE_Slovenia_process_z$Gender[SHARE_Slovenia_process_z$Gender == "2"] <- "Female"
SHARE_Slovenia_process_z$Gender <- as.factor(SHARE_Slovenia_process_z$Gender)

ggplot(SHARE_Slovenia_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(SHARE_Slovenia_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3) +
  #labs(title="SHARE_Slovenia", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "30%"}
SHARE_Slovenia_process_z_Financial <- SHARE_Slovenia_process_z %>%
  dplyr::select(ID, age, Gender, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

ggplot(SHARE_Slovenia_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Slovenia_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Slovenia_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_minimal()

ggplot(SHARE_Slovenia_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Slovenia_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Slovenia_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_minimal()

ggplot(SHARE_Slovenia_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-2,5,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Slovenia_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Slovenia_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```

#### SHARE_Spain
**Panel Name:** Survey of Health, Ageing and Retirement in Europe (SHARE) Spain Sample

**Description:** The Survey of Health, Ageing and Retirement in Europe (SHARE) is a research infrastructure for studying the effects of health, social, economic and environmental policies over the life-course of European citizens and beyond. From 2004 until today, 140,000 people aged 50 or older from 28 European countries and Israel have been interviewed in 7 waves. SHARE is the largest pan-European social science panel study providing internationally comparable longitudinal micro data that allow insights in the fields of public health and socioeconomic living conditions of European individuals.

More information at: http://www.share-project.org/home0.html

**Country/Countries:** Spain

**Waves:** 2007, 2011, 2013, 2015, 2017

**Data collection period:** 2007, 2011, 2013, 2015, 2017, 2019

**Dataset(s) version number/name:** NA

**Data access:** http://www.share-project.org/data-access.html

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
SHARE_Spain_process_z$Gender[SHARE_Spain_process_z$Gender == "1"] <- "Male"
SHARE_Spain_process_z$Gender[SHARE_Spain_process_z$Gender == "2"] <- "Female"
SHARE_Spain_process_z$Gender <- as.factor(SHARE_Spain_process_z$Gender)

ggplot(SHARE_Spain_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(SHARE_Spain_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3) +
  #labs(title="SHARE_Spain", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "30%"}
SHARE_Spain_process_z_Financial <- SHARE_Spain_process_z %>%
  dplyr::select(ID, age, Gender, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

ggplot(SHARE_Spain_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Spain_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Spain_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_minimal()

ggplot(SHARE_Spain_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Spain_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Spain_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_minimal()

ggplot(SHARE_Spain_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-2,5,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Spain_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Spain_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```

#### SHARE_Sweden
**Panel Name:** Survey of Health, Ageing and Retirement in Europe (SHARE) Sweden Sample

**Description:** The Survey of Health, Ageing and Retirement in Europe (SHARE) is a research infrastructure for studying the effects of health, social, economic and environmental policies over the life-course of European citizens and beyond. From 2004 until today, 140,000 people aged 50 or older from 28 European countries and Israel have been interviewed in 7 waves. SHARE is the largest pan-European social science panel study providing internationally comparable longitudinal micro data that allow insights in the fields of public health and socioeconomic living conditions of European individuals.

More information at: http://www.share-project.org/home0.html

**Country/Countries:** Sweden

**Waves:** 2007, 2011, 2013, 2015, 2017

**Data collection period:** 2007, 2011, 2013, 2015, 2017, 2019

**Dataset(s) version number/name:** NA

**Data access:** http://www.share-project.org/data-access.html

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
SHARE_Sweden_process_z$Gender[SHARE_Sweden_process_z$Gender == "1"] <- "Male"
SHARE_Sweden_process_z$Gender[SHARE_Sweden_process_z$Gender == "2"] <- "Female"
SHARE_Sweden_process_z$Gender <- as.factor(SHARE_Sweden_process_z$Gender)

ggplot(SHARE_Sweden_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(SHARE_Sweden_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3) +
  #labs(title="SHARE_Sweden", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "30%"}
SHARE_Sweden_process_z_Financial <- SHARE_Sweden_process_z %>%
  dplyr::select(ID, age, Gender, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

ggplot(SHARE_Sweden_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Sweden_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Sweden_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_minimal()

ggplot(SHARE_Sweden_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Sweden_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Sweden_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_minimal()

ggplot(SHARE_Sweden_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-2,5,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Sweden_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Sweden_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```

#### SHARE_Switzerland
**Panel Name:** Survey of Health, Ageing and Retirement in Europe (SHARE) Switzerland Sample

**Description:** The Survey of Health, Ageing and Retirement in Europe (SHARE) is a research infrastructure for studying the effects of health, social, economic and environmental policies over the life-course of European citizens and beyond. From 2004 until today, 140,000 people aged 50 or older from 28 European countries and Israel have been interviewed in 7 waves. SHARE is the largest pan-European social science panel study providing internationally comparable longitudinal micro data that allow insights in the fields of public health and socioeconomic living conditions of European individuals.

More information at: http://www.share-project.org/home0.html

**Country/Countries:** Switzerland

**Waves:** 2007, 2011, 2013, 2015, 2017, 2019

**Data collection period:** 2007, 2011, 2013, 2015, 2017, 2019

**Dataset(s) version number/name:** NA

**Data access:** http://www.share-project.org/data-access.html

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
SHARE_Switzerland_process_z$Gender[SHARE_Switzerland_process_z$Gender == "1"] <- "Male"
SHARE_Switzerland_process_z$Gender[SHARE_Switzerland_process_z$Gender == "2"] <- "Female"
SHARE_Switzerland_process_z$Gender <- as.factor(SHARE_Switzerland_process_z$Gender)

ggplot(SHARE_Switzerland_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(SHARE_Switzerland_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3) +
  #labs(title="SHARE_Switzerland", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "30%"}
SHARE_Switzerland_process_z_Financial <- SHARE_Switzerland_process_z %>%
  dplyr::select(ID, age, Gender, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

ggplot(SHARE_Switzerland_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Switzerland_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Switzerland_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_minimal()

ggplot(SHARE_Switzerland_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Switzerland_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Switzerland_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_minimal()

ggplot(SHARE_Switzerland_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-2,5,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SHARE_Switzerland_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Switzerland_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```

#### SOEP
**Panel Name:** German Socio-Economic Panel (SOEP)

**Description:** The Socio-Economic Panel (SOEP) is one of the largest and longest-running multidisciplinary household surveys worldwide. Every year, approximately 30,000 people in 15,000 households are interviewed for the SOEP study. The SOEP is also a research-driven infrastructure based at DIW Berlin. The SOEP team prepares survey data for use by researchers around the globe, and team members use the data in research on various topics. Studies based on SOEP data examine diverse aspects of societal change. 

More information at: https://www.diw.de/en/diw_01.c.600489.en/about_us.html#c_624242

**Country/Countries:** Germany

**Waves:** 2004-2018

**Data collection period:** 1984-present

**Dataset(s) version number/name:** SOEP-Core v35 

**Data access:** https://www.diw.de/sixcms/detail.php?id=diw_01.c.742256.en

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
SOEP_process_z$Gender[SOEP_process_z$Gender == "1"] <- "Male"
SOEP_process_z$Gender[SOEP_process_z$Gender == "2"] <- "Female"
SOEP_process_z$Gender <- as.factor(SOEP_process_z$Gender)

ggplot(SOEP_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(SOEP_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3.5) +
  #labs(title="SOEP", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*General*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
SOEP_process_z_General <- SOEP_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, General, General_z) %>%
    dplyr::filter(General >= 0) %>%
    dplyr::filter(General <= 10)

ggplot(SOEP_process_z_General) +
  geom_histogram(aes(x=General, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SOEP_process_z_General$General, na.rm = TRUE), sd =sd(SOEP_process_z_General$General, na.rm = TRUE))) +
  labs(x= "General") +
  theme_minimal()

ggplot(SOEP_process_z_General) +
  geom_histogram(aes(x=General_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SOEP_process_z_General$General_z, na.rm = TRUE), sd =sd(SOEP_process_z_General$General_z, na.rm = TRUE))) +
  labs(x= "General_z") +
  theme_minimal()
```
<br>
*Driving*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
SOEP_process_z_Driving <- SOEP_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, Driving, Driving_z) %>%
    dplyr::filter(Driving >= 0) %>%
    dplyr::filter(Driving <= 10)

ggplot(SOEP_process_z_Driving) +
  geom_histogram(aes(x=Driving, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SOEP_process_z_Driving$Driving, na.rm = TRUE), sd =sd(SOEP_process_z_Driving$Driving, na.rm = TRUE))) +
  labs(x= "Driving") +
  theme_minimal()

ggplot(SOEP_process_z_Driving) +
  geom_histogram(aes(x=Driving_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SOEP_process_z_Driving$Driving_z, na.rm = TRUE), sd =sd(SOEP_process_z_Driving$Driving_z, na.rm = TRUE))) +
  labs(x= "Driving_z") +
  theme_minimal()
```
<br>
*Financial*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
SOEP_process_z_Financial <- SOEP_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, Financial, Financial_z) %>%
    dplyr::filter(Financial >= 0) %>%
    dplyr::filter(Financial <= 10)

ggplot(SOEP_process_z_Financial) +
  geom_histogram(aes(x=Financial, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SOEP_process_z_Financial$Financial, na.rm = TRUE), sd =sd(SOEP_process_z_Financial$Financial, na.rm = TRUE))) +
  labs(x= "Financial") +
  theme_minimal()

ggplot(SOEP_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SOEP_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SOEP_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_minimal()
```
<br>
*Recreational*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
SOEP_process_z_Recreational <- SOEP_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, Recreational, Recreational_z) %>%
    dplyr::filter(Recreational >= 0) %>%
    dplyr::filter(Recreational <= 10)

ggplot(SOEP_process_z_Recreational) +
  geom_histogram(aes(x=Recreational, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SOEP_process_z_Recreational$Recreational, na.rm = TRUE), sd =sd(SOEP_process_z_Recreational$Recreational, na.rm = TRUE))) +
  labs(x= "Recreational") + 
  theme_minimal()

ggplot(SOEP_process_z_Recreational) +
  geom_histogram(aes(x=Recreational_z, y = ..density..), binwidth = 0.5, fill ="#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SOEP_process_z_Recreational$Recreational_z, na.rm = TRUE), sd =sd(SOEP_process_z_Recreational$Recreational_z, na.rm = TRUE))) +
  labs(x= "Recreational_z") +
  theme_minimal()
```
<br>
*Occupational*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
SOEP_process_z_Occupational <- SOEP_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, Occupational, Occupational_z) %>%
    dplyr::filter(Occupational >= 0) %>%
    dplyr::filter(Occupational <= 10)

ggplot(SOEP_process_z_Occupational) +
  geom_histogram(aes(x=Occupational, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SOEP_process_z_Occupational$Occupational, na.rm = TRUE), sd =sd(SOEP_process_z_Occupational$Occupational, na.rm = TRUE))) +
  labs(x= "Occupational") + 
  theme_minimal()

ggplot(SOEP_process_z_Occupational) +
  geom_histogram(aes(x=Occupational_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SOEP_process_z_Occupational$Occupational_z, na.rm = TRUE), sd =sd(SOEP_process_z_Occupational$Occupational_z, na.rm = TRUE))) +
  labs(x= "Occupational_z") +
  theme_minimal() 
```
<br>
*Health*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
SOEP_process_z_Health <- SOEP_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, Health, Health_z) %>%
    dplyr::filter(Health >= 0) %>%
    dplyr::filter(Health <= 10)

ggplot(SOEP_process_z_Health) +
  geom_histogram(aes(x=Health, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SOEP_process_z_Health$Health, na.rm = TRUE), sd =sd(SOEP_process_z_Health$Health, na.rm = TRUE))) +
  labs(x= "Health") + 
  theme_minimal() 

ggplot(SOEP_process_z_Health) +
  geom_histogram(aes(x=Health_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SOEP_process_z_Health$Health_z, na.rm = TRUE), sd =sd(SOEP_process_z_Health$Health_z, na.rm = TRUE))) +
  labs(x= "Health_z") +
  theme_minimal() 
```
<br>
*Social*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
SOEP_process_z_Social <- SOEP_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, Social, Social_z) %>%
    dplyr::filter(Social >= 0) %>%
    dplyr::filter(Social <= 10)

ggplot(SOEP_process_z_Social) +
  geom_histogram(aes(x=Social, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SOEP_process_z_Social$Social, na.rm = TRUE), sd =sd(SOEP_process_z_Social$Social, na.rm = TRUE))) +
  labs(x= "Social") + 
  theme_minimal() 

ggplot(SOEP_process_z_Social) +
  geom_histogram(aes(x=Social_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(SOEP_process_z_Social$Social_z, na.rm = TRUE), sd =sd(SOEP_process_z_Social$Social_z, na.rm = TRUE))) +
  labs(x= "Social_z") +
  theme_minimal() 
```

#### USoc
**Panel Name:** UK Household Longitudinal Survey (Understanding Society) (USoc)

**Description:** The UK Household Longitudinal Study/Understanding Society (USoc) is built on the British Household Panel Survey (BHPS), which ran from 1991-2009 and had around 10,000 households in it. Understanding Society started in 2009 and interviewed around 40,000 households, including around 8,000 of the original BHPS households.The USoc examines how life in the UK is changing and what stays the same over many years and includes questions on various topics including social, economic and behavioral factors. Interviews are held with each member of the household in order to examine how different generations experience life in the UK.

More information at: https://www.understandingsociety.ac.uk/about/about-the-study

**Country/Countries:** United Kingdom

**Waves:** 2008, 2013, 2014

**Data collection period:** Waves 1-11, 2008-2018

**Dataset(s) version number/name:** Understanding Society: Innovation Panel

**Data access:** https://www.understandingsociety.ac.uk/documentation/access-data

**Age distribution:** Left plot: density plot for age distribution; Right plot: histogram of age distributions (all observations)
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 14, fig.height = 8, fig.hold="hold", out.width = "50%"}
USoc_process_z$Gender[USoc_process_z$Gender == "1"] <- "Male"
USoc_process_z$Gender[USoc_process_z$Gender == "2"] <- "Female"
USoc_process_z$Gender <- as.factor(USoc_process_z$Gender)

ggplot(USoc_process_z, aes(x=age)) + 
  geom_histogram(aes(y=..density..), binwidth = 1, colour="black", fill="white")+
  geom_density(alpha=.2, fill="#A6CEE3")+
  scale_x_continuous(breaks=seq(10,90,by=10)) +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
 
ggplot(USoc_process_z, aes(x = age_bins,fill = Gender, group=Gender)) + 
  geom_bar(position = 'dodge') +
  geom_text(stat='count', aes(label=..count.., group=Gender ), position = position_dodge(width = 1), vjust = -1, size = 3.5) +
  #labs(title="USoc", x= "Age_bin", y= "Count, observations") +
  labs(x= "Age_bin", y= "Count, observations") +
  scale_fill_brewer(palette = "Paired") +
  theme_minimal() +
  theme(axis.text=element_text(size=18), axis.title.x = element_text(size = 24, face="bold"), axis.title.y = element_text(size = 24, face="bold"), plot.title = element_text(size=25, face="bold"))
```

**Risk-taking propensity density:** Left plot: density plot for raw risk-taking score; Right plot: density plot for z-transformed risk-taking score
<br>
*General*
<br>
```{r, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 5, fig.height = 3, fig.hold="hold", out.width = "50%"}
USoc_process_z_General <- USoc_process_z %>%
dplyr::select(ID, age, Gender, SYEAR, General, General_z) %>%
    dplyr::filter(General >= 0) %>%
    dplyr::filter(General <= 10)

ggplot(USoc_process_z_General) +
  geom_histogram(aes(x=General, y = ..density..), binwidth = 1, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(USoc_process_z_General$General, na.rm = TRUE), sd =sd(USoc_process_z_General$General, na.rm = TRUE))) +
  labs(x= "General") +
  theme_minimal()

ggplot(USoc_process_z_General) +
  geom_histogram(aes(x=General_z, y = ..density..), binwidth = 0.5, fill = "#A6CEE3", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "#1F78B4", args = list(mean = mean(USoc_process_z_General$General_z, na.rm = TRUE), sd =sd(USoc_process_z_General$General_z, na.rm = TRUE))) +
  labs(x= "General_z") +
  theme_minimal()
```


<div style="margin-bottom:40px;">
</div>

## 3. Multilevel model process {.tabset}

This section offers a detailed overview of the 7 different models included in the multilevel analysis in the paper *Age differences in risk-taking propensity: A coordinated analysis of longitudinal panels*.

**Each model is described in a separate tab. We include the following:**

- **Model name:** General name of model

- **Description:** This is a general description of the model, including some details of the model

- **Analysis:** The code to run in R and interpret the model, along with the annotations the meaning of each part of the code. 
<br>
<br>

### Intercept-only model

* **Model name:** Intercept-only model, also called unconditional model.

* **Description:** In the unconditional model, only the dependent variable and the grouping variable(s) (e.g., subject ID) are entered. No predictors are entered thus the model is not “conditioned” upon any predictor variables. This intercept-only model is the first step in conducting multilevel modeling, aiming to make sure mutlilevel modeling is appropriate in the first place. 

* **Analysis:**  Model <- lmer (risk ~ 1 + (1|subject), data = DATA) 

  + *Model:* Tells R to save the output of the analyses to an object called "Model".

  + *lmer:* This is the command to test a mixed linear model using lme4.
  
  + *risk ~ 1:* Specifies an unconditional model in the form DV~IV. When there are no predictors, 1 is entered in the IV’s place. In our model, risk is the DV, representing the risk-taking propensity. 
  
  + *1|subject:*  Specifies that level-1 observations are grouped by the level-2 variable called "subject", representing the subjects' ID number.
  
  + *data = DATA:* Specifies that the variables (e.g., risk, subject ID) are in a dataset called "DATA".
  
  
### Fixed-effect model

* **Model name:** Fixed-effect model, also called age fixed-effect model.

* **Description:** After determining that a multilevel model is appropriate, the next step is to begin to add level-1 predictors. Within multilevel modeling of real-time monitoring data, level-1 is almost always the “observation” level. In our analysis, the level one predictor is "age". In the fixed-effect model, we regard age as a predictor but did not consider differences across participants, so called fixed-effect model.

* **Analysis:** Model <- lmer (risk ~ age + (1|subject), data = DATA)

  + *Model:* Tells R to save the output of the analyses to an object called "Model".

  + *lmer:*  This is the command to test a mixed linear model using lme4.
  
  + *risk ~ age:* Formula that lme4 will process, specified in the form DV~IV. In our model, age is not the raw age. We centered the age variable to a reference age (50 years old) and standardized the age variable to decades by dividing it by 10, then use the transformed age in our model.
  
  + *1|subject:* Specifies that level-1 observations are grouped by the level-2 variable called "subject", representing the subjects' ID number.
  
  + *data = DATA:* Specifies that the variables (e.g., risk, subject ID) are in a dataset called "DATA".
  
  
### Linear model

* **Model name:** Linear model, also called age fixed- and random-effects model effects model

* **Description:** In the linear model, we regard age as a predictor and also include differences across participants, so in turn, this model included age both as a fixed and a random slope. 

* **Analysis:** Model <- lmer (risk ~ age + (1+age|subject), data = DATA)

  + *Model:* Tells R to save the output of the analyses to an object called "Model"

  + *lmer:* This is the command to test a mixed linear model using lme4.
  
  + *risk ~ age:* Formula that lme4 will process, specified in the form DV~IV, the independent variable in the model is centered and standardized age.
  
  + *1+age|subject:* Specifies that the model include not only age fixed effect, but also age random effect.
  
  + *data = DATA:* Specifies that the variables (e.g., risk, age, subject ID) are in a dataset called "DATA"
  
  
### Linear with gender model

* **Model name:** Linear with gender model, also called age fixed- and random-effects effects model with gender

* **Description:** The next step involves entering level-2 effects, although it is not always necessary to take this piecewise approach testing a level-1-effects-only model first. A model with level-2 variables should only be used when the theoretical conceptualization of the model necessitates it and there is sufficient power to do so. In this model, we are interested in adjusting for the effect of gender, so enter gender as a level-2 predictor. In this way, we coded the relation between inter-individual differences in the change trajectories and the time-invariant characteristic (gender) of the individual to compare whether age is associated with risk-taking propensity in males and females in same manner.

* **Analysis:**  Model <- lmer (risk ~ age + gender + (1+age|subject), data = DATA)

  + *Model:* Tells R to save the output of the analyses to an object called "Model".

  + *lmer:* This is the command to test a mixed linear model using lme4.
  
  + *risk ~ age + gender:* Formula that lme4 will process, specified in the form DV~IV1+IV2, the first independent variable in the model is level-1 predictor (i.e., centered and standardized age), and the second independent variable in the model is level-2 predictor(i.e.,gender).
  
  + *1+age|subject:* Specifies that the model include not only age fixed effect, but also age random effect.
  
  + *data = DATA:* Specifies that the variables (e.g., risk, age, gender, subject ID) are in a dataset called "DATA"

  
### Linear with gender interaction model

* **Model name:** Linear with gender interaction model, also called age fixed- and random- effects model with gender, including an age by gender interaction

* **Description:** This model further included an age by gender interaction based on previous model. 

* **Analysis:** Model <- lmer (risk ~ age + age$\times$gender + (1+age|subject), data = DATA)

  + *Model:* Tells R to save the output of the analyses to an object called "Model"

  + *lmer:* This is the command to test a mixed linear model using lme4.
  
  + *risk ~ age + age$\times$gender:* Formula that lme4 will process, specified in the form DV~IV1+IV2, the first independent variable in the model is level-1 predictor (i.e., centered and standardized age), and the second independent variable in the model is the interaction between age and gender.
  
  + *1+age|subject:*  Specifies that the model include not only age fixed effect, but also age random effect.
  
  + *data = DATA:* Specifies that the variables (e.g., risk,  age, gender, subject ID) are in a dataset called "DATA"

  
### Quadratic model

* **Model name:** Quadratic model, also called age quadratic growth model

* **Description:** we fit quadratic growth models to assess non-linear change. We did this by squaring age variable and entering this into a model.

* **Analysis:** Model <- lmer (risk ~ age + I($age^2$) + (1+age|subject), data = DATA)

  + *Model:* Tells R to save the output of the analyses to an object called "Model"

  + *lmer:* This is the command to test a mixed linear model using lme4.
  
  + *risk ~ age + I($age^2$):*  Formula that lme4 will process, specified in the form DV~IV1+IV2, the first independent variable in the model is level-1 predictor (i.e., centered and standardized age), and the second independent variable in the model is quadratic age.
  
  + *1+age|subject:* Specifies that the model include not only age fixed effect, but also age random effect.
  
  + *data = DATA:* Specifies that the variables (e.g., risk, subject ID) are in a dataset called "DATA"
  
  
### Quadratic with gender model

* **Model name:** Quadratic with gender model, also called age quadratic growth model with gender. 

* **Description:** We added gender variable into quadratic growth model to assess potential age differences in the quadratic trajectories.

* **Analysis:** Model <- lmer (risk ~ age + I($age^2$) + gender + (1+age|subject), data = DATA)

  + *Model:* Tells R to save the output of the analyses to an object called "Model"

  + *lmer:* This is the command to test a mixed linear model using lme4.
  
  + *risk ~ age + I($age^2$) + gender:* Formula that lme4 will process, specified in the form DV~IV1+IV2+IV3, the first independent variable in the model is level-1 predictor (i.e., centered and standardized age), the second independent variable in the model is quadratic age, and the third independent variable in the model is level-2 predictor (i.e.,gender).
  
  + *1+age|subject:* Specifies that the model include not only age fixed effect, but also age random effect.
  
  + *data = DATA:* Specifies that the variables (e.g., risk, subject ID) are in a dataset called "DATA"
  


<div style="margin-bottom:40px;">
</div>


## 4. Multilevel model results

### 4.1. General risk-taking{.tabset}

#### Intercept only model

**Models results:**

```{r, echo = F, warning = FALSE, message = FALSE}
p_judge <- function(x){
  for (i in 1:length(x)) {
    value = as.numeric(x[[i]])
    if(value < 0.001) {
      x[[i]] = "p < 0.001"
      } else if( value < 0.01) {
        x[[i]] = "P < 0.01"
        } else if (value < 0.05) {
          x[[i]] = "p < 0.05"
          } else {
            x[[i]] <- purrr::modify_if(value, ~is.numeric(.), ~round(., 3))
          }
  }
  return(x)
}

setwd("../data/results_data")

results_table_list <- readRDS(file = "results_table_list.Rds")
results_g.int  <- results_table_list$results_g.int 
remove <- c("Intercept_Std.Error2")
results_g.int  <- results_g.int [!(row.names(results_g.int ) %in% remove),]
rownames(results_g.int )[rownames(results_g.int )=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
results_g.int  <- results_g.int [, colSums(is.na(results_g.int )) != nrow(results_g.int )]
results_g.int  <- results_g.int [complete.cases(results_g.int ), ]
results_g.int [c(1:3,5:8,11), ] <- purrr::modify_if(results_g.int [c(1:3,5:8,11), ], ~is.numeric(.), ~round(., 2))
results_g.int [c(9:10),] <- purrr::modify_if(results_g.int [c(9:10), ], ~is.numeric(.), ~round(., 0))
results_g.int [4,] <- p_judge(results_g.int [4,])

datatable(results_g.int , options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_g.int))), pageLength = nrow(results_g.int)))
```

<div style="margin-bottom:40px;">
</div>


#### Fixed effect model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_g.fixed <- results_table_list$results_g.fixed
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_g.fixed <- results_g.fixed[!(row.names(results_g.fixed) %in% remove),]
rownames(results_g.fixed)[rownames(results_g.fixed)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_g.fixed)[rownames(results_g.fixed)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_g.fixed <- results_g.fixed[, colSums(is.na(results_g.fixed)) != nrow(results_g.fixed)]
results_g.fixed <- results_g.fixed[complete.cases(results_g.fixed), ]

results_g.fixed[c(1:6,9:10,13), ] <- purrr::modify_if(results_g.fixed[c(1:6,9:10,13), ], ~is.numeric(.), ~round(., 2))
results_g.fixed[c(11:12), ] <- purrr::modify_if(results_g.fixed[c(11:12), ], ~is.numeric(.), ~round(., 0))

results_g.fixed[7,] <- p_judge(results_g.fixed[7,])
results_g.fixed[8,] <- p_judge(results_g.fixed[8,])

results_g.fixed <- results_g.fixed[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "N.group", "N.obs", "LL"),]

datatable(results_g.fixed, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_g.fixed))), pageLength = nrow(results_g.fixed)))
```

<div style="margin-bottom:40px;">
</div>


#### Linear model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_g.lg <- results_table_list$results_g.lg
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_g.lg <- results_g.lg[!(row.names(results_g.lg) %in% remove),]
rownames(results_g.lg)[rownames(results_g.lg)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_g.lg)[rownames(results_g.lg)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_g.lg <- results_g.lg[, colSums(is.na(results_g.lg)) != nrow(results_g.lg)]
results_g.lg <- results_g.lg[complete.cases(results_g.lg), ]

results_g.lg[c(1:6,9:13,16), ] <- purrr::modify_if(results_g.lg[c(1:6,9:13,16), ], ~is.numeric(.), ~round(., 2))
results_g.lg[c(14:15), ] <- purrr::modify_if(results_g.lg[c(14:15), ], ~is.numeric(.), ~round(., 0))

results_g.lg[7,] <- p_judge(results_g.lg[7,])
results_g.lg[8,] <- p_judge(results_g.lg[8,])

results_g.lg <- results_g.lg[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_g.lg, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_g.lg))), pageLength = nrow(results_g.lg)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 7.5, fig.cap = "Figure: Age trajectories of general risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. The lines represent the age trajectory of linear model results."}

panels <- c("DHS","GCOE_Japan","GCOE_USA","HILDA","HRS","LIKS","PHF","SAVE","SHARE_Austria","SHARE_Belgium","SHARE_Czech_Republic","SHARE_Denmark", "SHARE_Estonia", "SHARE_France", "SHARE_Germany","SHARE_Israel", "SHARE_Italy","SHARE_Netherlands","SHARE_Slovenia","SHARE_Spain","SHARE_Sweden","SHARE_Switzerland","SOEP","USoc") 

panels <- fct_rev(as.factor(panels))

colordata <- data.frame(matrix(data=NA, nrow=length(panels), ncol = 1)) 
colordata <- as.data.frame(matrix(panels))
colnames(colordata) <- "Panel"
colordata$Panel<- as.factor(colordata$Panel)

setwd("../data/results_data")

plot_model_data_list <- readRDS(file = "plot_model_data_list.Rds")
raw_mean_data_list <- readRDS(file = "raw_mean_data_list.Rds")

#model data
model_data <- plot_model_data_list$plot_g.lg
#mean data
mean_data <- raw_mean_data_list$plot_g.lg %>%
  filter(General_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

ggplot() + 
  geom_point(data = mean_data, aes(x = win_mid, y = General_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
  scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
  stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x, size = 0.5) +
  labs(x= "Age", y= "General risk propensity") +
  #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
  coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
  theme_bw() +
  theme(legend.position = "none") +
  theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA)) +
  facet_wrap(~Panel, nrow = 3)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_g.lg.gender <- results_table_list$results_g.lg.gender
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "gender_Std.Error2")
results_g.lg.gender <- results_g.lg.gender[!(row.names(results_g.lg.gender) %in% remove),]
rownames(results_g.lg.gender)[rownames(results_g.lg.gender)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_g.lg.gender)[rownames(results_g.lg.gender)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_g.lg.gender)[rownames(results_g.lg.gender)=="gender_Std.Error1"] <- "gender_Std.Error"
results_g.lg.gender <- results_g.lg.gender[, colSums(is.na(results_g.lg.gender)) != nrow(results_g.lg.gender)]
results_g.lg.gender <- results_g.lg.gender[complete.cases(results_g.lg.gender), ]

results_g.lg.gender[c(1:9,13:17,20), ] <- purrr::modify_if(results_g.lg.gender[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_g.lg.gender[c(18:19), ] <- purrr::modify_if(results_g.lg.gender[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_g.lg.gender[10,] <- p_judge(results_g.lg.gender[10,])
results_g.lg.gender[11,] <- p_judge(results_g.lg.gender[11,])
results_g.lg.gender[12,] <- p_judge(results_g.lg.gender[12,])

results_g.lg.gender <- results_g.lg.gender[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "gender_Estimate","gender_Std.Error", "gender_t.value", "gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_g.lg.gender, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_g.lg.gender))), pageLength = nrow(results_g.lg.gender)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 7.5, fig.cap = "Figure: Age trajectories of general risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of linear with gender model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_g.lg.gender
#mean data
mean_data <- raw_mean_data_list$plot_g.lg.gender %>%
  filter(General_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = General_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "General risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 3)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender interaction model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_g.lg.inter <- results_table_list$results_g.lg.inter
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "gender_Std.Error2", "d_c_age:gender_Std.Error2")
results_g.lg.inter <- results_g.lg.inter[!(row.names(results_g.lg.inter) %in% remove),]
rownames(results_g.lg.inter)[rownames(results_g.lg.inter)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_g.lg.inter)[rownames(results_g.lg.inter)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_g.lg.inter)[rownames(results_g.lg.inter)=="gender_Std.Error1"] <- "gender_Std.Error"
rownames(results_g.lg.inter)[rownames(results_g.lg.inter)=="d_c_age:gender_Std.Error1"] <- "d_c_age:gender_Std.Error"
results_g.lg.inter <- results_g.lg.inter[, colSums(is.na(results_g.lg.inter)) != nrow(results_g.lg.inter)]
results_g.lg.inter <- results_g.lg.inter[complete.cases(results_g.lg.inter), ]

results_g.lg.inter[c(1:12,17:21,24), ] <- purrr::modify_if(results_g.lg.inter[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_g.lg.inter[c(22:23), ] <- purrr::modify_if(results_g.lg.inter[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_g.lg.inter[13,] <- p_judge(results_g.lg.inter[13,])
results_g.lg.inter[14,] <- p_judge(results_g.lg.inter[14,])
results_g.lg.inter[15,] <- p_judge(results_g.lg.inter[15,])
results_g.lg.inter[16,] <- p_judge(results_g.lg.inter[16,])

results_g.lg.inter <- results_g.lg.inter[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "gender_Estimate", "gender_Std.Error", "gender_t.value", "gender_p.value", "d_c_age:gender_Estimate", "d_c_age:gender_Std.Error", "d_c_age:gender_t.value", "d_c_age:gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_g.lg.inter, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_g.lg.inter))), pageLength = nrow(results_g.lg.inter)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 7.5, fig.cap = "Figure: Age trajectories of general risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of linear with gender interaction model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_g.lg.inter  
#mean data
mean_data <- raw_mean_data_list$plot_g.lg.inter %>%
  filter(General_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = General_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "General risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 3)
```

<div style="margin-bottom:40px;">
</div>


#### Quadratic model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_g.quad <- results_table_list$results_g.quad
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "I(d_c_age^2)_Std.Error2")
results_g.quad <- results_g.quad[!(row.names(results_g.quad) %in% remove),]
rownames(results_g.quad)[rownames(results_g.quad)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_g.quad)[rownames(results_g.quad)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_g.quad)[rownames(results_g.quad)=="I(d_c_age^2)_Std.Error1"] <- "I(d_c_age^2)_Std.Error"
results_g.quad <- results_g.quad[, colSums(is.na(results_g.quad)) != nrow(results_g.quad)]
results_g.quad <- results_g.quad[complete.cases(results_g.quad), ]

results_g.quad[c(1:9,13:17,20), ] <- purrr::modify_if(results_g.quad[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_g.quad[c(18:19), ] <- purrr::modify_if(results_g.quad[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_g.quad[10,] <- p_judge(results_g.quad[10,])
results_g.quad[11,] <- p_judge(results_g.quad[11,])
results_g.quad[12,] <- p_judge(results_g.quad[12,])


results_g.quad <- results_g.quad[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "I(d_c_age^2)_Estimate", "I(d_c_age^2)_Std.Error", "I(d_c_age^2)_t.value", "I(d_c_age^2)_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_g.quad, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_g.quad))), pageLength = nrow(results_g.quad)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 7, fig.height = 5.5, fig.cap = "Figure: Age trajectories of general risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. The lines represent the age trajectory of quadratic model results."}
#model data
model_data <- plot_model_data_list$plot_g.quad
#mean data
mean_data <- raw_mean_data_list$plot_g.quad %>%
  filter(General_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = General_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x + I(x^2), size = 0.5) +
   labs(x= "Age", y= "General risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   facet_wrap(~Panel, nrow = 2)
```

<div style="margin-bottom:40px;">
</div>


#### Quadratic with gender model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_g.quad.gender <- results_table_list$results_g.quad.gender
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "I(d_c_age^2)_Std.Error2","gender_Std.Error2")
results_g.quad.gender <- results_g.quad.gender[!(row.names(results_g.quad.gender) %in% remove),]
rownames(results_g.quad.gender)[rownames(results_g.quad.gender)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_g.quad.gender)[rownames(results_g.quad.gender)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_g.quad.gender)[rownames(results_g.quad.gender)=="I(d_c_age^2)_Std.Error1"] <- "I(d_c_age^2)_Std.Error"
rownames(results_g.quad.gender)[rownames(results_g.quad.gender)=="gender_Std.Error1"] <- "gender_Std.Error1"
results_g.quad.gender <- results_g.quad.gender[, colSums(is.na(results_g.quad.gender)) != nrow(results_g.quad.gender)]
results_g.quad.gender <- results_g.quad.gender[complete.cases(results_g.quad.gender), ]

results_g.quad.gender[c(1:12,17:21,24), ] <- purrr::modify_if(results_g.quad.gender[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_g.quad.gender[c(22:23), ] <- purrr::modify_if(results_g.quad.gender[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_g.quad.gender[13,] <- p_judge(results_g.quad.gender[13,])
results_g.quad.gender[14,] <- p_judge(results_g.quad.gender[14,])
results_g.quad.gender[15,] <- p_judge(results_g.quad.gender[15,])
results_g.quad.gender[16,] <- p_judge(results_g.quad.gender[16,])


results_g.quad.gender <- results_g.quad.gender[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "I(d_c_age^2)_Estimate", "I(d_c_age^2)_Std.Error", "I(d_c_age^2)_t.value", "I(d_c_age^2)_p.value", "gender_Estimate", "gender_Std.Error", "gender_t.value", "gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_g.quad.gender, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_g.quad.gender))), pageLength = nrow(results_g.quad.gender)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 7, fig.height = 5.5, fig.cap = "Figure: Age trajectories of general risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of quadratic with gender model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_g.quad.gender
#mean data
mean_data <- raw_mean_data_list$plot_g.quad.gender %>%
  filter(General_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = General_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x + I(x^2), size = 0.5) +
   labs(x= "Age", y= "General risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 2)
```

<div style="margin-bottom:40px;">
</div>



### 4.2. Financial risk-taking{.tabset}

#### Intercept only model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_f.int <- results_table_list$results_f.int
remove <- c("Intercept_Std.Error2")
results_f.int <- results_f.int[!(row.names(results_f.int) %in% remove),]
rownames(results_f.int)[rownames(results_f.int)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
results_f.int <- results_f.int[, colSums(is.na(results_f.int)) != nrow(results_f.int)]
results_f.int <- results_f.int[complete.cases(results_f.int), ]
results_f.int[c(1:3,5:8,11), ] <- purrr::modify_if(results_f.int[c(1:3,5:8,11), ], ~is.numeric(.), ~round(., 2))
results_f.int[c(9:10),] <- purrr::modify_if(results_f.int[c(9:10), ], ~is.numeric(.), ~round(., 0))
results_f.int[4,] <- p_judge(results_f.int[4,])

datatable(results_f.int, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_f.int))), pageLength = nrow(results_f.int)))
```

<div style="margin-bottom:40px;">
</div>


#### Fixed effect model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_f.fixed <- results_table_list$results_f.fixed
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_f.fixed <- results_f.fixed[!(row.names(results_f.fixed) %in% remove),]
rownames(results_f.fixed)[rownames(results_f.fixed)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_f.fixed)[rownames(results_f.fixed)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_f.fixed <- results_f.fixed[, colSums(is.na(results_f.fixed)) != nrow(results_f.fixed)]
results_f.fixed <- results_f.fixed[complete.cases(results_f.fixed), ]

results_f.fixed[c(1:6,9:10,13), ] <- purrr::modify_if(results_f.fixed[c(1:6,9:10,13), ], ~is.numeric(.), ~round(., 2))
results_f.fixed[c(11:12), ] <- purrr::modify_if(results_f.fixed[c(11:12), ], ~is.numeric(.), ~round(., 0))

results_f.fixed[7,] <- p_judge(results_f.fixed[7,])
results_f.fixed[8,] <- p_judge(results_f.fixed[8,])

results_f.fixed <- results_f.fixed[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "N.group", "N.obs", "LL"),]

datatable(results_f.fixed, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_f.fixed))), pageLength = nrow(results_f.fixed)))
```

<div style="margin-bottom:40px;">
</div>


#### Linear model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_f.lg <- results_table_list$results_f.lg
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_f.lg <- results_f.lg[!(row.names(results_f.lg) %in% remove),]
rownames(results_f.lg)[rownames(results_f.lg)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_f.lg)[rownames(results_f.lg)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_f.lg <- results_f.lg[, colSums(is.na(results_f.lg)) != nrow(results_f.lg)]
results_f.lg <- results_f.lg[complete.cases(results_f.lg), ]

results_f.lg[c(1:6,9:13,16), ] <- purrr::modify_if(results_f.lg[c(1:6,9:13,16), ], ~is.numeric(.), ~round(., 2))
results_f.lg[c(14:15), ] <- purrr::modify_if(results_f.lg[c(14:15), ], ~is.numeric(.), ~round(., 0))

results_f.lg[7,] <- p_judge(results_f.lg[7,])
results_f.lg[8,] <- p_judge(results_f.lg[8,])

results_f.lg <- results_f.lg[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_f.lg, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_f.lg))), pageLength = nrow(results_f.lg)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 15.5, fig.cap = "Figure: Age trajectories of financial risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. The lines represent the age trajectory of linear model results."}
#model data
model_data <- plot_model_data_list$plot_f.lg
#mean data
mean_data <- raw_mean_data_list$plot_f.lg %>%
  filter(Financial_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Financial_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "Financial risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~Panel, nrow = 7)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_f.lg.gender <- results_table_list$results_f.lg.gender
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "gender_Std.Error2")
results_f.lg.gender <- results_f.lg.gender[!(row.names(results_f.lg.gender) %in% remove),]
rownames(results_f.lg.gender)[rownames(results_f.lg.gender)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_f.lg.gender)[rownames(results_f.lg.gender)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_f.lg.gender)[rownames(results_f.lg.gender)=="gender_Std.Error1"] <- "gender_Std.Error"
results_f.lg.gender <- results_f.lg.gender[, colSums(is.na(results_f.lg.gender)) != nrow(results_f.lg.gender)]
results_f.lg.gender <- results_f.lg.gender[complete.cases(results_f.lg.gender), ]

results_f.lg.gender[c(1:9,13:17,20), ] <- purrr::modify_if(results_f.lg.gender[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_f.lg.gender[c(18:19), ] <- purrr::modify_if(results_f.lg.gender[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_f.lg.gender[10,] <- p_judge(results_f.lg.gender[10,])
results_f.lg.gender[11,] <- p_judge(results_f.lg.gender[11,])
results_f.lg.gender[12,] <- p_judge(results_f.lg.gender[12,])

results_f.lg.gender <- results_f.lg.gender[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "gender_Estimate","gender_Std.Error", "gender_t.value", "gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_f.lg.gender, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_f.lg.gender))), pageLength = nrow(results_f.lg.gender)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 15.5, fig.cap = "Figure: Age trajectories of financial risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of linear with gender model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_f.lg.gender
#mean data
mean_data <- raw_mean_data_list$plot_f.lg.gender %>%
  filter(Financial_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Financial_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "Financial risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 7)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender interaction model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_f.lg.inter <- results_table_list$results_f.lg.inter
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "gender_Std.Error2", "d_c_age:gender_Std.Error2")
results_f.lg.inter <- results_f.lg.inter[!(row.names(results_f.lg.inter) %in% remove),]
rownames(results_f.lg.inter)[rownames(results_f.lg.inter)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_f.lg.inter)[rownames(results_f.lg.inter)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_f.lg.inter)[rownames(results_f.lg.inter)=="gender_Std.Error1"] <- "gender_Std.Error"
rownames(results_f.lg.inter)[rownames(results_f.lg.inter)=="d_c_age:gender_Std.Error1"] <- "d_c_age:gender_Std.Error"
results_f.lg.inter <- results_f.lg.inter[, colSums(is.na(results_f.lg.inter)) != nrow(results_f.lg.inter)]
results_f.lg.inter <- results_f.lg.inter[complete.cases(results_f.lg.inter), ]

results_f.lg.inter[c(1:12,17:21,24), ] <- purrr::modify_if(results_f.lg.inter[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_f.lg.inter[c(22:23), ] <- purrr::modify_if(results_f.lg.inter[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_f.lg.inter[13,] <- p_judge(results_f.lg.inter[13,])
results_f.lg.inter[14,] <- p_judge(results_f.lg.inter[14,])
results_f.lg.inter[15,] <- p_judge(results_f.lg.inter[15,])
results_f.lg.inter[16,] <- p_judge(results_f.lg.inter[16,])

results_f.lg.inter <- results_f.lg.inter[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "gender_Estimate", "gender_Std.Error", "gender_t.value", "gender_p.value", "d_c_age:gender_Estimate", "d_c_age:gender_Std.Error", "d_c_age:gender_t.value", "d_c_age:gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_f.lg.inter, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_f.lg.inter))), pageLength = nrow(results_f.lg.inter)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 15.5, fig.cap = "Figure: Age trajectories of financial risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of linear with gender interaction model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_f.lg.inter
#mean data
mean_data <- raw_mean_data_list$plot_f.lg.inter %>%
  filter(Financial_z_n >= 50)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Financial_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "Financial risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 7)
```

<div style="margin-bottom:40px;">
</div>


#### Quadratic model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_f.quad <- results_table_list$results_f.quad
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "I(d_c_age^2)_Std.Error2")
results_f.quad <- results_f.quad[!(row.names(results_f.quad) %in% remove),]
rownames(results_f.quad)[rownames(results_f.quad)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_f.quad)[rownames(results_f.quad)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_f.quad)[rownames(results_f.quad)=="I(d_c_age^2)_Std.Error1"] <- "I(d_c_age^2)_Std.Error"
results_f.quad <- results_f.quad[, colSums(is.na(results_f.quad)) != nrow(results_f.quad)]
results_f.quad <- results_f.quad[complete.cases(results_f.quad), ]

results_f.quad[c(1:9,13:17,20), ] <- purrr::modify_if(results_f.quad[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_f.quad[c(18:19), ] <- purrr::modify_if(results_f.quad[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_f.quad[10,] <- p_judge(results_f.quad[10,])
results_f.quad[11,] <- p_judge(results_f.quad[11,])
results_f.quad[12,] <- p_judge(results_f.quad[12,])


results_f.quad <- results_f.quad[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "I(d_c_age^2)_Estimate", "I(d_c_age^2)_Std.Error", "I(d_c_age^2)_t.value", "I(d_c_age^2)_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_f.quad, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_f.quad))), pageLength = nrow(results_f.quad)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 11.5, fig.cap = "Figure: Age trajectories of financial risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. The lines represent the age trajectory of quadratic model results."}
#model data
model_data <- plot_model_data_list$plot_f.quad
#mean data
mean_data <- raw_mean_data_list$plot_f.quad %>%
  filter(Financial_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Financial_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x + I(x^2), size = 0.5) +
   labs(x= "Age", y= "Financial risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~Panel, nrow = 5)
```

<div style="margin-bottom:40px;">
</div>


#### Quadratic with gender model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_f.quad.gender <- results_table_list$results_f.quad.gender
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "I(d_c_age^2)_Std.Error2","gender_Std.Error2")
results_f.quad.gender <- results_f.quad.gender[!(row.names(results_f.quad.gender) %in% remove),]
rownames(results_f.quad.gender)[rownames(results_f.quad.gender)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_f.quad.gender)[rownames(results_f.quad.gender)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_f.quad.gender)[rownames(results_f.quad.gender)=="I(d_c_age^2)_Std.Error1"] <- "I(d_c_age^2)_Std.Error"
rownames(results_f.quad.gender)[rownames(results_f.quad.gender)=="gender_Std.Error1"] <- "gender_Std.Error1"
results_f.quad.gender <- results_f.quad.gender[, colSums(is.na(results_f.quad.gender)) != nrow(results_f.quad.gender)]
results_f.quad.gender <- results_f.quad.gender[complete.cases(results_f.quad.gender), ]

results_f.quad.gender[c(1:12,17:21,24), ] <- purrr::modify_if(results_f.quad.gender[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_f.quad.gender[c(22:23), ] <- purrr::modify_if(results_f.quad.gender[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_f.quad.gender[13,] <- p_judge(results_f.quad.gender[13,])
results_f.quad.gender[14,] <- p_judge(results_f.quad.gender[14,])
results_f.quad.gender[15,] <- p_judge(results_f.quad.gender[15,])
results_f.quad.gender[16,] <- p_judge(results_f.quad.gender[16,])


results_f.quad.gender <- results_f.quad.gender[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "I(d_c_age^2)_Estimate", "I(d_c_age^2)_Std.Error", "I(d_c_age^2)_t.value", "I(d_c_age^2)_p.value", "gender_Estimate", "gender_Std.Error", "gender_t.value", "gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_f.quad.gender, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_f.quad.gender))), pageLength = nrow(results_f.quad.gender)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 11.5, fig.cap = "Figure: Age trajectories of financial risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of quadratic with gender model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_f.quad.gender
#mean data
mean_data <- raw_mean_data_list$plot_f.quad.gender %>%
  filter(Financial_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Financial_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x + I(x^2), size = 0.5) +
   labs(x= "Age", y= "Financial risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 5)
```

<div style="margin-bottom:40px;">
</div>


### 4.3. Driving risk-taking{.tabset}

#### Intercept only model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_d.int <- results_table_list$results_d.int
remove <- c("Intercept_Std.Error2")
results_d.int <- results_d.int[!(row.names(results_d.int) %in% remove),]
rownames(results_d.int)[rownames(results_d.int)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
results_d.int <- results_d.int[, colSums(is.na(results_d.int)) != nrow(results_d.int)]
results_d.int <- results_d.int[complete.cases(results_d.int), ]
results_d.int[c(1:3,5:8,11), ] <- purrr::modify_if(results_d.int[c(1:3,5:8,11), ], ~is.numeric(.), ~round(., 2))
results_d.int[c(9:10),] <- purrr::modify_if(results_d.int[c(9:10), ], ~is.numeric(.), ~round(., 0))
results_d.int[4,] <- p_judge(results_d.int[4,])

datatable(results_d.int, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_d.int))), pageLength = nrow(results_d.int)))
```

<div style="margin-bottom:40px;">
</div>


#### Fixed effect model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_d.fixed <- results_table_list$results_d.fixed
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_d.fixed <- results_d.fixed[!(row.names(results_d.fixed) %in% remove),]
rownames(results_d.fixed)[rownames(results_d.fixed)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_d.fixed)[rownames(results_d.fixed)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_d.fixed <- results_d.fixed[, colSums(is.na(results_d.fixed)) != nrow(results_d.fixed)]
results_d.fixed <- results_d.fixed[complete.cases(results_d.fixed), ]

results_d.fixed[c(1:6,9:10,13), ] <- purrr::modify_if(results_d.fixed[c(1:6,9:10,13), ], ~is.numeric(.), ~round(., 2))
results_d.fixed[c(11:12), ] <- purrr::modify_if(results_d.fixed[c(11:12), ], ~is.numeric(.), ~round(., 0))

results_d.fixed[7,] <- p_judge(results_d.fixed[7,])
results_d.fixed[8,] <- p_judge(results_d.fixed[8,])

results_d.fixed <- results_d.fixed[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "N.group", "N.obs", "LL"),]

datatable(results_d.fixed, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_d.fixed))), pageLength = nrow(results_d.fixed)))
```

<div style="margin-bottom:40px;">
</div>


#### Linear model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_d.lg <- results_table_list$results_d.lg
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_d.lg <- results_d.lg[!(row.names(results_d.lg) %in% remove),]
rownames(results_d.lg)[rownames(results_d.lg)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_d.lg)[rownames(results_d.lg)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_d.lg <- results_d.lg[, colSums(is.na(results_d.lg)) != nrow(results_d.lg)]
results_d.lg <- results_d.lg[complete.cases(results_d.lg), ]

results_d.lg[c(1:6,9:13,16), ] <- purrr::modify_if(results_d.lg[c(1:6,9:13,16), ], ~is.numeric(.), ~round(., 2))
results_d.lg[c(14:15), ] <- purrr::modify_if(results_d.lg[c(14:15), ], ~is.numeric(.), ~round(., 0))

results_d.lg[7,] <- p_judge(results_d.lg[7,])
results_d.lg[8,] <- p_judge(results_d.lg[8,])

results_d.lg <- results_d.lg[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_d.lg, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_d.lg))), pageLength = nrow(results_d.lg)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 3.5, fig.cap = "Figure: Age trajectories of driving risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. The lines represent the age trajectory of linear model results."}
#model data
model_data <- plot_model_data_list$plot_d.lg
#mean data
mean_data <- raw_mean_data_list$plot_d.lg %>%
  filter(Driving_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Driving_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "Driving risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_d.lg.gender <- results_table_list$results_d.lg.gender
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "gender_Std.Error2")
results_d.lg.gender <- results_d.lg.gender[!(row.names(results_d.lg.gender) %in% remove),]
rownames(results_d.lg.gender)[rownames(results_d.lg.gender)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_d.lg.gender)[rownames(results_d.lg.gender)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_d.lg.gender)[rownames(results_d.lg.gender)=="gender_Std.Error1"] <- "gender_Std.Error"
results_d.lg.gender <- results_d.lg.gender[, colSums(is.na(results_d.lg.gender)) != nrow(results_d.lg.gender)]
results_d.lg.gender <- results_d.lg.gender[complete.cases(results_d.lg.gender), ]

results_d.lg.gender[c(1:9,13:17,20), ] <- purrr::modify_if(results_d.lg.gender[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_d.lg.gender[c(18:19), ] <- purrr::modify_if(results_d.lg.gender[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_d.lg.gender[10,] <- p_judge(results_d.lg.gender[10,])
results_d.lg.gender[11,] <- p_judge(results_d.lg.gender[11,])
results_d.lg.gender[12,] <- p_judge(results_d.lg.gender[12,])

results_d.lg.gender <- results_d.lg.gender[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "gender_Estimate","gender_Std.Error", "gender_t.value", "gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_d.lg.gender, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_d.lg.gender))), pageLength = nrow(results_d.lg.gender)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 3.5, fig.cap = "Figure: Age trajectories of driving risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of linear with gender model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_d.lg.gender
#mean data
mean_data <- raw_mean_data_list$plot_d.lg.gender %>%
  filter(Driving_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Driving_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "Driving risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender interaction model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_d.lg.inter <- results_table_list$results_d.lg.inter
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "gender_Std.Error2", "d_c_age:gender_Std.Error2")
results_d.lg.inter <- results_d.lg.inter[!(row.names(results_d.lg.inter) %in% remove),]
rownames(results_d.lg.inter)[rownames(results_d.lg.inter)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_d.lg.inter)[rownames(results_d.lg.inter)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_d.lg.inter)[rownames(results_d.lg.inter)=="gender_Std.Error1"] <- "gender_Std.Error"
rownames(results_d.lg.inter)[rownames(results_d.lg.inter)=="d_c_age:gender_Std.Error1"] <- "d_c_age:gender_Std.Error"
results_d.lg.inter <- results_d.lg.inter[, colSums(is.na(results_d.lg.inter)) != nrow(results_d.lg.inter)]
results_d.lg.inter <- results_d.lg.inter[complete.cases(results_d.lg.inter), ]

results_d.lg.inter[c(1:12,17:21,24), ] <- purrr::modify_if(results_d.lg.inter[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_d.lg.inter[c(22:23), ] <- purrr::modify_if(results_d.lg.inter[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_d.lg.inter[13,] <- p_judge(results_d.lg.inter[13,])
results_d.lg.inter[14,] <- p_judge(results_d.lg.inter[14,])
results_d.lg.inter[15,] <- p_judge(results_d.lg.inter[15,])
results_d.lg.inter[16,] <- p_judge(results_d.lg.inter[16,])

results_d.lg.inter <- results_d.lg.inter[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "gender_Estimate", "gender_Std.Error", "gender_t.value", "gender_p.value", "d_c_age:gender_Estimate", "d_c_age:gender_Std.Error", "d_c_age:gender_t.value", "d_c_age:gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_d.lg.inter, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_d.lg.inter))), pageLength = nrow(results_d.lg.inter)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 3.5, fig.cap = "Figure: Age trajectories of driving risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of linear with gender interation model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_d.lg.inter
#mean data
mean_data <- raw_mean_data_list$plot_d.lg.inter %>%
  filter(Driving_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Driving_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "Driving risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Quadratic model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_d.quad <- results_table_list$results_d.quad
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "I(d_c_age^2)_Std.Error2")
results_d.quad <- results_d.quad[!(row.names(results_d.quad) %in% remove),]
rownames(results_d.quad)[rownames(results_d.quad)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_d.quad)[rownames(results_d.quad)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_d.quad)[rownames(results_d.quad)=="I(d_c_age^2)_Std.Error1"] <- "I(d_c_age^2)_Std.Error"
results_d.quad <- results_d.quad[, colSums(is.na(results_d.quad)) != nrow(results_d.quad), drop = FALSE]
results_d.quad <- results_d.quad[complete.cases(results_d.quad), 1, drop = FALSE]

results_d.quad[c(1:9,13:17,20), ] <- purrr::modify_if(results_d.quad[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_d.quad[c(18:19), ] <- purrr::modify_if(results_d.quad[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_d.quad[10,] <- p_judge(results_d.quad[10,])
results_d.quad[11,] <- p_judge(results_d.quad[11,])
results_d.quad[12,] <- p_judge(results_d.quad[12,])


results_d.quad <- results_d.quad[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "I(d_c_age^2)_Estimate", "I(d_c_age^2)_Std.Error", "I(d_c_age^2)_t.value", "I(d_c_age^2)_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"), 1, drop = FALSE]

datatable(results_d.quad, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_d.quad))), pageLength = nrow(results_d.quad)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 3.2, fig.height = 3.5, fig.cap = "Figure: Age trajectories of driving risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. The lines represent the age trajectory of quadratic model results."}
#model data
model_data <- plot_model_data_list$plot_d.quad
#mean data
mean_data <- raw_mean_data_list$plot_d.quad %>%
  filter(Driving_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Driving_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x + I(x^2), size = 0.5) +
   labs(x= "Age", y= "Driving risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~Panel, nrow = 5)
```

<div style="margin-bottom:40px;">
</div>


#### Quadratic with gender model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_d.quad.gender <- results_table_list$results_d.quad.gender
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "I(d_c_age^2)_Std.Error2","gender_Std.Error2")
results_d.quad.gender <- results_d.quad.gender[!(row.names(results_d.quad.gender) %in% remove),]
rownames(results_d.quad.gender)[rownames(results_d.quad.gender)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_d.quad.gender)[rownames(results_d.quad.gender)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_d.quad.gender)[rownames(results_d.quad.gender)=="I(d_c_age^2)_Std.Error1"] <- "I(d_c_age^2)_Std.Error"
rownames(results_d.quad.gender)[rownames(results_d.quad.gender)=="gender_Std.Error1"] <- "gender_Std.Error1"
results_d.quad.gender <- results_d.quad.gender[, colSums(is.na(results_d.quad.gender)) != nrow(results_d.quad.gender), drop = FALSE]
results_d.quad.gender <- results_d.quad.gender[complete.cases(results_d.quad.gender), 1, drop = FALSE ]

results_d.quad.gender[c(1:12,17:21,24), ] <- purrr::modify_if(results_d.quad.gender[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_d.quad.gender[c(22:23), ] <- purrr::modify_if(results_d.quad.gender[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_d.quad.gender[13,] <- p_judge(results_d.quad.gender[13,])
results_d.quad.gender[14,] <- p_judge(results_d.quad.gender[14,])
results_d.quad.gender[15,] <- p_judge(results_d.quad.gender[15,])
results_d.quad.gender[16,] <- p_judge(results_d.quad.gender[16,])


results_d.quad.gender <- results_d.quad.gender[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "I(d_c_age^2)_Estimate", "I(d_c_age^2)_Std.Error", "I(d_c_age^2)_t.value", "I(d_c_age^2)_p.value", "gender_Estimate", "gender_Std.Error", "gender_t.value", "gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"), 1, drop = FALSE]

datatable(results_d.quad.gender, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_d.quad.gender))), pageLength = nrow(results_d.quad.gender)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 3.2, fig.height = 3.5,, fig.cap = "Figure: Age trajectories of driving risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of quadratic with gender model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_d.quad.gender
#mean data
mean_data <- raw_mean_data_list$plot_d.quad.gender %>%
  filter(Driving_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Driving_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x + I(x^2), size = 0.5) +
   labs(x= "Age", y= "Driving risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 5)
```

<div style="margin-bottom:40px;">
</div>


### 4.4. Recreational risk-taking{.tabset}

#### Intercept only model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_r.int <- results_table_list$results_r.int
remove <- c("Intercept_Std.Error2")
results_r.int <- results_r.int[!(row.names(results_r.int) %in% remove),]
rownames(results_r.int)[rownames(results_r.int)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
results_r.int <- results_r.int[, colSums(is.na(results_r.int)) != nrow(results_r.int)]
results_r.int <- results_r.int[complete.cases(results_r.int), ]
results_r.int[c(1:3,5:8,11), ] <- purrr::modify_if(results_r.int[c(1:3,5:8,11), ], ~is.numeric(.), ~round(., 2))
results_r.int[c(9:10),] <- purrr::modify_if(results_r.int[c(9:10), ], ~is.numeric(.), ~round(., 0))
results_r.int[4,] <- p_judge(results_r.int[4,])

datatable(results_r.int, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_r.int))), pageLength = nrow(results_r.int)))
```

<div style="margin-bottom:40px;">
</div>


#### Fixed effect model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_r.fixed <- results_table_list$results_r.fixed
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_r.fixed <- results_r.fixed[!(row.names(results_r.fixed) %in% remove),]
rownames(results_r.fixed)[rownames(results_r.fixed)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_r.fixed)[rownames(results_r.fixed)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_r.fixed <- results_r.fixed[, colSums(is.na(results_r.fixed)) != nrow(results_r.fixed)]
results_r.fixed <- results_r.fixed[complete.cases(results_r.fixed), ]

results_r.fixed[c(1:6,9:10,13), ] <- purrr::modify_if(results_r.fixed[c(1:6,9:10,13), ], ~is.numeric(.), ~round(., 2))
results_r.fixed[c(11:12), ] <- purrr::modify_if(results_r.fixed[c(11:12), ], ~is.numeric(.), ~round(., 0))

results_r.fixed[7,] <- p_judge(results_r.fixed[7,])
results_r.fixed[8,] <- p_judge(results_r.fixed[8,])

results_r.fixed <- results_r.fixed[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "N.group", "N.obs", "LL"),]

datatable(results_r.fixed, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_r.fixed))), pageLength = nrow(results_r.fixed)))
```

<div style="margin-bottom:40px;">
</div>


#### Linear model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_r.lg <- results_table_list$results_r.lg
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_r.lg <- results_r.lg[!(row.names(results_r.lg) %in% remove),]
rownames(results_r.lg)[rownames(results_r.lg)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_r.lg)[rownames(results_r.lg)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_r.lg <- results_r.lg[, colSums(is.na(results_r.lg)) != nrow(results_r.lg)]
results_r.lg <- results_r.lg[complete.cases(results_r.lg), ]

results_r.lg[c(1:6,9:13,16), ] <- purrr::modify_if(results_r.lg[c(1:6,9:13,16), ], ~is.numeric(.), ~round(., 2))
results_r.lg[c(14:15), ] <- purrr::modify_if(results_r.lg[c(14:15), ], ~is.numeric(.), ~round(., 0))

results_r.lg[7,] <- p_judge(results_r.lg[7,])
results_r.lg[8,] <- p_judge(results_r.lg[8,])

results_r.lg <- results_r.lg[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_r.lg, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_r.lg))), pageLength = nrow(results_r.lg)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 3.5, fig.cap = "Figure: Age trajectories of recreational risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. The lines represent the age trajectory of linear model results."}
#model data
model_data <- plot_model_data_list$plot_r.lg
#mean data
mean_data <- raw_mean_data_list$plot_r.lg %>%
  filter(Recreational_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Recreational_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "Recreational risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_r.lg.gender <- results_table_list$results_r.lg.gender
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "gender_Std.Error2")
results_r.lg.gender <- results_r.lg.gender[!(row.names(results_r.lg.gender) %in% remove),]
rownames(results_r.lg.gender)[rownames(results_r.lg.gender)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_r.lg.gender)[rownames(results_r.lg.gender)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_r.lg.gender)[rownames(results_r.lg.gender)=="gender_Std.Error1"] <- "gender_Std.Error"
results_r.lg.gender <- results_r.lg.gender[, colSums(is.na(results_r.lg.gender)) != nrow(results_r.lg.gender)]
results_r.lg.gender <- results_r.lg.gender[complete.cases(results_r.lg.gender), ]

results_r.lg.gender[c(1:9,13:17,20), ] <- purrr::modify_if(results_r.lg.gender[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_r.lg.gender[c(18:19), ] <- purrr::modify_if(results_r.lg.gender[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_r.lg.gender[10,] <- p_judge(results_r.lg.gender[10,])
results_r.lg.gender[11,] <- p_judge(results_r.lg.gender[11,])
results_r.lg.gender[12,] <- p_judge(results_r.lg.gender[12,])

results_r.lg.gender <- results_r.lg.gender[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "gender_Estimate","gender_Std.Error", "gender_t.value", "gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_r.lg.gender, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_r.lg.gender))), pageLength = nrow(results_r.lg.gender)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 3.5, fig.cap = "Figure: Age trajectories of recreational risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of linear with gender model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_r.lg.gender
#mean data
mean_data <- raw_mean_data_list$plot_r.lg.gender %>%
  filter(Recreational_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Recreational_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "Recreational risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender interaction model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_r.lg.inter <- results_table_list$results_r.lg.inter
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "gender_Std.Error2", "d_c_age:gender_Std.Error2")
results_r.lg.inter <- results_r.lg.inter[!(row.names(results_r.lg.inter) %in% remove),]
rownames(results_r.lg.inter)[rownames(results_r.lg.inter)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_r.lg.inter)[rownames(results_r.lg.inter)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_r.lg.inter)[rownames(results_r.lg.inter)=="gender_Std.Error1"] <- "gender_Std.Error"
rownames(results_r.lg.inter)[rownames(results_r.lg.inter)=="d_c_age:gender_Std.Error1"] <- "d_c_age:gender_Std.Error"
results_r.lg.inter <- results_r.lg.inter[, colSums(is.na(results_r.lg.inter)) != nrow(results_r.lg.inter)]
results_r.lg.inter <- results_r.lg.inter[complete.cases(results_r.lg.inter), ]

results_r.lg.inter[c(1:12,17:21,24), ] <- purrr::modify_if(results_r.lg.inter[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_r.lg.inter[c(22:23), ] <- purrr::modify_if(results_r.lg.inter[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_r.lg.inter[13,] <- p_judge(results_r.lg.inter[13,])
results_r.lg.inter[14,] <- p_judge(results_r.lg.inter[14,])
results_r.lg.inter[15,] <- p_judge(results_r.lg.inter[15,])
results_r.lg.inter[16,] <- p_judge(results_r.lg.inter[16,])

results_r.lg.inter <- results_r.lg.inter[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "gender_Estimate", "gender_Std.Error", "gender_t.value", "gender_p.value", "d_c_age:gender_Estimate", "d_c_age:gender_Std.Error", "d_c_age:gender_t.value", "d_c_age:gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_r.lg.inter, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_r.lg.inter))), pageLength = nrow(results_r.lg.inter)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 3.5, fig.cap = "Figure: Age trajectories of recreational risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of linear with gender interaction model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_r.lg.inter
#mean data
mean_data <- raw_mean_data_list$plot_r.lg.inter %>%
  filter(Recreational_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Recreational_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "Recreational risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Quadratic model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_r.quad <- results_table_list$results_r.quad
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "I(d_c_age^2)_Std.Error2")
results_r.quad <- results_r.quad[!(row.names(results_r.quad) %in% remove),]
rownames(results_r.quad)[rownames(results_r.quad)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_r.quad)[rownames(results_r.quad)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_r.quad)[rownames(results_r.quad)=="I(d_c_age^2)_Std.Error1"] <- "I(d_c_age^2)_Std.Error"
results_r.quad <- results_r.quad[, colSums(is.na(results_r.quad)) != nrow(results_r.quad), drop = FALSE]
results_r.quad <- results_r.quad[complete.cases(results_r.quad), 1, drop = FALSE]

results_r.quad[c(1:9,13:17,20), ] <- purrr::modify_if(results_r.quad[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_r.quad[c(18:19), ] <- purrr::modify_if(results_r.quad[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_r.quad[10,] <- p_judge(results_r.quad[10,])
results_r.quad[11,] <- p_judge(results_r.quad[11,])
results_r.quad[12,] <- p_judge(results_r.quad[12,])


results_r.quad <- results_r.quad[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "I(d_c_age^2)_Estimate", "I(d_c_age^2)_Std.Error", "I(d_c_age^2)_t.value", "I(d_c_age^2)_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"), 1, drop = FALSE]

datatable(results_r.quad, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_r.quad))), pageLength = nrow(results_r.quad)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 3.2, fig.height = 3.5, fig.cap = "Figure: Age trajectories of recreational risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. The lines represent the age trajectory of quadratic model results."}
#model data
model_data <- plot_model_data_list$plot_r.quad
#mean data
mean_data <- raw_mean_data_list$plot_r.quad %>%
  filter(Recreational_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Recreational_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x + I(x^2), size = 0.5) +
   labs(x= "Age", y= "Recreational risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~Panel, nrow = 5)
```

<div style="margin-bottom:40px;">
</div>


#### Quadratic with gender model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_r.quad.gender <- results_table_list$results_r.quad.gender
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "I(d_c_age^2)_Std.Error2","gender_Std.Error2")
results_r.quad.gender <- results_r.quad.gender[!(row.names(results_r.quad.gender) %in% remove),]
rownames(results_r.quad.gender)[rownames(results_r.quad.gender)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_r.quad.gender)[rownames(results_r.quad.gender)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_r.quad.gender)[rownames(results_r.quad.gender)=="I(d_c_age^2)_Std.Error1"] <- "I(d_c_age^2)_Std.Error"
rownames(results_r.quad.gender)[rownames(results_r.quad.gender)=="gender_Std.Error1"] <- "gender_Std.Error1"
results_r.quad.gender <- results_r.quad.gender[, colSums(is.na(results_r.quad.gender)) != nrow(results_r.quad.gender), drop = FALSE]
results_r.quad.gender <- results_r.quad.gender[complete.cases(results_r.quad.gender), 1, drop = FALSE ]

results_r.quad.gender[c(1:12,17:21,24), ] <- purrr::modify_if(results_r.quad.gender[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_r.quad.gender[c(22:23), ] <- purrr::modify_if(results_r.quad.gender[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_r.quad.gender[13,] <- p_judge(results_r.quad.gender[13,])
results_r.quad.gender[14,] <- p_judge(results_r.quad.gender[14,])
results_r.quad.gender[15,] <- p_judge(results_r.quad.gender[15,])
results_r.quad.gender[16,] <- p_judge(results_r.quad.gender[16,])


results_r.quad.gender <- results_r.quad.gender[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "I(d_c_age^2)_Estimate", "I(d_c_age^2)_Std.Error", "I(d_c_age^2)_t.value", "I(d_c_age^2)_p.value", "gender_Estimate", "gender_Std.Error", "gender_t.value", "gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"), 1, drop = FALSE]

datatable(results_r.quad.gender, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_r.quad.gender))), pageLength = nrow(results_r.quad.gender)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 3.2, fig.height = 3.5,, fig.cap = "Figure: Age trajectories of recreational risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of quadratic with gender model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_r.quad.gender
#mean data
mean_data <- raw_mean_data_list$plot_r.quad.gender %>%
  filter(Recreational_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Recreational_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x + I(x^2), size = 0.5) +
   labs(x= "Age", y= "Recreational risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 5)
```

<div style="margin-bottom:40px;">
</div>


### 4.5. Occupational risk-taking{.tabset}

#### Intercept only model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_o.int <- results_table_list$results_o.int
remove <- c("Intercept_Std.Error2")
results_o.int <- results_o.int[!(row.names(results_o.int) %in% remove),]
rownames(results_o.int)[rownames(results_o.int)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
results_o.int <- results_o.int[, colSums(is.na(results_o.int)) != nrow(results_o.int)]
results_o.int <- results_o.int[complete.cases(results_o.int), ]
results_o.int[c(1:3,5:8,11), ] <- purrr::modify_if(results_o.int[c(1:3,5:8,11), ], ~is.numeric(.), ~round(., 2))
results_o.int[c(9:10),] <- purrr::modify_if(results_o.int[c(9:10), ], ~is.numeric(.), ~round(., 0))
results_o.int[4,] <- p_judge(results_o.int[4,])

datatable(results_o.int, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_o.int))), pageLength = nrow(results_o.int)))
```

<div style="margin-bottom:40px;">
</div>


#### Fixed effect model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_o.fixed <- results_table_list$results_o.fixed
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_o.fixed <- results_o.fixed[!(row.names(results_o.fixed) %in% remove),]
rownames(results_o.fixed)[rownames(results_o.fixed)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_o.fixed)[rownames(results_o.fixed)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_o.fixed <- results_o.fixed[, colSums(is.na(results_o.fixed)) != nrow(results_o.fixed)]
results_o.fixed <- results_o.fixed[complete.cases(results_o.fixed), ]

results_o.fixed[c(1:6,9:10,13), ] <- purrr::modify_if(results_o.fixed[c(1:6,9:10,13), ], ~is.numeric(.), ~round(., 2))
results_o.fixed[c(11:12), ] <- purrr::modify_if(results_o.fixed[c(11:12), ], ~is.numeric(.), ~round(., 0))

results_o.fixed[7,] <- p_judge(results_o.fixed[7,])
results_o.fixed[8,] <- p_judge(results_o.fixed[8,])

results_o.fixed <- results_o.fixed[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "N.group", "N.obs", "LL"),]

datatable(results_o.fixed, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_o.fixed))), pageLength = nrow(results_o.fixed)))
```

<div style="margin-bottom:40px;">
</div>


#### Linear model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_o.lg <- results_table_list$results_o.lg
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_o.lg <- results_o.lg[!(row.names(results_o.lg) %in% remove),]
rownames(results_o.lg)[rownames(results_o.lg)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_o.lg)[rownames(results_o.lg)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_o.lg <- results_o.lg[, colSums(is.na(results_o.lg)) != nrow(results_o.lg)]
results_o.lg <- results_o.lg[complete.cases(results_o.lg), ]

results_o.lg[c(1:6,9:13,16), ] <- purrr::modify_if(results_o.lg[c(1:6,9:13,16), ], ~is.numeric(.), ~round(., 2))
results_o.lg[c(14:15), ] <- purrr::modify_if(results_o.lg[c(14:15), ], ~is.numeric(.), ~round(., 0))

results_o.lg[7,] <- p_judge(results_o.lg[7,])
results_o.lg[8,] <- p_judge(results_o.lg[8,])

results_o.lg <- results_o.lg[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_o.lg, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_o.lg))), pageLength = nrow(results_o.lg)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 3.5, fig.cap = "Figure: Age trajectories of occupational risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. The lines represent the age trajectory of linear model results."}
#model data
model_data <- plot_model_data_list$plot_o.lg
#mean data
mean_data <- raw_mean_data_list$plot_o.lg %>%
  filter(Occupational_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Occupational_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "Occupational risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_o.lg.gender <- results_table_list$results_o.lg.gender
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "gender_Std.Error2")
results_o.lg.gender <- results_o.lg.gender[!(row.names(results_o.lg.gender) %in% remove),]
rownames(results_o.lg.gender)[rownames(results_o.lg.gender)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_o.lg.gender)[rownames(results_o.lg.gender)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_o.lg.gender)[rownames(results_o.lg.gender)=="gender_Std.Error1"] <- "gender_Std.Error"
results_o.lg.gender <- results_o.lg.gender[, colSums(is.na(results_o.lg.gender)) != nrow(results_o.lg.gender)]
results_o.lg.gender <- results_o.lg.gender[complete.cases(results_o.lg.gender), ]

results_o.lg.gender[c(1:9,13:17,20), ] <- purrr::modify_if(results_o.lg.gender[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_o.lg.gender[c(18:19), ] <- purrr::modify_if(results_o.lg.gender[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_o.lg.gender[10,] <- p_judge(results_o.lg.gender[10,])
results_o.lg.gender[11,] <- p_judge(results_o.lg.gender[11,])
results_o.lg.gender[12,] <- p_judge(results_o.lg.gender[12,])

results_o.lg.gender <- results_o.lg.gender[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "gender_Estimate","gender_Std.Error", "gender_t.value", "gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_o.lg.gender, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_o.lg.gender))), pageLength = nrow(results_o.lg.gender)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 3.5, fig.cap = "Figure: Age trajectories of occupational risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of linear with gender model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_o.lg.gender
#mean data
mean_data <- raw_mean_data_list$plot_o.lg.gender %>%
  filter(Occupational_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Occupational_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "Occupational risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender interaction model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_o.lg.inter <- results_table_list$results_o.lg.inter
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "gender_Std.Error2", "d_c_age:gender_Std.Error2")
results_o.lg.inter <- results_o.lg.inter[!(row.names(results_o.lg.inter) %in% remove),]
rownames(results_o.lg.inter)[rownames(results_o.lg.inter)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_o.lg.inter)[rownames(results_o.lg.inter)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_o.lg.inter)[rownames(results_o.lg.inter)=="gender_Std.Error1"] <- "gender_Std.Error"
rownames(results_o.lg.inter)[rownames(results_o.lg.inter)=="d_c_age:gender_Std.Error1"] <- "d_c_age:gender_Std.Error"
results_o.lg.inter <- results_o.lg.inter[, colSums(is.na(results_o.lg.inter)) != nrow(results_o.lg.inter)]
results_o.lg.inter <- results_o.lg.inter[complete.cases(results_o.lg.inter), ]

results_o.lg.inter[c(1:12,17:21,24), ] <- purrr::modify_if(results_o.lg.inter[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_o.lg.inter[c(22:23), ] <- purrr::modify_if(results_o.lg.inter[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_o.lg.inter[13,] <- p_judge(results_o.lg.inter[13,])
results_o.lg.inter[14,] <- p_judge(results_o.lg.inter[14,])
results_o.lg.inter[15,] <- p_judge(results_o.lg.inter[15,])
results_o.lg.inter[16,] <- p_judge(results_o.lg.inter[16,])

results_o.lg.inter <- results_o.lg.inter[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "gender_Estimate", "gender_Std.Error", "gender_t.value", "gender_p.value", "d_c_age:gender_Estimate", "d_c_age:gender_Std.Error", "d_c_age:gender_t.value", "d_c_age:gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_o.lg.inter, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_o.lg.inter))), pageLength = nrow(results_o.lg.inter)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 3.5, fig.cap = "Figure: Age trajectories of occupational risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of linear with gender interaction model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_o.lg.inter
#mean data
mean_data <- raw_mean_data_list$plot_o.lg.inter %>%
  filter(Occupational_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Occupational_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "Occupational risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Quadratic model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_o.quad <- results_table_list$results_o.quad
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "I(d_c_age^2)_Std.Error2")
results_o.quad <- results_o.quad[!(row.names(results_o.quad) %in% remove),]
rownames(results_o.quad)[rownames(results_o.quad)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_o.quad)[rownames(results_o.quad)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_o.quad)[rownames(results_o.quad)=="I(d_c_age^2)_Std.Error1"] <- "I(d_c_age^2)_Std.Error"
results_o.quad <- results_o.quad[, colSums(is.na(results_o.quad)) != nrow(results_o.quad), drop = FALSE]
results_o.quad <- results_o.quad[complete.cases(results_o.quad), 1, drop = FALSE]

results_o.quad[c(1:9,13:17,20), ] <- purrr::modify_if(results_o.quad[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_o.quad[c(18:19), ] <- purrr::modify_if(results_o.quad[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_o.quad[10,] <- p_judge(results_o.quad[10,])
results_o.quad[11,] <- p_judge(results_o.quad[11,])
results_o.quad[12,] <- p_judge(results_o.quad[12,])


results_o.quad <- results_o.quad[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "I(d_c_age^2)_Estimate", "I(d_c_age^2)_Std.Error", "I(d_c_age^2)_t.value", "I(d_c_age^2)_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"), 1, drop = FALSE]

datatable(results_o.quad, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_o.quad))), pageLength = nrow(results_o.quad)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 3.2, fig.height = 3.5, fig.cap = "Figure: Age trajectories of occupational risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. The lines represent the age trajectory of quadratic model results."}
#model data
model_data <- plot_model_data_list$plot_o.quad
#mean data
mean_data <- raw_mean_data_list$plot_o.quad %>%
  filter(Occupational_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Occupational_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x + I(x^2), size = 0.5) +
   labs(x= "Age", y= "Occupational risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~Panel, nrow = 5)
```

<div style="margin-bottom:40px;">
</div>


#### Quadratic with gender model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_o.quad.gender <- results_table_list$results_o.quad.gender
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "I(d_c_age^2)_Std.Error2","gender_Std.Error2")
results_o.quad.gender <- results_o.quad.gender[!(row.names(results_o.quad.gender) %in% remove),]
rownames(results_o.quad.gender)[rownames(results_o.quad.gender)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_o.quad.gender)[rownames(results_o.quad.gender)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_o.quad.gender)[rownames(results_o.quad.gender)=="I(d_c_age^2)_Std.Error1"] <- "I(d_c_age^2)_Std.Error"
rownames(results_o.quad.gender)[rownames(results_o.quad.gender)=="gender_Std.Error1"] <- "gender_Std.Error1"
results_o.quad.gender <- results_o.quad.gender[, colSums(is.na(results_o.quad.gender)) != nrow(results_o.quad.gender), drop = FALSE]
results_o.quad.gender <- results_o.quad.gender[complete.cases(results_o.quad.gender), 1, drop = FALSE ]

results_o.quad.gender[c(1:12,17:21,24), ] <- purrr::modify_if(results_o.quad.gender[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_o.quad.gender[c(22:23), ] <- purrr::modify_if(results_o.quad.gender[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_o.quad.gender[13,] <- p_judge(results_o.quad.gender[13,])
results_o.quad.gender[14,] <- p_judge(results_o.quad.gender[14,])
results_o.quad.gender[15,] <- p_judge(results_o.quad.gender[15,])
results_o.quad.gender[16,] <- p_judge(results_o.quad.gender[16,])


results_o.quad.gender <- results_o.quad.gender[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "I(d_c_age^2)_Estimate", "I(d_c_age^2)_Std.Error", "I(d_c_age^2)_t.value", "I(d_c_age^2)_p.value", "gender_Estimate", "gender_Std.Error", "gender_t.value", "gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"), 1, drop = FALSE]

datatable(results_o.quad.gender, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_o.quad.gender))), pageLength = nrow(results_o.quad.gender)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 3.2, fig.height = 3.5,, fig.cap = "Figure: Age trajectories of occupational risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of quadratic with gender model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_o.quad.gender
#mean data
mean_data <- raw_mean_data_list$plot_o.quad.gender %>%
  filter(Occupational_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Occupational_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x + I(x^2), size = 0.5) +
   labs(x= "Age", y= "Occupational risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 5)
```

<div style="margin-bottom:40px;">
</div>


### 4.6. Health risk-taking{.tabset}

#### Intercept only model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_h.int <- results_table_list$results_h.int
remove <- c("Intercept_Std.Error2")
results_h.int <- results_h.int[!(row.names(results_h.int) %in% remove),]
rownames(results_h.int)[rownames(results_h.int)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
results_h.int <- results_h.int[, colSums(is.na(results_h.int)) != nrow(results_h.int)]
results_h.int <- results_h.int[complete.cases(results_h.int), ]
results_h.int[c(1:3,5:8,11), ] <- purrr::modify_if(results_h.int[c(1:3,5:8,11), ], ~is.numeric(.), ~round(., 2))
results_h.int[c(9:10),] <- purrr::modify_if(results_h.int[c(9:10), ], ~is.numeric(.), ~round(., 0))
results_h.int[4,] <- p_judge(results_h.int[4,])

datatable(results_h.int, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_h.int))), pageLength = nrow(results_h.int)))
```

<div style="margin-bottom:40px;">
</div>


#### Fixed effect model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_h.fixed <- results_table_list$results_h.fixed
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_h.fixed <- results_h.fixed[!(row.names(results_h.fixed) %in% remove),]
rownames(results_h.fixed)[rownames(results_h.fixed)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_h.fixed)[rownames(results_h.fixed)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_h.fixed <- results_h.fixed[, colSums(is.na(results_h.fixed)) != nrow(results_h.fixed)]
results_h.fixed <- results_h.fixed[complete.cases(results_h.fixed), ]

results_h.fixed[c(1:6,9:10,13), ] <- purrr::modify_if(results_h.fixed[c(1:6,9:10,13), ], ~is.numeric(.), ~round(., 2))
results_h.fixed[c(11:12), ] <- purrr::modify_if(results_h.fixed[c(11:12), ], ~is.numeric(.), ~round(., 0))

results_h.fixed[7,] <- p_judge(results_h.fixed[7,])
results_h.fixed[8,] <- p_judge(results_h.fixed[8,])

results_h.fixed <- results_h.fixed[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "N.group", "N.obs", "LL"),]

datatable(results_h.fixed, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_h.fixed))), pageLength = nrow(results_h.fixed)))
```

<div style="margin-bottom:40px;">
</div>


#### Linear model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_h.lg <- results_table_list$results_h.lg
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_h.lg <- results_h.lg[!(row.names(results_h.lg) %in% remove),]
rownames(results_h.lg)[rownames(results_h.lg)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_h.lg)[rownames(results_h.lg)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_h.lg <- results_h.lg[, colSums(is.na(results_h.lg)) != nrow(results_h.lg)]
results_h.lg <- results_h.lg[complete.cases(results_h.lg), ]

results_h.lg[c(1:6,9:13,16), ] <- purrr::modify_if(results_h.lg[c(1:6,9:13,16), ], ~is.numeric(.), ~round(., 2))
results_h.lg[c(14:15), ] <- purrr::modify_if(results_h.lg[c(14:15), ], ~is.numeric(.), ~round(., 0))

results_h.lg[7,] <- p_judge(results_h.lg[7,])
results_h.lg[8,] <- p_judge(results_h.lg[8,])

results_h.lg <- results_h.lg[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_h.lg, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_h.lg))), pageLength = nrow(results_h.lg)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 3.5, fig.cap = "Figure: Age trajectories of health risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. The lines represent the age trajectory of linear model results."}
#model data
model_data <- plot_model_data_list$plot_h.lg
#mean data
mean_data <- raw_mean_data_list$plot_h.lg %>%
  filter(Health_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Health_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "Health risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_h.lg.gender <- results_table_list$results_h.lg.gender
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "gender_Std.Error2")
results_h.lg.gender <- results_h.lg.gender[!(row.names(results_h.lg.gender) %in% remove),]
rownames(results_h.lg.gender)[rownames(results_h.lg.gender)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_h.lg.gender)[rownames(results_h.lg.gender)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_h.lg.gender)[rownames(results_h.lg.gender)=="gender_Std.Error1"] <- "gender_Std.Error"
results_h.lg.gender <- results_h.lg.gender[, colSums(is.na(results_h.lg.gender)) != nrow(results_h.lg.gender)]
results_h.lg.gender <- results_h.lg.gender[complete.cases(results_h.lg.gender), ]

results_h.lg.gender[c(1:9,13:17,20), ] <- purrr::modify_if(results_h.lg.gender[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_h.lg.gender[c(18:19), ] <- purrr::modify_if(results_h.lg.gender[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_h.lg.gender[10,] <- p_judge(results_h.lg.gender[10,])
results_h.lg.gender[11,] <- p_judge(results_h.lg.gender[11,])
results_h.lg.gender[12,] <- p_judge(results_h.lg.gender[12,])

results_h.lg.gender <- results_h.lg.gender[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "gender_Estimate","gender_Std.Error", "gender_t.value", "gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_h.lg.gender, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_h.lg.gender))), pageLength = nrow(results_h.lg.gender)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 3.5, fig.cap = "Figure: Age trajectories of health risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of linear with gender model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_h.lg.gender
#mean data
mean_data <- raw_mean_data_list$plot_h.lg.gender %>%
  filter(Health_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Health_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "Health risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender interaction model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_h.lg.inter <- results_table_list$results_h.lg.inter
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "gender_Std.Error2", "d_c_age:gender_Std.Error2")
results_h.lg.inter <- results_h.lg.inter[!(row.names(results_h.lg.inter) %in% remove),]
rownames(results_h.lg.inter)[rownames(results_h.lg.inter)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_h.lg.inter)[rownames(results_h.lg.inter)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_h.lg.inter)[rownames(results_h.lg.inter)=="gender_Std.Error1"] <- "gender_Std.Error"
rownames(results_h.lg.inter)[rownames(results_h.lg.inter)=="d_c_age:gender_Std.Error1"] <- "d_c_age:gender_Std.Error"
results_h.lg.inter <- results_h.lg.inter[, colSums(is.na(results_h.lg.inter)) != nrow(results_h.lg.inter)]
results_h.lg.inter <- results_h.lg.inter[complete.cases(results_h.lg.inter), ]

results_h.lg.inter[c(1:12,17:21,24), ] <- purrr::modify_if(results_h.lg.inter[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_h.lg.inter[c(22:23), ] <- purrr::modify_if(results_h.lg.inter[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_h.lg.inter[13,] <- p_judge(results_h.lg.inter[13,])
results_h.lg.inter[14,] <- p_judge(results_h.lg.inter[14,])
results_h.lg.inter[15,] <- p_judge(results_h.lg.inter[15,])
results_h.lg.inter[16,] <- p_judge(results_h.lg.inter[16,])

results_h.lg.inter <- results_h.lg.inter[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "gender_Estimate", "gender_Std.Error", "gender_t.value", "gender_p.value", "d_c_age:gender_Estimate", "d_c_age:gender_Std.Error", "d_c_age:gender_t.value", "d_c_age:gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_h.lg.inter, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_h.lg.inter))), pageLength = nrow(results_h.lg.inter)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 3.5, fig.cap = "Figure: Age trajectories of health risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of linear with gender interaction model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_h.lg.inter
#mean data
mean_data <- raw_mean_data_list$plot_h.lg.inter %>%
  filter(Health_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Health_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "Health risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>

#### Quadratic model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_h.quad <- results_table_list$results_h.quad
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "I(d_c_age^2)_Std.Error2")
results_h.quad <- results_h.quad[!(row.names(results_h.quad) %in% remove),]
rownames(results_h.quad)[rownames(results_h.quad)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_h.quad)[rownames(results_h.quad)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_h.quad)[rownames(results_h.quad)=="I(d_c_age^2)_Std.Error1"] <- "I(d_c_age^2)_Std.Error"
results_h.quad <- results_h.quad[, colSums(is.na(results_h.quad)) != nrow(results_h.quad), drop = FALSE]
results_h.quad <- results_h.quad[complete.cases(results_h.quad), 1, drop = FALSE]

results_h.quad[c(1:9,13:17,20), ] <- purrr::modify_if(results_h.quad[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_h.quad[c(18:19), ] <- purrr::modify_if(results_h.quad[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_h.quad[10,] <- p_judge(results_h.quad[10,])
results_h.quad[11,] <- p_judge(results_h.quad[11,])
results_h.quad[12,] <- p_judge(results_h.quad[12,])


results_h.quad <- results_h.quad[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "I(d_c_age^2)_Estimate", "I(d_c_age^2)_Std.Error", "I(d_c_age^2)_t.value", "I(d_c_age^2)_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"), 1, drop = FALSE]

datatable(results_h.quad, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_h.quad))), pageLength = nrow(results_h.quad)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 3.2, fig.height = 3.5, fig.cap = "Figure: Age trajectories of health risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. The lines represent the age trajectory of quadratic model results."}
#model data
model_data <- plot_model_data_list$plot_h.quad
#mean data
mean_data <- raw_mean_data_list$plot_h.quad %>%
  filter(Health_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Health_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x + I(x^2), size = 0.5) +
   labs(x= "Age", y= "Health risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~Panel, nrow = 5)
```

<div style="margin-bottom:40px;">
</div>


#### Quadratic with gender model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_h.quad.gender <- results_table_list$results_h.quad.gender
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "I(d_c_age^2)_Std.Error2","gender_Std.Error2")
results_h.quad.gender <- results_h.quad.gender[!(row.names(results_h.quad.gender) %in% remove),]
rownames(results_h.quad.gender)[rownames(results_h.quad.gender)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_h.quad.gender)[rownames(results_h.quad.gender)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_h.quad.gender)[rownames(results_h.quad.gender)=="I(d_c_age^2)_Std.Error1"] <- "I(d_c_age^2)_Std.Error"
rownames(results_h.quad.gender)[rownames(results_h.quad.gender)=="gender_Std.Error1"] <- "gender_Std.Error1"
results_h.quad.gender <- results_h.quad.gender[, colSums(is.na(results_h.quad.gender)) != nrow(results_h.quad.gender), drop = FALSE]
results_h.quad.gender <- results_h.quad.gender[complete.cases(results_h.quad.gender), 1, drop = FALSE ]

results_h.quad.gender[c(1:12,17:21,24), ] <- purrr::modify_if(results_h.quad.gender[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_h.quad.gender[c(22:23), ] <- purrr::modify_if(results_h.quad.gender[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_h.quad.gender[13,] <- p_judge(results_h.quad.gender[13,])
results_h.quad.gender[14,] <- p_judge(results_h.quad.gender[14,])
results_h.quad.gender[15,] <- p_judge(results_h.quad.gender[15,])
results_h.quad.gender[16,] <- p_judge(results_h.quad.gender[16,])


results_h.quad.gender <- results_h.quad.gender[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "I(d_c_age^2)_Estimate", "I(d_c_age^2)_Std.Error", "I(d_c_age^2)_t.value", "I(d_c_age^2)_p.value", "gender_Estimate", "gender_Std.Error", "gender_t.value", "gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"), 1, drop = FALSE]

datatable(results_h.quad.gender, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_h.quad.gender))), pageLength = nrow(results_h.quad.gender)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 3.2, fig.height = 3.5,, fig.cap = "Figure: Age trajectories of health risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of quadratic with gender model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_h.quad.gender
#mean data
mean_data <- raw_mean_data_list$plot_h.quad.gender %>%
  filter(Health_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Health_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x + I(x^2), size = 0.5) +
   labs(x= "Age", y= "Health risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 5)
```

<div style="margin-bottom:40px;">
</div>


### 4.7. Social risk-taking{.tabset}

#### Intercept only model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_s.int <- results_table_list$results_s.int
remove <- c("Intercept_Std.Error2")
results_s.int <- results_s.int[!(row.names(results_s.int) %in% remove),]
rownames(results_s.int)[rownames(results_s.int)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
results_s.int <- results_s.int[, colSums(is.na(results_s.int)) != nrow(results_s.int), drop = FALSE]
results_s.int <- results_s.int[complete.cases(results_s.int), 1, drop = FALSE]
results_s.int[c(1:3,5:8,11), ] <- purrr::modify_if(results_s.int[c(1:3,5:8,11), ], ~is.numeric(.), ~round(., 2))
results_s.int[c(9:10),] <- purrr::modify_if(results_s.int[c(9:10), ], ~is.numeric(.), ~round(., 0))
results_s.int[4,] <- p_judge(results_s.int[4,])

datatable(results_s.int, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_s.int))), pageLength = nrow(results_s.int)))
```

<div style="margin-bottom:40px;">
</div>


#### Fixed effect model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_s.fixed <- results_table_list$results_s.fixed
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_s.fixed <- results_s.fixed[!(row.names(results_s.fixed) %in% remove),]
rownames(results_s.fixed)[rownames(results_s.fixed)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_s.fixed)[rownames(results_s.fixed)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_s.fixed <- results_s.fixed[, colSums(is.na(results_s.fixed)) != nrow(results_s.fixed), drop = FALSE]
results_s.fixed <- results_s.fixed[complete.cases(results_s.fixed), 1, drop = FALSE]

results_s.fixed[c(1:6,9:10,13), ] <- purrr::modify_if(results_s.fixed[c(1:6,9:10,13), ], ~is.numeric(.), ~round(., 2))
results_s.fixed[c(11:12), ] <- purrr::modify_if(results_s.fixed[c(11:12), ], ~is.numeric(.), ~round(., 0))

results_s.fixed[7,] <- p_judge(results_s.fixed[7,])
results_s.fixed[8,] <- p_judge(results_s.fixed[8,])

results_s.fixed <- results_s.fixed[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "N.group", "N.obs", "LL"), 1, drop = FALSE]

datatable(results_s.fixed, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_s.fixed))), pageLength = nrow(results_s.fixed)))
```

<div style="margin-bottom:40px;">
</div>


#### Linear model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_s.lg <- results_table_list$results_s.lg
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_s.lg <- results_s.lg[!(row.names(results_s.lg) %in% remove),]
rownames(results_s.lg)[rownames(results_s.lg)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_s.lg)[rownames(results_s.lg)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_s.lg <- results_s.lg[, colSums(is.na(results_s.lg)) != nrow(results_s.lg), drop = FALSE]
results_s.lg <- results_s.lg[complete.cases(results_s.lg), 1, drop = FALSE ]

results_s.lg[c(1:6,9:13,16), ] <- purrr::modify_if(results_s.lg[c(1:6,9:13,16), ], ~is.numeric(.), ~round(., 2))
results_s.lg[c(14:15), ] <- purrr::modify_if(results_s.lg[c(14:15), ], ~is.numeric(.), ~round(., 0))

results_s.lg[7,] <- p_judge(results_s.lg[7,])
results_s.lg[8,] <- p_judge(results_s.lg[8,])

results_s.lg <- results_s.lg[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"), 1, drop = FALSE]

datatable(results_s.lg, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_s.lg))), pageLength = nrow(results_s.lg)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 3.2, fig.height = 3.5, fig.cap = "Figure: Age trajectories of social risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. The lines represent the age trajectory of linear model results."}
#model data
model_data <- plot_model_data_list$plot_s.lg
#mean data
mean_data <- raw_mean_data_list$plot_s.lg %>%
  filter(Social_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Social_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "Social risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_s.lg.gender <- results_table_list$results_s.lg.gender
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "gender_Std.Error2")
results_s.lg.gender <- results_s.lg.gender[!(row.names(results_s.lg.gender) %in% remove),]
rownames(results_s.lg.gender)[rownames(results_s.lg.gender)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_s.lg.gender)[rownames(results_s.lg.gender)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_s.lg.gender)[rownames(results_s.lg.gender)=="gender_Std.Error1"] <- "gender_Std.Error"
results_s.lg.gender <- results_s.lg.gender[, colSums(is.na(results_s.lg.gender)) != nrow(results_s.lg.gender), drop = FALSE]
results_s.lg.gender <- results_s.lg.gender[complete.cases(results_s.lg.gender), 1, drop = FALSE ]

results_s.lg.gender[c(1:9,13:17,20), ] <- purrr::modify_if(results_s.lg.gender[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_s.lg.gender[c(18:19), ] <- purrr::modify_if(results_s.lg.gender[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_s.lg.gender[10,] <- p_judge(results_s.lg.gender[10,])
results_s.lg.gender[11,] <- p_judge(results_s.lg.gender[11,])
results_s.lg.gender[12,] <- p_judge(results_s.lg.gender[12,])

results_s.lg.gender <- results_s.lg.gender[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "gender_Estimate","gender_Std.Error", "gender_t.value", "gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"), 1, drop = FALSE]

datatable(results_s.lg.gender, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_s.lg.gender))), pageLength = nrow(results_s.lg.gender)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 3.2, fig.height = 3.5, fig.cap = "Figure: Age trajectories of social risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of linear with gender model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_s.lg.gender
#mean data
mean_data <- raw_mean_data_list$plot_s.lg.gender %>%
  filter(Social_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Social_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "Social risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender interaction model
<br>
**Models results:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE}
results_s.lg.inter <- results_table_list$results_s.lg.inter
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "gender_Std.Error2", "d_c_age:gender_Std.Error2")
results_s.lg.inter <- results_s.lg.inter[!(row.names(results_s.lg.inter) %in% remove),]
rownames(results_s.lg.inter)[rownames(results_s.lg.inter)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_s.lg.inter)[rownames(results_s.lg.inter)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_s.lg.inter)[rownames(results_s.lg.inter)=="gender_Std.Error1"] <- "gender_Std.Error"
rownames(results_s.lg.inter)[rownames(results_s.lg.inter)=="d_c_age:gender_Std.Error1"] <- "d_c_age:gender_Std.Error"
results_s.lg.inter <- results_s.lg.inter[, colSums(is.na(results_s.lg.inter)) != nrow(results_s.lg.inter), drop = FALSE]
results_s.lg.inter <- results_s.lg.inter[complete.cases(results_s.lg.inter), 1, drop = FALSE]

results_s.lg.inter[c(1:12,17:21,24), ] <- purrr::modify_if(results_s.lg.inter[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_s.lg.inter[c(22:23), ] <- purrr::modify_if(results_s.lg.inter[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_s.lg.inter[13,] <- p_judge(results_s.lg.inter[13,])
results_s.lg.inter[14,] <- p_judge(results_s.lg.inter[14,])
results_s.lg.inter[15,] <- p_judge(results_s.lg.inter[15,])
results_s.lg.inter[16,] <- p_judge(results_s.lg.inter[16,])

results_s.lg.inter <- results_s.lg.inter[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "gender_Estimate", "gender_Std.Error", "gender_t.value", "gender_p.value", "d_c_age:gender_Estimate", "d_c_age:gender_Std.Error", "d_c_age:gender_t.value", "d_c_age:gender_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"), 1, drop = FALSE]

datatable(results_s.lg.inter, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_s.lg.inter))), pageLength = nrow(results_s.lg.inter)))
```

<div style="margin-bottom:20px;">
</div>


**Plot age trajectory:**
<br>
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 3.2, fig.height = 3.5, fig.cap = "Figure: Age trajectories of social risk-taking propensity for each sample. The points represent moving average (window size = 5, window step = 2) of raw data. Circle = female, triangle = male. The lines represent the age trajectory of linear with gender interaction model results. Solid line = female, dotted line = male."}
#model data
model_data <- plot_model_data_list$plot_s.lg.inter
#mean data
mean_data <- raw_mean_data_list$plot_s.lg.inter %>%
  filter(Social_z_n >= 50)

# Panel level
model_data$Panel <- factor(model_data$Panel, levels = panels)
mean_data$Panel <- factor(mean_data$Panel, levels = panels)

model_data[,"gender"] <- ifelse(model_data$gender == 1, "female", "male")
mean_data[,"gender"] <- ifelse(mean_data$gender == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Social_z_mean, group=gender, colour=Panel, pch=gender), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=gender, colour=Panel, linetype = gender), method = "lm", formula = y ~ x, size = 0.5) +
   labs(x= "Age", y= "Social risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 1)
```


<div style="margin-bottom:40px;">
</div>

#### Quadratic model

+ **Note:** Because no panel includes social risk-taking in more than 3 waves, no results are shown here.

<div style="margin-bottom:40px;">
</div>



#### Quadratic with gender model

+ **Note:** Because no panel includes social risk-taking in more than 3 waves, no results are shown here.

<div style="margin-bottom:40px;">
</div>



## 5. Meta-analysis results

### 5.1. General risk-taking{.tabset}

#### Intercept only model
<br>
**Meta analysis:**
<br>
*ICC's results*
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("../data/results_data")

meta_results_list <- readRDS(file = "meta_results_list_no_mods.Rds")
meta_g.int <- meta_results_list$meta_g.int
meta_g.int_icc <- meta_g.int$icc
summary(meta_g.int_icc)
```

<div style="margin-bottom:40px;">
</div>


**Meta analysis with three moderators (continent, mean age, scale range):**
<br>
*ICC's results*
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("../data/results_data")

meta_results_list_all <- readRDS(file = "meta_results_list_all.Rds")
meta_g.int_all <- meta_results_list_all$meta_g.int
meta_g.int_all_icc <- meta_g.int_all$icc
summary(meta_g.int_all_icc)
```

<div style="margin-bottom:20px;">
</div>

+ **Note:** Scale range was not included as a moderator in the meta-analysis results because all samples used the same measure scale of general risk-taking propensity

<div style="margin-bottom:40px;">
</div>



#### Fixed effect model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.fixed <- meta_results_list$meta_g.fixed
meta_g.fixed_age <- meta_g.fixed$age
summary(meta_g.fixed_age)
```

<div style="margin-bottom:40px;">
</div>


**Meta analysis with three moderators (continent, mean age, scale range):**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.fixed_all <- meta_results_list_all$meta_g.fixed
meta_g.fixed_all_age <- meta_g.fixed_all$age
summary(meta_g.fixed_all_age)
```

<div style="margin-bottom:20px;">
</div>

+ **Note:** Scale range was not included as a moderator in the meta-analysis results because all samples used the same measure scale of general risk-taking propensity

<div style="margin-bottom:40px;">
</div>



#### Linear model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg <- meta_results_list$meta_g.lg
meta_g.lg_age <- meta_g.lg$age
summary(meta_g.lg_age)
```

<div style="margin-bottom:40px;">
</div>


**Meta analysis with three moderators (continent, mean age, scale range):**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg_all <- meta_results_list_all$meta_g.lg
meta_g.lg_all_age <- meta_g.lg_all$age
summary(meta_g.lg_all_age)
```

<div style="margin-bottom:20px;">
</div>

+ **Note:** Scale range was not included as a moderator in the meta-analysis results because all samples used the same measure scale of general risk-taking propensity

<div style="margin-bottom:40px;">
</div>



#### Linear with gender model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.gender <- meta_results_list$meta_g.lg.gender
meta_g.lg.gender_age <- meta_g.lg.gender$age
summary(meta_g.lg.gender_age)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.gender <- meta_results_list$meta_g.lg.gender
meta_g.lg.gender_gender <- meta_g.lg.gender$gender
summary(meta_g.lg.gender_gender)
```

<div style="margin-bottom:40px;">
</div>


**Meta analysis with three moderators (continent, mean age, scale range):**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.gender_all <- meta_results_list_all$meta_g.lg.gender
meta_g.lg.gender_all_age <- meta_g.lg.gender_all$age
summary(meta_g.lg.gender_all_age)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.gender_all <- meta_results_list_all$meta_g.lg.gender
meta_g.lg.gender_all_gender <- meta_g.lg.gender_all$gender
summary(meta_g.lg.gender_all_gender)
```

<div style="margin-bottom:20px;">
</div>

+ **Note:** Scale range was not included as a moderator in the meta-analysis results because all samples used the same measure scale of general risk-taking propensity

<div style="margin-bottom:40px;">
</div>


#### Linear with gender interaction model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.inter <- meta_results_list$meta_g.lg.inter
meta_g.lg.inter_age <- meta_g.lg.inter$age
summary(meta_g.lg.inter_age)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.inter <- meta_results_list$meta_g.lg.inter
meta_g.lg.inter_gender <- meta_g.lg.inter$gender
summary(meta_g.lg.inter_gender)
```

<div style="margin-bottom:20px;">
</div>

*Age $\times$ Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.inter <- meta_results_list$meta_g.lg.inter
meta_g.lg.inter_age_gender <- meta_g.lg.inter$age_gender
summary(meta_g.lg.inter_age_gender)
```

<div style="margin-bottom:40px;">
</div>


**Meta analysis with three moderators (continent, mean age, scale range):**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.inter_all <- meta_results_list_all$meta_g.lg.inter
meta_g.lg.inter_all_age <- meta_g.lg.inter_all$age
summary(meta_g.lg.inter_all_age)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.inter_all <- meta_results_list_all$meta_g.lg.inter
meta_g.lg.inter_all_gender <- meta_g.lg.inter_all$gender
summary(meta_g.lg.inter_all_gender)
```

<div style="margin-bottom:20px;">
</div>

*Age $\times$ Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.inter_all <- meta_results_list_all$meta_g.lg.inter
meta_g.lg.inter_all_age_gender <- meta_g.lg.inter_all$age_gender
summary(meta_g.lg.inter_all_age_gender)
```

<div style="margin-bottom:20px;">
</div>

+ **Note:** Scale range was not included as a moderator in the meta-analysis results because all samples used the same measure scale of general risk-taking propensity

<div style="margin-bottom:40px;">
</div>


#### Quadratic model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad <- meta_results_list$meta_g.quad
meta_g.quad_age <- meta_g.quad$age
summary(meta_g.quad_age)
```

<div style="margin-bottom:20px;">
</div>

*Age${ }^{2}$ effect*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad <- meta_results_list$meta_g.quad
meta_g.quad_age2 <- meta_g.quad$age2
summary(meta_g.quad_age2)
```

<div style="margin-bottom:40px;">
</div>



#### Quadratic with gender model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad.gender <- meta_results_list$meta_g.quad.gender
meta_g.quad.gender_age <- meta_g.quad.gender$age
summary(meta_g.quad.gender_age)
```

<div style="margin-bottom:20px;">
</div>

*Age${ }^{2}$ effect*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad.gender <- meta_results_list$meta_g.quad.gender
meta_g.quad.gender_age2 <- meta_g.quad.gender$age2
summary(meta_g.quad.gender_age2)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad.gender <- meta_results_list$meta_g.quad.gender
meta_g.quad.gender_gender <- meta_g.quad.gender$gender
summary(meta_g.quad.gender_gender)
```

<div style="margin-bottom:40px;">
</div>



### 5.2. Financial risk-taking{.tabset}

#### Intercept only model
<br>
**Meta analysis:**
<br>
*ICC's results*
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("../data/results_data")

meta_results_list <- readRDS(file = "meta_results_list_no_mods.Rds")
meta_f.int <- meta_results_list$meta_f.int
meta_f.int_icc <- meta_f.int$icc
summary(meta_f.int_icc)
```

<div style="margin-bottom:40px;">
</div>


**Meta analysis with three moderators (continent, mean age, scale range):**
<br>
*ICC's results*
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("../data/results_data")

meta_results_list_all <- readRDS(file = "meta_results_list_all.Rds")
meta_f.int_all <- meta_results_list_all$meta_f.int
meta_f.int_all_icc <- meta_f.int_all$icc
summary(meta_f.int_all_icc)
```

<div style="margin-bottom:40px;">
</div>



#### Fixed effect model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.fixed <- meta_results_list$meta_f.fixed
meta_f.fixed_age <- meta_f.fixed$age
summary(meta_f.fixed_age)
```

<div style="margin-bottom:40px;">
</div>


**Meta analysis with three moderators (continent, mean age, scale range):**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.fixed_all <- meta_results_list_all$meta_f.fixed
meta_f.fixed_all_age <- meta_f.fixed_all$age
summary(meta_f.fixed_all_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg <- meta_results_list$meta_f.lg
meta_f.lg_age <- meta_f.lg$age
summary(meta_f.lg_age)
```

<div style="margin-bottom:40px;">
</div>


**Meta analysis with three moderators (continent, mean age, scale range):**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg_all <- meta_results_list_all$meta_f.lg
meta_f.lg_all_age <- meta_f.lg_all$age
summary(meta_f.lg_all_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.gender <- meta_results_list$meta_f.lg.gender
meta_f.lg.gender_age <- meta_f.lg.gender$age
summary(meta_f.lg.gender_age)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.gender <- meta_results_list$meta_f.lg.gender
meta_f.lg.gender_gender <- meta_f.lg.gender$gender
summary(meta_f.lg.gender_gender)
```

<div style="margin-bottom:40px;">
</div>



**Meta analysis with three moderators (continent, mean age, scale range):**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.gender_all <- meta_results_list_all$meta_f.lg.gender
meta_f.lg.gender_all_age <- meta_f.lg.gender_all$age
summary(meta_f.lg.gender_all_age)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.gender_all <- meta_results_list_all$meta_f.lg.gender
meta_f.lg.gender_all_gender <- meta_f.lg.gender_all$gender
summary(meta_f.lg.gender_all_gender)
```

<div style="margin-bottom:40px;">
</div>




#### Linear with gender interaction model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.inter <- meta_results_list$meta_f.lg.inter
meta_f.lg.inter_age <- meta_f.lg.inter$age
summary(meta_f.lg.inter_age)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.inter <- meta_results_list$meta_f.lg.inter
meta_f.lg.inter_gender <- meta_f.lg.inter$gender
summary(meta_f.lg.inter_gender)
```

<div style="margin-bottom:20px;">
</div>

*Age $\times$ Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.inter <- meta_results_list$meta_f.lg.inter
meta_f.lg.inter_age_gender <- meta_f.lg.inter$age_gender
summary(meta_f.lg.inter_age_gender)
```

<div style="margin-bottom:40px;">
</div>


**Meta analysis with three moderators (continent, mean age, scale range):**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.inter_all <- meta_results_list_all$meta_f.lg.inter
meta_f.lg.inter_all_age <- meta_f.lg.inter_all$age
summary(meta_f.lg.inter_all_age)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.inter_all <- meta_results_list_all$meta_f.lg.inter
meta_f.lg.inter_all_gender <- meta_f.lg.inter_all$gender
summary(meta_f.lg.inter_all_gender)
```

<div style="margin-bottom:20px;">
</div>

*Age $\times$ Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.inter_all <- meta_results_list_all$meta_f.lg.inter
meta_f.lg.inter_all_age_gender <- meta_f.lg.inter_all$age_gender
meta_f.lg.inter_all_age_gender
```

<div style="margin-bottom:40px;">
</div>



#### Quadratic model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad <- meta_results_list$meta_f.quad
meta_f.quad_age <- meta_f.quad$age
summary(meta_f.quad_age)
```

<div style="margin-bottom:20px;">
</div>

*Age${ }^{2}$ effect*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad <- meta_results_list$meta_f.quad
meta_f.quad_age2 <- meta_f.quad$age2
summary(meta_f.quad_age2)
```

<div style="margin-bottom:40px;">
</div>


**Meta analysis with three moderators (continent, mean age, scale range):**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad_all <- meta_results_list_all$meta_f.quad
meta_f.quad_all_age <- meta_f.quad_all$age
summary(meta_f.quad_all_age)
```

<div style="margin-bottom:20px;">
</div>

*Age${ }^{2}$ effect*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad_all <- meta_results_list_all$meta_f.quad
meta_f.quad_all_age2 <- meta_f.quad_all$age2
summary(meta_f.quad_all_age2)
```

<div style="margin-bottom:40px;">
</div>



#### Quadratic with gender model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad.gender <- meta_results_list$meta_f.quad.gender
meta_f.quad.gender_age <- meta_f.quad.gender$age
summary(meta_f.quad.gender_age)
```

<div style="margin-bottom:20px;">
</div>

*Age${ }^{2}$ effect*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad.gender <- meta_results_list$meta_f.quad.gender
meta_f.quad.gender_age2 <- meta_f.quad.gender$age2
summary(meta_f.quad.gender_age2)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad.gender <- meta_results_list$meta_f.quad.gender
meta_f.quad.gender_gender <- meta_f.quad.gender$gender
summary(meta_f.quad.gender_gender)
```

<div style="margin-bottom:40px;">
</div>


**Meta analysis with three moderators (continent, mean age, scale range):**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad.gender_all <- meta_results_list_all$meta_f.quad.gender
meta_f.quad.gender_all_age <- meta_f.quad.gender_all$age
summary(meta_f.quad.gender_all_age)
```

<div style="margin-bottom:20px;">
</div>

*Age${ }^{2}$ effect*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad.gender_all <- meta_results_list_all$meta_f.quad.gender
meta_f.quad.gender_all_age2 <- meta_f.quad.gender_all$age2
summary(meta_f.quad.gender_all_age2)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad.gender_all <- meta_results_list_all$meta_f.quad.gender
meta_f.quad.gender_all_gender <- meta_f.quad.gender_all$gender
summary(meta_f.quad.gender_all_gender)
```

<div style="margin-bottom:40px;">
</div>


### 5.3. Driving risk-taking{.tabset}

#### Intercept only model
<br>
**Meta analysis:**
<br>
*ICC's results*
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("../data/results_data")

meta_results_list <- readRDS(file = "meta_results_list_no_mods.Rds")
meta_d.int <- meta_results_list$meta_d.int
meta_d.int_icc <- meta_d.int$icc
summary(meta_d.int_icc)
```

<div style="margin-bottom:40px;">
</div>



#### Fixed effect model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.fixed <- meta_results_list$meta_d.fixed
meta_d.fixed_age <- meta_d.fixed$age
summary(meta_d.fixed_age)
```

<div style="margin-bottom:40px;">
</div>


#### Linear model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg <- meta_results_list$meta_d.lg
meta_d.lg_age <- meta_d.lg$age
summary(meta_d.lg_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.gender <- meta_results_list$meta_d.lg.gender
meta_d.lg.gender_age <- meta_d.lg.gender$age
summary(meta_d.lg.gender_age)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.gender <- meta_results_list$meta_d.lg.gender
meta_d.lg.gender_gender <- meta_d.lg.gender$gender
summary(meta_d.lg.gender_gender)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender interaction model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.inter <- meta_results_list$meta_d.lg.inter
meta_d.lg.inter_age <- meta_d.lg.inter$age
summary(meta_d.lg.inter_age)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.inter <- meta_results_list$meta_d.lg.inter
meta_d.lg.inter_gender <- meta_d.lg.inter$gender
summary(meta_d.lg.inter_gender)
```

<div style="margin-bottom:20px;">
</div>

*Age $\times$ Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.inter <- meta_results_list$meta_d.lg.inter
meta_d.lg.inter_age_gender <- meta_d.lg.inter$age_gender
summary(meta_d.lg.inter_age_gender)
```

<div style="margin-bottom:40px;">
</div>


#### Quadratic model

+ **Note:** Because just one panel (SAVE) includes driving risk-taking in more than 3 waves, we did not undertake the meta-analysis and no results are shown here.

<div style="margin-bottom:40px;">
</div>



#### Quadratic with gender model

+ **Note:** Because just one panel (SAVE) includes driving risk-taking in more than 3 waves, we did not undertake the meta-analysis and no results are shown here.

<div style="margin-bottom:40px;">
</div>




### 5.4. Recreational risk-taking{.tabset}

#### Intercept only model
<br>
**Meta analysis:**
<br>
*ICC's results*
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("../data/results_data")

meta_results_list <- readRDS(file = "meta_results_list_no_mods.Rds")
meta_r.int <- meta_results_list$meta_r.int
meta_r.int_icc <- meta_r.int$icc
summary(meta_r.int_icc)
```

<div style="margin-bottom:40px;">
</div>



#### Fixed effect model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.fixed <- meta_results_list$meta_r.fixed
meta_r.fixed_age <- meta_r.fixed$age
summary(meta_r.fixed_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg <- meta_results_list$meta_r.lg
meta_r.lg_age <- meta_r.lg$age
summary(meta_r.lg_age)
```



#### Linear with gender model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.gender <- meta_results_list$meta_r.lg.gender
meta_r.lg.gender_age <- meta_r.lg.gender$age
summary(meta_r.lg.gender_age)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.gender <- meta_results_list$meta_r.lg.gender
meta_r.lg.gender_gender <- meta_r.lg.gender$gender
summary(meta_r.lg.gender_gender)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender interaction model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.inter <- meta_results_list$meta_r.lg.inter
meta_r.lg.inter_age <- meta_r.lg.inter$age
summary(meta_r.lg.inter_age)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.inter <- meta_results_list$meta_r.lg.inter
meta_r.lg.inter_gender <- meta_r.lg.inter$gender
summary(meta_r.lg.inter_gender)
```

<div style="margin-bottom:20px;">
</div>

*Age $\times$ Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.inter <- meta_results_list$meta_r.lg.inter
meta_r.lg.inter_age_gender <- meta_r.lg.inter$age_gender
summary(meta_r.lg.inter_age_gender)
```

<div style="margin-bottom:40px;">
</div>



#### Quadratic model

+ **Note:** Because just one panel (SAVE) includes recreational risk-taking in more than 3 waves, we did not undertake the meta-analysis and no results are shown here.

<div style="margin-bottom:40px;">
</div>



#### Quadratic with gender model

+ **Note:** Because just one panel (SAVE) includes recreational risk-taking in more than 3 waves, we did not undertake the meta-analysis and no results are shown here.

<div style="margin-bottom:40px;">
</div>



### 5.5. Occupational risk-taking{.tabset}

#### Intercept only model
<br>
**Meta analysis:**
<br>
*ICC's results*
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("../data/results_data")

meta_results_list <- readRDS(file = "meta_results_list_no_mods.Rds")
meta_o.int <- meta_results_list$meta_o.int
meta_o.int_icc <- meta_o.int$icc
summary(meta_o.int_icc)
```

<div style="margin-bottom:40px;">
</div>



#### Fixed effect model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.fixed <- meta_results_list$meta_o.fixed
meta_o.fixed_age <- meta_o.fixed$age
summary(meta_o.fixed_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg <- meta_results_list$meta_o.lg
meta_o.lg_age <- meta_o.lg$age
summary(meta_o.lg_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.gender <- meta_results_list$meta_o.lg.gender
meta_o.lg.gender_age <- meta_o.lg.gender$age
summary(meta_o.lg.gender_age)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.gender <- meta_results_list$meta_o.lg.gender
meta_o.lg.gender_gender <- meta_o.lg.gender$gender
summary(meta_o.lg.gender_gender)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender interaction model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.inter <- meta_results_list$meta_o.lg.inter
meta_o.lg.inter_age <- meta_o.lg.inter$age
summary(meta_o.lg.inter_age)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.inter <- meta_results_list$meta_o.lg.inter
meta_o.lg.inter_gender <- meta_o.lg.inter$gender
summary(meta_o.lg.inter_gender)
```

<div style="margin-bottom:20px;">
</div>

*Age $\times$ Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.inter <- meta_results_list$meta_o.lg.inter
meta_o.lg.inter_age_gender <- meta_o.lg.inter$age_gender
summary(meta_o.lg.inter_age_gender)
```

<div style="margin-bottom:40px;">
</div>



#### Quadratic model

+ **Note:** Because just one panel (SAVE) includes occupational risk-taking in more than 3 waves, we did not undertake the meta-analysis and no results are shown here.

<div style="margin-bottom:40px;">
</div>



#### Quadratic with gender model

+ **Note:** Because just one panel (SAVE) includes occupational risk-taking in more than 3 waves, we did not undertake the meta-analysis and no results are shown here.

<div style="margin-bottom:40px;">
</div>



### 5.6. Health risk-taking{.tabset}

#### Intercept only model
<br>
**Meta analysis:**
<br>
*ICC's results*
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("../data/results_data")

meta_results_list <- readRDS(file = "meta_results_list_no_mods.Rds")
meta_h.int <- meta_results_list$meta_h.int
meta_h.int_icc <- meta_h.int$icc
summary(meta_h.int_icc)
```

<div style="margin-bottom:40px;">
</div>



#### Fixed effect model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.fixed <- meta_results_list$meta_h.fixed
meta_h.fixed_age <- meta_h.fixed$age
summary(meta_h.fixed_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg <- meta_results_list$meta_h.lg
meta_h.lg_age <- meta_h.lg$age
summary(meta_h.lg_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.gender <- meta_results_list$meta_h.lg.gender
meta_h.lg.gender_age <- meta_h.lg.gender$age
summary(meta_h.lg.gender_age)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.gender <- meta_results_list$meta_h.lg.gender
meta_h.lg.gender_gender <- meta_h.lg.gender$gender
summary(meta_h.lg.gender_gender)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender interaction model
<br>
**Meta analysis:**
<br>
*Age effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.inter <- meta_results_list$meta_h.lg.inter
meta_h.lg.inter_age <- meta_h.lg.inter$age
summary(meta_h.lg.inter_age)
```

<div style="margin-bottom:20px;">
</div>

*Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.inter <- meta_results_list$meta_h.lg.inter
meta_h.lg.inter_gender <- meta_h.lg.inter$gender
summary(meta_h.lg.inter_gender)
```

<div style="margin-bottom:20px;">
</div>

*Age $\times$ Gender effect results*
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.inter <- meta_results_list$meta_h.lg.inter
meta_h.lg.inter_age_gender <- meta_h.lg.inter$age_gender
summary(meta_h.lg.inter_age_gender)
```

<div style="margin-bottom:40px;">
</div>



#### Quadratic model

+ **Note:** Because just one panel (SAVE) includes health risk-taking in more than 3 waves, we did not undertake the meta-analysis and no results are shown here.

<div style="margin-bottom:40px;">
</div>



#### Quadratic with gender model

+ **Note:** Because just one panel (SAVE) includes health risk-taking in more than 3 waves, we did not undertake the meta-analysis and no results are shown here.

<div style="margin-bottom:40px;">
</div>



### 5.7. Social risk-taking

  + **Note:** Because just one panel (SOEP) includes social risk-taking items, we did not undertake the meta-analysis and no results are shown here.



<div style="margin-bottom:40px;">
</div>
 

## 6. Models comparison
### 6.1. Samples including 3 or more waves
```{r, echo = F, warning = FALSE, message = FALSE}
Total.Number <- c(7, 20, 3, 3, 3, 3, 1)
Lg <- c(1, 0, 0, 0, 0, 0, 0)
Lg.gender <- c(5, 17, 2, 1, 3, 1, 1)
Lg.int <- c(1, 3, 1, 2, 0, 2, 0)

Table2 <- data.frame(Total.Number, Lg, Lg.gender,  Lg.int)
rownames(Table2) <- c("General","Financial", "Driving", "Recreational", "Occupational", "Health", "Social")

sketch = htmltools::withTags(table(
  class = 'display',
  thead(
    tr(
      th(rowspan = 2, ''),
      th(rowspan = 2, 'Total number'),
      th(colspan = 3, 'Best fit sample number'),
    ),
    tr(
      lapply(c("Linear", "Linear with gender", "Linear with gender interaction"), th)
    )
  )
))

datatable(Table2 , container = sketch, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(Table2))), pageLength = nrow(Table2)))
```

### 6.2. Samples including 4 or more waves
```{r, echo = F, warning = FALSE, message = FALSE}
Total.Number <- c(4, 15, 1,  1, 1, 1, 0)
Lg <- c(0, 0, 0, 0, 0, 0, 0)
Lg.gender <- c(2, 10, 0, 0, 0, 0, 0)
Lg.int <- c(0, 2, 1, 0, 0, 1, 0)
Quad <- c(0, 0, 0, 0, 0 ,0 ,0)
Quad.gender <- c(2, 3, 0, 1, 1, 0, 0)

Table3 <- data.frame(Total.Number, Lg, Lg.gender,  Lg.int,  Quad, Quad.gender)
rownames(Table3) <- c("General", "Driving", "Financial", "Recreational", "Occupational", "Health", "Social")

sketch = htmltools::withTags(table(
  class = 'display',
  thead(
    tr(
      th(rowspan = 2, ''),
      th(rowspan = 2, 'Total number'),
      th(colspan = 5, 'Best fit sample number'),
    ),
    tr(
      lapply(c("Linear", "Linear with gender", "Linear with gender interaction", "Quadratic", "Quadratic with gender"), th)
    )
  )
))

datatable(Table3, container = sketch,  options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(Table3))), pageLength = nrow(Table3)))
```

<div style="margin-bottom:40px;">
</div>

 

## 7. Meta-analytic summary of slope estimates {.tabset}

### Intercept-only model
<br>
**ICC effect:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 5, fig.height = 3}
domains <- c("General", "Driving", "Financial", "Recreational", "Occupational", "Health", "Social")
colordata <- data.frame(matrix(data=NA, nrow=length(domains), ncol = 1)) 
colordata <- as.data.frame(matrix(domains))
colnames(colordata) <- "domains_name"
colordata$domains_name<- as.factor(colordata$domains_name) 

setwd("../data/results_data")

combine_meta_summary_list <- readRDS(file = "combine_meta_summary_list.Rds")

plot_data <- combine_meta_summary_list$meta_int$icc
plot_data$Domain = factor(plot_data$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

ggplot(data=plot_data, aes(x = Domain, y = b)) + 
      geom_point(aes(group=Domain, colour=Domain), size  = 3) +
      scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
      geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
      labs(x="Domain", y= " ICC coefficient") + 
      #labs(x="Domain", y= "Coefficient", title="ICC") + 
      coord_flip(ylim = c(0,0.6)) +
      theme_minimal() +
      theme(legend.position = "none") +
      #theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
      theme(panel.border = element_rect(colour = "black", fill=NA))
```

<div style="margin-bottom:40px;">
</div>



### Fixed effect model
<br>
**Age effect:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 5, fig.height = 3}
plot_data <- combine_meta_summary_list$meta_fixed$age
plot_data$Domain = factor(plot_data$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

ggplot(data=plot_data, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Age coefficient") +
  #labs(x="Domain", y= "Coefficient", title="Age") +
  coord_flip(ylim = c(-0.25,0.05)) +
  theme_minimal() +
  theme(legend.position = "none") +
  #theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))

```

<div style="margin-bottom:40px;">
</div>



### Linear model
<br>
**Age effect:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 5, fig.height = 3}
plot_data <- combine_meta_summary_list$meta_lg$age
plot_data$Domain = factor(plot_data$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

ggplot(data=plot_data, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Age coefficient") +
  #labs(x="Domain", y= "Coefficient", title="Age") +
  coord_flip(ylim = c(-0.25,0.05)) +
  theme_minimal() +
  theme(legend.position = "none") +
  #theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))
```

<div style="margin-bottom:40px;">
</div>



### Linear with gender model
<br>
**Age effect:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 5, fig.height = 3}
plot_data1 <- combine_meta_summary_list$meta_lg.gender$age
plot_data1$Domain = factor(plot_data1$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

ggplot(data=plot_data1, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Age coefficient") +
  #labs(x="Domain", y= "Coefficient", title="Age") +
  coord_flip(ylim = c(-0.25,0.05)) +
  theme_minimal() +
  theme(legend.position = "none") +
  #theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))
```

<div style="margin-bottom:20px;">
</div>

**Gender effect:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 5, fig.height = 3}
plot_data2 <- combine_meta_summary_list$meta_lg.gender$gender
plot_data2$Domain = factor(plot_data2$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

ggplot(data=plot_data2, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Gender coefficient") +
  #labs(x="Domain", y= "Coefficient", title="Gender") +
  coord_flip(ylim = c(-0.5,0.05)) +
  theme_minimal() +
  theme(legend.position = "none") +
  #theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))
```


<div style="margin-bottom:40px;">
</div>



### Linear with gender interaction model
<br>
**Age effect:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 5, fig.height = 3}
plot_data1 <- combine_meta_summary_list$meta_lg.inter$age
plot_data1$Domain = factor(plot_data1$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

ggplot(data=plot_data1, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Age coefficient") +
  #labs(x="Domain", y= "Coefficient", title="Age") +
  coord_flip(ylim = c(-0.25,0.05)) +
  theme_minimal() +
  theme(legend.position = "none") +
  #theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))
```

<div style="margin-bottom:20px;">
</div>

**Gender effect:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 5, fig.height = 3}
plot_data2 <- combine_meta_summary_list$meta_lg.inter$gender
plot_data2$Domain = factor(plot_data2$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))
      
ggplot(data=plot_data2, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Gender coefficient") +
  #labs(x="Domain", y= "Coefficient", title="Gender") +
  coord_flip(ylim = c(-0.5,0.05)) +
  theme_minimal() +
  theme(legend.position = "none") +
  #theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))
```

<div style="margin-bottom:20px;">
</div>

**Age $\times$ Gender effect:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 5, fig.height = 3}
plot_data3 <- combine_meta_summary_list$meta_lg.inter$age_gender
plot_data3$Domain = factor(plot_data3$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General")) 

ggplot(data=plot_data3, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= TeX("Age $\\times$ Gender coefficient")) +
  #labs(x="Domain", y= "Coefficient", title=TeX("Age $\\times$ Gender")) +
  coord_flip(ylim = c(-0.1, 0.1)) +
  theme_minimal() +
  theme(legend.position = "none") +
  #theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))
```

<div style="margin-bottom:40px;">
</div>


### Quadratic model
<br>
**Age effect:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 5, fig.height = 3}
plot_data1 <- combine_meta_summary_list$meta_quad$age
plot_data1$Domain = factor(plot_data1$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

ggplot(data=plot_data1, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= TeX("Age coefficient")) +
  #labs(x="Domain", y= "Coefficient", title=TeX('$\\mathrm{Age}^{\\,}$')) +
  coord_flip(ylim = c(-0.2, 0.05)) +
  theme_minimal() +
  theme(legend.position = "none") +
  #theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))
```

<div style="margin-bottom:20px;">
</div>

**Age${ }^{2}$ effect:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 5, fig.height = 3}
plot_data2 <- combine_meta_summary_list$meta_quad$age2
plot_data2$Domain = factor(plot_data2$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

ggplot(data=plot_data2, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= TeX("$\\mathrm{Age} ^{2}$ coefficient")) +
  #labs(x="Domain", y= "Coefficient", title=TeX('$\\mathrm{Age} ^{2}$')) +
  coord_flip(ylim = c(-0.02, 0.02)) +
  theme_minimal() +
  theme(legend.position = "none") +
  #theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA)) 
```

<div style="margin-bottom:20px;">
</div>


### Quadratic with gender model
<br>
**Age effect:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 5, fig.height = 3}
plot_data1 <- combine_meta_summary_list$meta_quad.gender$age
plot_data1$Domain = factor(plot_data1$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

ggplot(data=plot_data1, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Age coefficient") +
 #labs(x="Domain", y= "Coefficient", title=expression("Age")) +
  coord_flip(ylim = c(-0.2, 0.05)) +
  theme_minimal() +
  theme(legend.position = "none") +
  #theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))
```

<div style="margin-bottom:20px;">
</div>

**Age${ }^{2}$ effect:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 5, fig.height = 3}
plot_data2 <- combine_meta_summary_list$meta_quad.gender$age2
plot_data1$Domain = factor(plot_data2$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))
  
ggplot(data=plot_data2, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) + 
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= TeX("$\\mathrm{Age} ^{2}$ coefficient")) +
  #labs(x="Domain", y= "Coefficient", title=expression("Age"^2)) +
  coord_flip(ylim = c(-0.02, 0.02)) +
  theme_minimal() +
  theme(legend.position = "none") +
  #theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))
```

<div style="margin-bottom:20px;">
</div>

**Gender effect:**
<br>
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 5, fig.height = 3}
plot_data3 <- combine_meta_summary_list$meta_quad.gender$gender
plot_data3$Domain = factor(plot_data3$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

ggplot(data=plot_data3, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Gender coefficient") +
  #labs(x="Domain", y= "Coefficient", title=expression("Gender")) +
  coord_flip(ylim = c(-0.5, 0.05)) +
  theme_minimal() +
  theme(legend.position = "none") +
  #theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA)) +
  theme(legend.position = "none") 
```

<div style="margin-bottom:40px;">
</div>



 









