---
title: "Trajectories of Risk-taking Propensity (demo)"
author: "Yun-Rui Liu"
output: 
      html_document:
            toc: true
            toc_float: true
            theme: flatly 
            df_print: paged
---

```{r setup, include=FALSE}
library(tidyverse)
library(metafor)
library(ggplot2)
library(gridExtra)
library(grid)
library(latex2exp)
library(DT)
knitr::opts_chunk$set(echo = TRUE)
```

## 1. Overview of Project 

 *Insert Abstract*
 
 <div style="margin-bottom:40px;">
 </div>
 
 

## 2. Introduction of the file

The following document contains results from all analyses conducted for the manuscript titled “Trajectories of Risk-taking Propensity:  A Coordinated Analysis of Longitudinal Panels”. This document is organized by different domain risk-taking propensity,including general, driving, financial, recreational, occupational, health and social domain. For each risk-taking propensity, we create 7 models (including intercept-only model, fixed effect model, linear model, linear with gender model, linear with gender interaction model, quadratic model and quadratic with gender model) and provide a table summarizing individual study model
results, trajectory plots, the meta-analysis results. We tested individual predictors that are not included in the simple trajectory model in meta regression: country, continent, mean age and scale range. And the results from these models are available below. The code used to compile this file is available here (insert link)

<div style="margin-bottom:40px;">
</div>



## 3. Overview of panel data

### 3.1. The number of participants
```{r, echo = F, fig.width = 16, fig.height = 10}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/process_z_data")

panels = c("SOEP","HRS","SAVE","DNB","PHF",
           "SHARE_Austria", "SHARE_Germany", "SHARE_Sweden", "SHARE_Netherlands", "SHARE_Spain", "SHARE_Italy", "SHARE_France", "SHARE_Denmark", "SHARE_Switzerland","SHARE_Belgium", "SHARE_Israel", "SHARE_Czech_Republic", "SHARE_Slovenia", "SHARE_Estonia",
           "Usoc","GCOE_Japan","GCOE_USA", "HILDA", "LIKS")

# load data
for (i in 1:length(panels)) {
  data_name <- paste0(panels[i], "_process_z") 
  file_name <- paste0(panels[i], "_process_z.Rds") 
  data <- readRDS(file = file_name)
  data$panel <- panels[i]
  assign(data_name, value = data)
}

#merge data
All_data <- Reduce(function(x, y) merge(x, y, all=TRUE), list(SOEP_process_z, HRS_process_z, SAVE_process_z, DNB_process_z, PHF_process_z, SHARE_Austria_process_z, SHARE_Germany_process_z, SHARE_Sweden_process_z, SHARE_Netherlands_process_z, SHARE_Spain_process_z, SHARE_Italy_process_z, SHARE_France_process_z, SHARE_Denmark_process_z, SHARE_Switzerland_process_z, SHARE_Belgium_process_z, SHARE_Israel_process_z, SHARE_Czech_Republic_process_z, SHARE_Slovenia_process_z, SHARE_Estonia_process_z, Usoc_process_z, GCOE_Japan_process_z, GCOE_USA_process_z, HILDA_process_z, LIKS_process_z))

#plot
ggplot(data = All_data, aes(x = panel)) +
  geom_bar(width = 0.5) +
  geom_text(stat='count',aes(label=..count..), hjust=-0.2) +
  labs(x= "Panel", y= "Count, observations") +
  scale_y_continuous(breaks = c(0, 50000, 100000, 150000, 200000, 250000, 300000, 350000)) +
  theme_minimal() +
  coord_flip() +
  theme(plot.title = element_text(hjust = 0.5)) +
  theme(axis.text=element_text(size=14), axis.title.x = element_text(size = 22, face="bold"), axis.title.y = element_text(size = 22, face="bold"), plot.title = element_text(size=25, face="bold"))
```

<div style="margin-bottom:20px;">
</div>


### 3.2. Histogram of age distributions (all observations)
```{r, echo = F, fig.width = 14, fig.height = 6}
agebins = c(18, seq(25, 90, 5))
All_data$age_bins <- cut(All_data$age, breaks=agebins, right = TRUE, lable = TRUE)
ggplot(data = All_data, aes(x = age_bins, fill = panel)) +
  geom_bar(width = 0.5) +
  labs(x= "Age", y= "Count, observations")+
  scale_y_continuous(breaks = c(0, 50000, 100000, 150000, 200000, 250000, 300000, 350000)) +
  theme(axis.text=element_text(size=14), axis.title.x = element_text(size = 16, face="bold"), axis.title.y = element_text(size = 16, face="bold"))
```

<div style="margin-bottom:20px;">
</div>


### 3.3. Histograms and Density Plots for every panel{.tabset}

#### SOEP

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = SOEP_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="SOEP", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 5, fig.height = 3}
SOEP_process_z_General <- SOEP_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, General, General_z) %>%
    dplyr::filter(General >= 0) %>%
    dplyr::filter(General <= 10)

p1 <- ggplot(SOEP_process_z_General) +
  geom_histogram(aes(x=General, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SOEP_process_z_General$General, na.rm = TRUE), sd =sd(SOEP_process_z_General$General, na.rm = TRUE))) +
  labs(x= "General") +
  theme_classic() 

p2 <- ggplot(SOEP_process_z_General) +
  geom_histogram(aes(x=General_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SOEP_process_z_General$General_z, na.rm = TRUE), sd =sd(SOEP_process_z_General$General_z, na.rm = TRUE))) +
  labs(x= "General_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("General", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


```{r, echo = F, fig.width = 5, fig.height = 3}
SOEP_process_z_Driving <- SOEP_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, Driving, Driving_z) %>%
    dplyr::filter(Driving >= 0) %>%
    dplyr::filter(Driving <= 10)

p1 <- ggplot(SOEP_process_z_Driving) +
  geom_histogram(aes(x=Driving, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SOEP_process_z_Driving$Driving, na.rm = TRUE), sd =sd(SOEP_process_z_Driving$Driving, na.rm = TRUE))) +
  labs(x= "Driving") +
  theme_classic() 

p2 <- ggplot(SOEP_process_z_Driving) +
  geom_histogram(aes(x=Driving_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SOEP_process_z_Driving$Driving_z, na.rm = TRUE), sd =sd(SOEP_process_z_Driving$Driving_z, na.rm = TRUE))) +
  labs(x= "Driving_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("Driving", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


```{r, echo = F, fig.width = 5, fig.height = 3}
SOEP_process_z_Financial <- SOEP_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, Financial, Financial_z) %>%
    dplyr::filter(Financial >= 0) %>%
    dplyr::filter(Financial <= 10)

p1 <- ggplot(SOEP_process_z_Financial) +
  geom_histogram(aes(x=Financial, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SOEP_process_z_Financial$Financial, na.rm = TRUE), sd =sd(SOEP_process_z_Financial$Financial, na.rm = TRUE))) +
  labs(x= "Financial") + 
  theme_classic() 

p2 <- ggplot(SOEP_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SOEP_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SOEP_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


```{r, echo = F, fig.width = 5, fig.height = 3}
SOEP_process_z_Recreational <- SOEP_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, Recreational, Recreational_z) %>%
    dplyr::filter(Recreational >= 0) %>%
    dplyr::filter(Recreational <= 10)

p1 <- ggplot(SOEP_process_z_Recreational) +
  geom_histogram(aes(x=Recreational, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SOEP_process_z_Recreational$Recreational, na.rm = TRUE), sd =sd(SOEP_process_z_Recreational$Recreational, na.rm = TRUE))) +
  labs(x= "Recreational") + 
  theme_classic() 

p2 <- ggplot(SOEP_process_z_Recreational) +
  geom_histogram(aes(x=Recreational_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SOEP_process_z_Recreational$Recreational_z, na.rm = TRUE), sd =sd(SOEP_process_z_Recreational$Recreational_z, na.rm = TRUE))) +
  labs(x= "Recreational_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("Recreational", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


```{r, echo = F, fig.width = 5, fig.height = 3}
SOEP_process_z_Occupational <- SOEP_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, Occupational, Occupational_z) %>%
    dplyr::filter(Occupational >= 0) %>%
    dplyr::filter(Occupational <= 10)

p1 <- ggplot(SOEP_process_z_Occupational) +
  geom_histogram(aes(x=Occupational, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SOEP_process_z_Occupational$Occupational, na.rm = TRUE), sd =sd(SOEP_process_z_Occupational$Occupational, na.rm = TRUE))) +
  labs(x= "Occupational") + 
  theme_classic() 

p2 <- ggplot(SOEP_process_z_Occupational) +
  geom_histogram(aes(x=Occupational_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SOEP_process_z_Occupational$Occupational_z, na.rm = TRUE), sd =sd(SOEP_process_z_Occupational$Occupational_z, na.rm = TRUE))) +
  labs(x= "Occupational_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("Occupational", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


```{r, echo = F, fig.width = 5, fig.height = 3}
SOEP_process_z_Health <- SOEP_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, Health, Health_z) %>%
    dplyr::filter(Health >= 0) %>%
    dplyr::filter(Health <= 10)

p1 <- ggplot(SOEP_process_z_Health) +
  geom_histogram(aes(x=Health, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SOEP_process_z_Health$Health, na.rm = TRUE), sd =sd(SOEP_process_z_Health$Health, na.rm = TRUE))) +
  labs(x= "Health") + 
  theme_classic() 

p2 <- ggplot(SOEP_process_z_Health) +
  geom_histogram(aes(x=Health_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SOEP_process_z_Health$Health_z, na.rm = TRUE), sd =sd(SOEP_process_z_Health$Health_z, na.rm = TRUE))) +
  labs(x= "Health_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("Health", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


```{r, echo = F, fig.width = 5, fig.height = 3}
SOEP_process_z_Social <- SOEP_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, Social, Social_z) %>%
    dplyr::filter(Social >= 0) %>%
    dplyr::filter(Social <= 10)

p1 <- ggplot(SOEP_process_z_Social) +
  geom_histogram(aes(x=Social, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SOEP_process_z_Social$Social, na.rm = TRUE), sd =sd(SOEP_process_z_Social$Social, na.rm = TRUE))) +
  labs(x= "Social") + 
  theme_classic() 

p2 <- ggplot(SOEP_process_z_Social) +
  geom_histogram(aes(x=Social_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SOEP_process_z_Social$Social_z, na.rm = TRUE), sd =sd(SOEP_process_z_Social$Social_z, na.rm = TRUE))) +
  labs(x= "Social_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("Social", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### HRS 

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = HRS_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="HRS", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 5, fig.height = 3}
HRS_process_z_General <- HRS_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, General, General_z) %>%
    dplyr::filter(General >= 0) %>%
    dplyr::filter(General <= 10)

p1 <- ggplot(HRS_process_z_General) +
  geom_histogram(aes(x=General, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(HRS_process_z_General$General, na.rm = TRUE), sd =sd(HRS_process_z_General$General, na.rm = TRUE))) +
  labs(x= "General") +
  theme_classic() 

p2 <- ggplot(HRS_process_z_General) +
  geom_histogram(aes(x=General_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(HRS_process_z_General$General_z, na.rm = TRUE), sd = sd(HRS_process_z_General$General_z, na.rm = TRUE))) +
  labs(x= "General_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("General", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


```{r, echo = F, fig.width = 5, fig.height = 3}
HRS_process_z_Driving <- HRS_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, Driving, Driving_z) %>%
    dplyr::filter(Driving >= 0) %>%
    dplyr::filter(Driving <= 10)

p1 <- ggplot(HRS_process_z_Driving) +
  geom_histogram(aes(x=Driving, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(HRS_process_z_Driving$Driving, na.rm = TRUE), sd =sd(HRS_process_z_Driving$Driving, na.rm = TRUE))) +
  labs(x= "Driving") +
  theme_classic() 

p2 <- ggplot(HRS_process_z_Driving) +
  geom_histogram(aes(x=Driving_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(HRS_process_z_Driving$Driving_z, na.rm = TRUE), sd = sd(HRS_process_z_Driving$Driving_z, na.rm = TRUE))) +
  labs(x= "Driving_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("Driving", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


```{r, echo = F, fig.width = 5, fig.height = 3}
HRS_process_z_Financial <- HRS_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, Financial, Financial_z) %>%
    dplyr::filter(Financial >= 0) %>%
    dplyr::filter(Financial <= 10)

p1 <- ggplot(HRS_process_z_Financial) +
  geom_histogram(aes(x=Financial, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(HRS_process_z_Financial$Financial, na.rm = TRUE), sd =sd(HRS_process_z_Financial$Financial, na.rm = TRUE))) +
  labs(x= "Financial") +
  theme_classic() 

p2 <- ggplot(HRS_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(HRS_process_z_Financial$Financial_z, na.rm = TRUE), sd = sd(HRS_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


```{r, echo = F, fig.width = 5, fig.height = 3}
HRS_process_z_Recreational <- HRS_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, Recreational, Recreational_z) %>%
    dplyr::filter(Recreational >= 0) %>%
    dplyr::filter(Recreational <= 10)

p1 <- ggplot(HRS_process_z_Recreational) +
  geom_histogram(aes(x=Recreational, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(HRS_process_z_Recreational$Recreational, na.rm = TRUE), sd =sd(HRS_process_z_Recreational$Recreational, na.rm = TRUE))) +
  labs(x= "Recreational") +
  theme_classic() 

p2 <- ggplot(HRS_process_z_Recreational) +
  geom_histogram(aes(x=Recreational_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(HRS_process_z_Recreational$Recreational_z, na.rm = TRUE), sd = sd(HRS_process_z_Recreational$Recreational_z, na.rm = TRUE))) +
  labs(x= "Recreational_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("Recreational", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


```{r, echo = F, fig.width = 5, fig.height = 3}
HRS_process_z_Occupational <- HRS_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, Occupational, Occupational_z) %>%
    dplyr::filter(Occupational >= 0) %>%
    dplyr::filter(Occupational <= 10)

p1 <- ggplot(HRS_process_z_Occupational) +
  geom_histogram(aes(x=Occupational, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(HRS_process_z_Occupational$Occupational, na.rm = TRUE), sd =sd(HRS_process_z_Occupational$Occupational, na.rm = TRUE))) +
  labs(x= "Occupational") +
  theme_classic() 

p2 <- ggplot(HRS_process_z_Occupational) +
  geom_histogram(aes(x=Occupational_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(HRS_process_z_Occupational$Occupational_z, na.rm = TRUE), sd = sd(HRS_process_z_Occupational$Occupational_z, na.rm = TRUE))) +
  labs(x= "Occupational_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("Occupational", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


```{r, echo = F, fig.width = 5, fig.height = 3}
HRS_process_z_Health <- HRS_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, Health, Health_z) %>%
    dplyr::filter(Health >= 0) %>%
    dplyr::filter(Health <= 10)

p1 <- ggplot(HRS_process_z_Health) +
  geom_histogram(aes(x=Health, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(HRS_process_z_Health$Health, na.rm = TRUE), sd =sd(HRS_process_z_Health$Health, na.rm = TRUE))) +
  labs(x= "Health") +
  theme_classic() 

p2 <- ggplot(HRS_process_z_Health) +
  geom_histogram(aes(x=Health_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(HRS_process_z_Health$Health_z, na.rm = TRUE), sd = sd(HRS_process_z_Health$Health_z, na.rm = TRUE))) +
  labs(x= "Health_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("Health", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### SAVE

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = SAVE_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="SAVE", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 5, fig.height = 3}
SAVE_process_z_Driving <- SAVE_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, Driving, Driving_z) %>%
    dplyr::filter(Driving >= 0) %>%
    dplyr::filter(Driving <= 10)

p1 <- ggplot(SAVE_process_z_Driving) +
  geom_histogram(aes(x=Driving, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SAVE_process_z_Driving$Driving, na.rm = TRUE), sd =sd(SAVE_process_z_Driving$Driving, na.rm = TRUE))) +
  labs(x= "Driving") +
  theme_classic() 

p2 <- ggplot(SAVE_process_z_Driving) +
  geom_histogram(aes(x=Driving_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SAVE_process_z_Driving$Driving_z, na.rm = TRUE), sd = sd(SAVE_process_z_Driving$Driving_z, na.rm = TRUE))) +
  labs(x= "Driving_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("Driving", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


```{r, echo = F, fig.width = 5, fig.height = 3}
SAVE_process_z_Financial <- SAVE_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, Financial, Financial_z) %>%
    dplyr::filter(Financial >= 0) %>%
    dplyr::filter(Financial <= 10)

p1 <- ggplot(SAVE_process_z_Financial) +
  geom_histogram(aes(x=Financial, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SAVE_process_z_Financial$Financial, na.rm = TRUE), sd =sd(SAVE_process_z_Financial$Financial, na.rm = TRUE))) +
  labs(x= "Financial") +
  theme_classic() 

p2 <- ggplot(SAVE_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SAVE_process_z_Financial$Financial_z, na.rm = TRUE), sd = sd(SAVE_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


```{r, echo = F, fig.width = 5, fig.height = 3}
SAVE_process_z_Recreational <- SAVE_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, Recreational, Recreational_z) %>%
    dplyr::filter(Recreational >= 0) %>%
    dplyr::filter(Recreational <= 10)

p1 <- ggplot(SAVE_process_z_Recreational) +
  geom_histogram(aes(x=Recreational, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SAVE_process_z_Recreational$Recreational, na.rm = TRUE), sd =sd(SAVE_process_z_Recreational$Recreational, na.rm = TRUE))) +
  labs(x= "Recreational") +
  theme_classic() 

p2 <- ggplot(SAVE_process_z_Recreational) +
  geom_histogram(aes(x=Recreational_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SAVE_process_z_Recreational$Recreational_z, na.rm = TRUE), sd = sd(SAVE_process_z_Recreational$Recreational_z, na.rm = TRUE))) +
  labs(x= "Recreational_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("Recreational", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


```{r, echo = F, fig.width = 5, fig.height = 3}
SAVE_process_z_Occupational <- SAVE_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, Occupational, Occupational_z) %>%
    dplyr::filter(Occupational >= 0) %>%
    dplyr::filter(Occupational <= 10)

p1 <- ggplot(SAVE_process_z_Occupational) +
  geom_histogram(aes(x=Occupational, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SAVE_process_z_Occupational$Occupational, na.rm = TRUE), sd =sd(SAVE_process_z_Occupational$Occupational, na.rm = TRUE))) +
  labs(x= "Occupational") +
  theme_classic() 

p2 <- ggplot(SAVE_process_z_Occupational) +
  geom_histogram(aes(x=Occupational_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SAVE_process_z_Occupational$Occupational_z, na.rm = TRUE), sd = sd(SAVE_process_z_Occupational$Occupational_z, na.rm = TRUE))) +
  labs(x= "Occupational_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("Occupational", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


```{r, echo = F, fig.width = 5, fig.height = 3}
SAVE_process_z_Health <- SAVE_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, Health, Health_z) %>%
    dplyr::filter(Health >= 0) %>%
    dplyr::filter(Health <= 10)

p1 <- ggplot(SAVE_process_z_Health) +
  geom_histogram(aes(x=Health, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SAVE_process_z_Health$Health, na.rm = TRUE), sd =sd(SAVE_process_z_Health$Health, na.rm = TRUE))) +
  labs(x= "Health") +
  theme_classic() 

p2 <- ggplot(SAVE_process_z_Health) +
  geom_histogram(aes(x=Health_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SAVE_process_z_Health$Health_z, na.rm = TRUE), sd = sd(SAVE_process_z_Health$Health_z, na.rm = TRUE))) +
  labs(x= "Health_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("Health", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### DNB

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = DNB_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="DNB", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 5, fig.height = 3}
DNB_process_z_Financial <- DNB_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, Financial, Financial_z) %>%
    dplyr::filter(Financial >= 0) %>%
    dplyr::filter(Financial <= 10)

p1 <- ggplot(DNB_process_z_Financial) +
  geom_histogram(aes(x=Financial, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(DNB_process_z_Financial$Financial, na.rm = TRUE), sd =sd(DNB_process_z_Financial$Financial, na.rm = TRUE))) +
  labs(x= "Financial") +
  theme_classic() 

p2 <- ggplot(DNB_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(DNB_process_z_Financial$Financial_z, na.rm = TRUE), sd = sd(DNB_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### PHF

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = PHF_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="PHF", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 5, fig.height = 3}
PHF_process_z_General <- PHF_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, General, General_z) %>%
    dplyr::filter(General >= 0) %>%
    dplyr::filter(General <= 10)

p1 <- ggplot(PHF_process_z_General) +
  geom_histogram(aes(x=General, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(PHF_process_z_General$General, na.rm = TRUE), sd =sd(PHF_process_z_General$General, na.rm = TRUE))) +
  labs(x= "General") +
  theme_classic() 

p2 <- ggplot(PHF_process_z_General) +
  geom_histogram(aes(x=General_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(PHF_process_z_General$General_z, na.rm = TRUE), sd =sd(PHF_process_z_General$General_z, na.rm = TRUE))) +
  labs(x= "General_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("General", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


```{r, echo = F, fig.width = 8, fig.height = 3}
PHF_process_z_Financial <- PHF_process_z %>%
  dplyr::select(ID, age, SEX, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 
PHF_process_z_Financial$Financial_raw = as.numeric(PHF_process_z_Financial$Financial_raw)

p1 <- ggplot(PHF_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(PHF_process_z_Financial$Financial_raw, na.rm = TRUE), sd = sd(PHF_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_classic() 

p2 <- ggplot(PHF_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(PHF_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(PHF_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_classic() 

p3 <- ggplot(PHF_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(PHF_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(PHF_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, p3, ncol=3, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### SHARE_Austria

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = SHARE_Austria_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="SHARE_Austria", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 8, fig.height = 3}
SHARE_Austria_process_z_Financial <- SHARE_Austria_process_z %>%
  dplyr::select(ID, age, SEX, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

p1 <- ggplot(SHARE_Austria_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Austria_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Austria_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_classic() 

p2 <- ggplot(SHARE_Austria_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Austria_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Austria_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_classic() 

p3 <- ggplot(SHARE_Austria_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Austria_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Austria_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, p3, ncol=3, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### SHARE_Germany

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = SHARE_Germany_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="SHARE_Germany", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 8, fig.height = 3}
SHARE_Germany_process_z_Financial <- SHARE_Germany_process_z %>%
  dplyr::select(ID, age, SEX, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

p1 <- ggplot(SHARE_Germany_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Germany_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Germany_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_classic() 

p2 <- ggplot(SHARE_Germany_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Germany_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Germany_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_classic() 

p3 <- ggplot(SHARE_Germany_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Germany_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Germany_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, p3, ncol=3, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### SHARE_Sweden

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = SHARE_Sweden_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="SHARE_Sweden", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 8, fig.height = 3}
SHARE_Sweden_process_z_Financial <- SHARE_Sweden_process_z %>%
  dplyr::select(ID, age, SEX, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

p1 <- ggplot(SHARE_Sweden_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Sweden_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Sweden_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_classic() 

p2 <- ggplot(SHARE_Sweden_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Sweden_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Sweden_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_classic() 

p3 <- ggplot(SHARE_Sweden_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Sweden_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Sweden_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, p3, ncol=3, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### SHARE_Netherlands

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = SHARE_Netherlands_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="SHARE_Netherlands", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 8, fig.height = 3}
SHARE_Netherlands_process_z_Financial <- SHARE_Netherlands_process_z %>%
  dplyr::select(ID, age, SEX, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

p1 <- ggplot(SHARE_Netherlands_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Netherlands_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Netherlands_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_classic() 

p2 <- ggplot(SHARE_Netherlands_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Netherlands_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Netherlands_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_classic() 

p3 <- ggplot(SHARE_Netherlands_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Netherlands_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Netherlands_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, p3, ncol=3, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### SHARE_Spain

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = SHARE_Spain_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="SHARE_Spain", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 8, fig.height = 3}
SHARE_Spain_process_z_Financial <- SHARE_Spain_process_z %>%
  dplyr::select(ID, age, SEX, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

p1 <- ggplot(SHARE_Spain_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Spain_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Spain_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_classic() 

p2 <- ggplot(SHARE_Spain_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Spain_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Spain_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_classic() 

p3 <- ggplot(SHARE_Spain_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Spain_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Spain_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, p3, ncol=3, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### SHARE_Italy

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = SHARE_Italy_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="SHARE_Italy", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 8, fig.height = 3}
SHARE_Italy_process_z_Financial <- SHARE_Italy_process_z %>%
  dplyr::select(ID, age, SEX, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

p1 <- ggplot(SHARE_Italy_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Italy_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Italy_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_classic() 

p2 <- ggplot(SHARE_Italy_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Italy_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Italy_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_classic() 

p3 <- ggplot(SHARE_Italy_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Italy_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Italy_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, p3, ncol=3, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### SHARE_France

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = SHARE_France_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="SHARE_France", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 8, fig.height = 3}
SHARE_France_process_z_Financial <- SHARE_France_process_z %>%
  dplyr::select(ID, age, SEX, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

p1 <- ggplot(SHARE_France_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_France_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_France_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_classic() 

p2 <- ggplot(SHARE_France_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_France_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_France_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_classic() 

p3 <- ggplot(SHARE_France_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_France_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_France_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, p3, ncol=3, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### SHARE_Denmark

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = SHARE_Denmark_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="SHARE_Denmark", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 8, fig.height = 3}
SHARE_Denmark_process_z_Financial <- SHARE_Denmark_process_z %>%
  dplyr::select(ID, age, SEX, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

p1 <- ggplot(SHARE_Denmark_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Denmark_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Denmark_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_classic() 

p2 <- ggplot(SHARE_Denmark_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Denmark_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Denmark_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_classic() 

p3 <- ggplot(SHARE_Denmark_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Denmark_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Denmark_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, p3, ncol=3, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### SHARE_Switzerland

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = SHARE_Switzerland_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="SHARE_Switzerland", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 8, fig.height = 3}
SHARE_Switzerland_process_z_Financial <- SHARE_Switzerland_process_z %>%
  dplyr::select(ID, age, SEX, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

p1 <- ggplot(SHARE_Switzerland_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Switzerland_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Switzerland_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_classic() 

p2 <- ggplot(SHARE_Switzerland_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Switzerland_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Switzerland_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_classic() 

p3 <- ggplot(SHARE_Switzerland_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Switzerland_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Switzerland_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, p3, ncol=3, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### SHARE_Belgium

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = SHARE_Belgium_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="SHARE_Belgium", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 8, fig.height = 3}
SHARE_Belgium_process_z_Financial <- SHARE_Belgium_process_z %>%
  dplyr::select(ID, age, SEX, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

p1 <- ggplot(SHARE_Belgium_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Belgium_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Belgium_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_classic() 

p2 <- ggplot(SHARE_Belgium_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Belgium_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Belgium_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_classic() 

p3 <- ggplot(SHARE_Belgium_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Belgium_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Belgium_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, p3, ncol=3, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### SHARE_Israel

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = SHARE_Israel_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="SHARE_Israel", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 8, fig.height = 3}
SHARE_Israel_process_z_Financial <- SHARE_Israel_process_z %>%
  dplyr::select(ID, age, SEX, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

p1 <- ggplot(SHARE_Israel_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Israel_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Israel_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_classic() 

p2 <- ggplot(SHARE_Israel_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Israel_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Israel_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_classic() 

p3 <- ggplot(SHARE_Israel_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Israel_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Israel_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, p3, ncol=3, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### SHARE_Czech_Republic

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = SHARE_Czech_Republic_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="SHARE_Czech_Republic", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 8, fig.height = 3}
SHARE_Czech_Republic_process_z_Financial <- SHARE_Czech_Republic_process_z %>%
  dplyr::select(ID, age, SEX, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

p1 <- ggplot(SHARE_Czech_Republic_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Czech_Republic_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Czech_Republic_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_classic() 

p2 <- ggplot(SHARE_Czech_Republic_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Czech_Republic_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Czech_Republic_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_classic() 

p3 <- ggplot(SHARE_Czech_Republic_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Czech_Republic_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Czech_Republic_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, p3, ncol=3, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### SHARE_Slovenia

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = SHARE_Slovenia_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="SHARE_Slovenia", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 8, fig.height = 3}
SHARE_Slovenia_process_z_Financial <- SHARE_Slovenia_process_z %>%
  dplyr::select(ID, age, SEX, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

p1 <- ggplot(SHARE_Slovenia_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Slovenia_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Slovenia_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_classic() 

p2 <- ggplot(SHARE_Slovenia_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Slovenia_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Slovenia_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_classic() 

p3 <- ggplot(SHARE_Slovenia_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Slovenia_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Slovenia_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, p3, ncol=3, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### SHARE_Estonia

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = SHARE_Estonia_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="SHARE_Estonia", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 8, fig.height = 3}
SHARE_Estonia_process_z_Financial <- SHARE_Estonia_process_z %>%
  dplyr::select(ID, age, SEX, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

p1 <- ggplot(SHARE_Estonia_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Estonia_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(SHARE_Estonia_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_classic() 

p2 <- ggplot(SHARE_Estonia_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Estonia_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(SHARE_Estonia_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_classic() 

p3 <- ggplot(SHARE_Estonia_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(SHARE_Estonia_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(SHARE_Estonia_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, p3, ncol=3, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### Usoc

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = Usoc_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="Usoc", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 5, fig.height = 3}
Usoc_process_z_General <- Usoc_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, General, General_z) %>%
    dplyr::filter(General >= 0) %>%
    dplyr::filter(General <= 10)

p1 <- ggplot(Usoc_process_z_General) +
  geom_histogram(aes(x=General, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(Usoc_process_z_General$General, na.rm = TRUE), sd =sd(Usoc_process_z_General$General, na.rm = TRUE))) +
  labs(x= "General") +
  theme_classic() 

p2 <- ggplot(Usoc_process_z_General) +
  geom_histogram(aes(x=General_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(Usoc_process_z_General$General_z, na.rm = TRUE), sd =sd(Usoc_process_z_General$General_z, na.rm = TRUE))) +
  labs(x= "General_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("General", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### GCOE_Japan

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = GCOE_Japan_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="GCOE_Japan", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 5, fig.height = 3}
GCOE_Japan_process_z_General <- GCOE_Japan_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, General, General_z) %>%
    dplyr::filter(General >= 0) %>%
    dplyr::filter(General <= 10)

p1 <- ggplot(GCOE_Japan_process_z_General) +
  geom_histogram(aes(x=General, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(GCOE_Japan_process_z_General$General, na.rm = TRUE), sd =sd(GCOE_Japan_process_z_General$General, na.rm = TRUE))) +
  labs(x= "General") +
  theme_classic() 

p2 <- ggplot(GCOE_Japan_process_z_General) +
  geom_histogram(aes(x=General_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(GCOE_Japan_process_z_General$General_z, na.rm = TRUE), sd =sd(GCOE_Japan_process_z_General$General_z, na.rm = TRUE))) +
  labs(x= "General_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("General", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### GCOE_USA

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = GCOE_USA_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="GCOE_USA", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 5, fig.height = 3}
GCOE_USA_process_z_General <- GCOE_USA_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, General, General_z) %>%
    dplyr::filter(General >= 0) %>%
    dplyr::filter(General <= 10)

p1 <- ggplot(GCOE_USA_process_z_General) +
  geom_histogram(aes(x=General, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(GCOE_USA_process_z_General$General, na.rm = TRUE), sd =sd(GCOE_USA_process_z_General$General, na.rm = TRUE))) +
  labs(x= "General") +
  theme_classic() 

p2 <- ggplot(GCOE_USA_process_z_General) +
  geom_histogram(aes(x=General_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(GCOE_USA_process_z_General$General_z, na.rm = TRUE), sd =sd(GCOE_USA_process_z_General$General_z, na.rm = TRUE))) +
  labs(x= "General_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("General", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### HILDA

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = HILDA_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="HILDA", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 8, fig.height = 3}
HILDA_process_z_Financial <- HILDA_process_z %>%
  dplyr::select(ID, age, SEX, SYEAR, Financial_raw, Financial_reverse, Financial_z) %>%
  dplyr::filter(!is.na(Financial_raw)) 

p1 <- ggplot(HILDA_process_z_Financial) +
  geom_histogram(aes(x=Financial_raw, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(HILDA_process_z_Financial$Financial_raw, na.rm = TRUE), sd =sd(HILDA_process_z_Financial$Financial_raw, na.rm = TRUE))) +
  labs(x= "Financial_raw") +
  theme_classic() 

p2 <- ggplot(HILDA_process_z_Financial) +
  geom_histogram(aes(x=Financial_reverse, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(1,4,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(HILDA_process_z_Financial$Financial_reverse, na.rm = TRUE), sd =sd(HILDA_process_z_Financial$Financial_reverse, na.rm = TRUE))) +
  labs(x= "Financial_reverse") +
  theme_classic() 

p3 <- ggplot(HILDA_process_z_Financial) +
  geom_histogram(aes(x=Financial_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(HILDA_process_z_Financial$Financial_z, na.rm = TRUE), sd =sd(HILDA_process_z_Financial$Financial_z, na.rm = TRUE))) +
  labs(x= "Financial_z") +
  theme_classic() 

grid.arrange(p1, p2, p3, ncol=3, top = textGrob("Financial", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```


#### LIKS

##### **Age distribution**

```{r, echo = F, fig.width = 8, fig.height = 6}
ggplot(data = LIKS_process_z, aes(x = age_bins)) +
    geom_bar(width = 0.5) +
    geom_text(stat='count',aes(label=..count..), vjust=-0.5) +
    labs(title="LIKS", x= "Age", y= "Count, observations") +
    theme(axis.title.x = element_text(size = 16), axis.title.y = element_text(size = 16), plot.title = element_text(size=22))
```

##### **Risk density**

```{r, echo = F, fig.width = 5, fig.height = 3}
LIKS_process_z_General <- LIKS_process_z %>%
dplyr::select(ID, age, SEX, SYEAR, General, General_z) %>%
    dplyr::filter(General >= 0) %>%
    dplyr::filter(General <= 10)

p1 <- ggplot(LIKS_process_z_General) +
  geom_histogram(aes(x=General, y = ..density..), binwidth = 1, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(0,10,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(LIKS_process_z_General$General, na.rm = TRUE), sd =sd(LIKS_process_z_General$General, na.rm = TRUE))) +
  labs(x= "General") +
  theme_classic() 

p2 <- ggplot(LIKS_process_z_General) +
  geom_histogram(aes(x=General_z, y = ..density..), binwidth = 0.5, fill = "grey", color = "black") + 
  scale_x_continuous(breaks=seq(-3,3,by=1)) +
  stat_function(fun = dnorm, colour = "red", args = list(mean = mean(LIKS_process_z_General$General_z, na.rm = TRUE), sd =sd(LIKS_process_z_General$General_z, na.rm = TRUE))) +
  labs(x= "General_z") +
  theme_classic() 

grid.arrange(p1, p2, ncol=2, top = textGrob("General", x = 0, hjust = 0, gp=gpar(fontface="bold")))
```

<div style="margin-bottom:40px;">
</div>


## 4. Multi-level model results

### 4.1. General risk-taking{.tabset}

#### Intercept only model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
p_judge <- function(x){
  for (i in 1:length(x)) {
    value = as.numeric(x[[i]])
    if(value < 0.001) {
      x[[i]] = "p < 0.001"
      } else if( value < 0.01) {
        x[[i]] = "P < 0.01"
        } else if (value < 0.05) {
          x[[i]] = "p < 0.05"
          } else {
            x[[i]] <- purrr::modify_if(value, ~is.numeric(.), ~round(., 3))
          }
  }
  return(x)
}


setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
results_table_list <- readRDS(file = "results_table_list.Rds")
results_g.int  <- results_table_list$results_g.int 
remove <- c("Intercept_Std.Error2")
results_g.int  <- results_g.int [!(row.names(results_g.int ) %in% remove),]
rownames(results_g.int )[rownames(results_g.int )=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
results_g.int  <- results_g.int [, colSums(is.na(results_g.int )) != nrow(results_g.int )]
results_g.int  <- results_g.int [complete.cases(results_g.int ), ]
results_g.int [c(1:3,5:8,11), ] <- purrr::modify_if(results_g.int [c(1:3,5:8,11), ], ~is.numeric(.), ~round(., 2))
results_g.int [c(9:10),] <- purrr::modify_if(results_g.int [c(9:10), ], ~is.numeric(.), ~round(., 0))
results_g.int [4,] <- p_judge(results_g.int [4,])

datatable(results_g.int , options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_g.int )))))
```

<div style="margin-bottom:40px;">
</div>


#### Fixed effect model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_g.fixed <- results_table_list$results_g.fixed
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_g.fixed <- results_g.fixed[!(row.names(results_g.fixed) %in% remove),]
rownames(results_g.fixed)[rownames(results_g.fixed)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_g.fixed)[rownames(results_g.fixed)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_g.fixed <- results_g.fixed[, colSums(is.na(results_g.fixed)) != nrow(results_g.fixed)]
results_g.fixed <- results_g.fixed[complete.cases(results_g.fixed), ]

results_g.fixed[c(1:6,9:10,13), ] <- purrr::modify_if(results_g.fixed[c(1:6,9:10,13), ], ~is.numeric(.), ~round(., 2))
results_g.fixed[c(11:12), ] <- purrr::modify_if(results_g.fixed[c(11:12), ], ~is.numeric(.), ~round(., 0))

results_g.fixed[7,] <- p_judge(results_g.fixed[7,])
results_g.fixed[8,] <- p_judge(results_g.fixed[8,])

results_g.fixed <- results_g.fixed[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "N.group", "N.obs", "LL"),]

datatable(results_g.fixed, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_g.fixed)))))
```

<div style="margin-bottom:40px;">
</div>


#### Linear model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_g.lg <- results_table_list$results_g.lg
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_g.lg <- results_g.lg[!(row.names(results_g.lg) %in% remove),]
rownames(results_g.lg)[rownames(results_g.lg)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_g.lg)[rownames(results_g.lg)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_g.lg <- results_g.lg[, colSums(is.na(results_g.lg)) != nrow(results_g.lg)]
results_g.lg <- results_g.lg[complete.cases(results_g.lg), ]

results_g.lg[c(1:6,9:13,16), ] <- purrr::modify_if(results_g.lg[c(1:6,9:13,16), ], ~is.numeric(.), ~round(., 2))
results_g.lg[c(14:15), ] <- purrr::modify_if(results_g.lg[c(14:15), ], ~is.numeric(.), ~round(., 0))

results_g.lg[7,] <- p_judge(results_g.lg[7,])
results_g.lg[8,] <- p_judge(results_g.lg[8,])

results_g.lg <- results_g.lg[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_g.lg, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_g.lg)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 7.5}
panels = c("SOEP","HRS","SAVE","DNB","PHF",
           "SHARE_Austria", "SHARE_Germany", "SHARE_Sweden", "SHARE_Netherlands", "SHARE_Spain", "SHARE_Italy", "SHARE_France", "SHARE_Denmark", "SHARE_Switzerland","SHARE_Belgium", "SHARE_Israel", "SHARE_Czech_Republic", "SHARE_Slovenia", "SHARE_Estonia",
           "Usoc","GCOE_Japan","GCOE_USA", "HILDA", "LIKS")   # do not include Addhealth / NLSY79_Child / NLSY79_YA panel

colordata <- data.frame(matrix(data=NA, nrow=length(panels), ncol = 1)) 
colordata <- as.data.frame(matrix(panels))
colnames(colordata) <- "Panel"
colordata$Panel<- as.factor(colordata$Panel)

setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
plot_model_data_list <- readRDS(file = "plot_model_data_list.Rds")
raw_mean_data_list <- readRDS(file = "raw_mean_data_list.Rds")

#model data
model_data <- plot_model_data_list$plot_g.lg
#mean data
mean_data <- raw_mean_data_list$plot_g.lg %>%
  filter(General_z_n >= 50)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = General_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x, size = 0.5) +
   labs(title="General", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~Panel, nrow = 3)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_g.lg.sex <- results_table_list$results_g.lg.sex
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "sex_Std.Error2")
results_g.lg.sex <- results_g.lg.sex[!(row.names(results_g.lg.sex) %in% remove),]
rownames(results_g.lg.sex)[rownames(results_g.lg.sex)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_g.lg.sex)[rownames(results_g.lg.sex)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_g.lg.sex)[rownames(results_g.lg.sex)=="sex_Std.Error1"] <- "sex_Std.Error"
results_g.lg.sex <- results_g.lg.sex[, colSums(is.na(results_g.lg.sex)) != nrow(results_g.lg.sex)]
results_g.lg.sex <- results_g.lg.sex[complete.cases(results_g.lg.sex), ]

results_g.lg.sex[c(1:9,13:17,20), ] <- purrr::modify_if(results_g.lg.sex[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_g.lg.sex[c(18:19), ] <- purrr::modify_if(results_g.lg.sex[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_g.lg.sex[10,] <- p_judge(results_g.lg.sex[10,])
results_g.lg.sex[11,] <- p_judge(results_g.lg.sex[11,])
results_g.lg.sex[12,] <- p_judge(results_g.lg.sex[12,])

results_g.lg.sex <- results_g.lg.sex[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "sex_Estimate","sex_Std.Error", "sex_t.value", "sex_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_g.lg.sex, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_g.lg.sex)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 7.5}
#model data
model_data <- plot_model_data_list$plot_g.lg.sex
#mean data
mean_data <- raw_mean_data_list$plot_g.lg.sex %>%
  filter(General_z_n >= 50)

model_data[,"sex"] <- ifelse(model_data$sex == 1, "female", "male")
mean_data[,"sex"] <- ifelse(mean_data$sex == 1, "female", "male")

ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = General_z_mean, group=sex, colour=Panel, pch=sex), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=sex, colour=Panel, linetype = sex), method = "lm", formula = y ~ x, size = 0.5) +
   labs(title="General", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 3)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender interaction model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_g.lg.inter <- results_table_list$results_g.lg.inter
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "sex_Std.Error2", "d_c_age:sex_Std.Error2")
results_g.lg.inter <- results_g.lg.inter[!(row.names(results_g.lg.inter) %in% remove),]
rownames(results_g.lg.inter)[rownames(results_g.lg.inter)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_g.lg.inter)[rownames(results_g.lg.inter)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_g.lg.inter)[rownames(results_g.lg.inter)=="sex_Std.Error1"] <- "sex_Std.Error"
rownames(results_g.lg.inter)[rownames(results_g.lg.inter)=="d_c_age:sex_Std.Error1"] <- "d_c_age:sex_Std.Error"
results_g.lg.inter <- results_g.lg.inter[, colSums(is.na(results_g.lg.inter)) != nrow(results_g.lg.inter)]
results_g.lg.inter <- results_g.lg.inter[complete.cases(results_g.lg.inter), ]

results_g.lg.inter[c(1:12,17:21,24), ] <- purrr::modify_if(results_g.lg.inter[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_g.lg.inter[c(22:23), ] <- purrr::modify_if(results_g.lg.inter[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_g.lg.inter[13,] <- p_judge(results_g.lg.inter[13,])
results_g.lg.inter[14,] <- p_judge(results_g.lg.inter[14,])
results_g.lg.inter[15,] <- p_judge(results_g.lg.inter[15,])
results_g.lg.inter[16,] <- p_judge(results_g.lg.inter[16,])

results_g.lg.inter <- results_g.lg.inter[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "sex_Estimate", "sex_Std.Error", "sex_t.value", "sex_p.value", "d_c_age:sex_Estimate", "d_c_age:sex_Std.Error", "d_c_age:sex_t.value", "d_c_age:sex_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_g.lg.inter, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_g.lg.inter)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 7.5}
#model data
model_data <- plot_model_data_list$plot_g.lg.inter
#mean data
mean_data <- raw_mean_data_list$plot_g.lg.inter %>%
  filter(General_z_n >= 50)

model_data[,"sex"] <- ifelse(model_data$sex == 1, "female", "male")
mean_data[,"sex"] <- ifelse(mean_data$sex == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = General_z_mean, group=sex, colour=Panel, pch=sex), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=sex, colour=Panel, linetype = sex), method = "lm", formula = y ~ x, size = 0.5) +
   labs(title="General", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 3)
```

<div style="margin-bottom:40px;">
</div>


#### Quadratic model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_g.quad <- results_table_list$results_g.quad
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "I(d_c_age^2)_Std.Error2")
results_g.quad <- results_g.quad[!(row.names(results_g.quad) %in% remove),]
rownames(results_g.quad)[rownames(results_g.quad)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_g.quad)[rownames(results_g.quad)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_g.quad)[rownames(results_g.quad)=="I(d_c_age^2)_Std.Error1"] <- "I(d_c_age^2)_Std.Error"
results_g.quad <- results_g.quad[, colSums(is.na(results_g.quad)) != nrow(results_g.quad)]
results_g.quad <- results_g.quad[complete.cases(results_g.quad), ]

results_g.quad[c(1:9,13:17,20), ] <- purrr::modify_if(results_g.quad[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_g.quad[c(18:19), ] <- purrr::modify_if(results_g.quad[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_g.quad[10,] <- p_judge(results_g.quad[10,])
results_g.quad[11,] <- p_judge(results_g.quad[11,])
results_g.quad[12,] <- p_judge(results_g.quad[12,])


results_g.quad <- results_g.quad[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "I(d_c_age^2)_Estimate", "I(d_c_age^2)_Std.Error", "I(d_c_age^2)_t.value", "I(d_c_age^2)_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_g.quad, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_g.quad)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**

```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 7, fig.height = 5.5}
#model data
model_data <- plot_model_data_list$plot_g.quad
#mean data
mean_data <- raw_mean_data_list$plot_g.quad %>%
  filter(General_z_n >= 50)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = General_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x + I(x^2), size = 0.5) +
   labs(title="General", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   facet_wrap(~Panel, nrow = 2)
```

<div style="margin-bottom:40px;">
</div>


#### Quadratic with gender model

##### **Models results**

```{r, echo = F, warning = FALSE, message = FALSE}
results_g.quad.sex <- results_table_list$results_g.quad.sex
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "I(d_c_age^2)_Std.Error2","sex_Std.Error2")
results_g.quad.sex <- results_g.quad.sex[!(row.names(results_g.quad.sex) %in% remove),]
rownames(results_g.quad.sex)[rownames(results_g.quad.sex)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_g.quad.sex)[rownames(results_g.quad.sex)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_g.quad.sex)[rownames(results_g.quad.sex)=="I(d_c_age^2)_Std.Error1"] <- "I(d_c_age^2)_Std.Error"
rownames(results_g.quad.sex)[rownames(results_g.quad.sex)=="sex_Std.Error1"] <- "sex_Std.Error1"
results_g.quad.sex <- results_g.quad.sex[, colSums(is.na(results_g.quad.sex)) != nrow(results_g.quad.sex)]
results_g.quad.sex <- results_g.quad.sex[complete.cases(results_g.quad.sex), ]

results_g.quad.sex[c(1:12,17:21,24), ] <- purrr::modify_if(results_g.quad.sex[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_g.quad.sex[c(22:23), ] <- purrr::modify_if(results_g.quad.sex[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_g.quad.sex[13,] <- p_judge(results_g.quad.sex[13,])
results_g.quad.sex[14,] <- p_judge(results_g.quad.sex[14,])
results_g.quad.sex[15,] <- p_judge(results_g.quad.sex[15,])
results_g.quad.sex[16,] <- p_judge(results_g.quad.sex[16,])


results_g.quad.sex <- results_g.quad.sex[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "I(d_c_age^2)_Estimate", "I(d_c_age^2)_Std.Error", "I(d_c_age^2)_t.value", "I(d_c_age^2)_p.value", "sex_Estimate", "sex_Std.Error", "sex_t.value", "sex_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_g.quad.sex, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_g.quad.sex)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 7, fig.height = 5.5}
#model data
model_data <- plot_model_data_list$plot_g.quad.sex
#mean data
mean_data <- raw_mean_data_list$plot_g.quad.sex %>%
  filter(General_z_n >= 50)

model_data[,"sex"] <- ifelse(model_data$sex == 1, "female", "male")
mean_data[,"sex"] <- ifelse(mean_data$sex == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = General_z_mean, group=sex, colour=Panel, pch=sex), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=sex, colour=Panel, linetype = sex), method = "lm", formula = y ~ x + I(x^2), size = 0.5) +
   labs(title="General", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 2)
```

<div style="margin-bottom:40px;">
</div>



### 4.2. Driving risk-taking{.tabset}

#### Intercept only model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_d.int <- results_table_list$results_d.int
remove <- c("Intercept_Std.Error2")
results_d.int <- results_d.int[!(row.names(results_d.int) %in% remove),]
rownames(results_d.int)[rownames(results_d.int)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
results_d.int <- results_d.int[, colSums(is.na(results_d.int)) != nrow(results_d.int)]
results_d.int <- results_d.int[complete.cases(results_d.int), ]
results_d.int[c(1:3,5:8,11), ] <- purrr::modify_if(results_d.int[c(1:3,5:8,11), ], ~is.numeric(.), ~round(., 2))
results_d.int[c(9:10),] <- purrr::modify_if(results_d.int[c(9:10), ], ~is.numeric(.), ~round(., 0))
results_d.int[4,] <- p_judge(results_d.int[4,])

datatable(results_d.int, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_d.int)))))
```

<div style="margin-bottom:40px;">
</div>


#### Fixed effect model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_d.fixed <- results_table_list$results_d.fixed
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_d.fixed <- results_d.fixed[!(row.names(results_d.fixed) %in% remove),]
rownames(results_d.fixed)[rownames(results_d.fixed)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_d.fixed)[rownames(results_d.fixed)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_d.fixed <- results_d.fixed[, colSums(is.na(results_d.fixed)) != nrow(results_d.fixed)]
results_d.fixed <- results_d.fixed[complete.cases(results_d.fixed), ]

results_d.fixed[c(1:6,9:10,13), ] <- purrr::modify_if(results_d.fixed[c(1:6,9:10,13), ], ~is.numeric(.), ~round(., 2))
results_d.fixed[c(11:12), ] <- purrr::modify_if(results_d.fixed[c(11:12), ], ~is.numeric(.), ~round(., 0))

results_d.fixed[7,] <- p_judge(results_d.fixed[7,])
results_d.fixed[8,] <- p_judge(results_d.fixed[8,])

results_d.fixed <- results_d.fixed[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "N.group", "N.obs", "LL"),]

datatable(results_d.fixed, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_d.fixed)))))
```

<div style="margin-bottom:40px;">
</div>


#### Linear model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_d.lg <- results_table_list$results_d.lg
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_d.lg <- results_d.lg[!(row.names(results_d.lg) %in% remove),]
rownames(results_d.lg)[rownames(results_d.lg)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_d.lg)[rownames(results_d.lg)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_d.lg <- results_d.lg[, colSums(is.na(results_d.lg)) != nrow(results_d.lg)]
results_d.lg <- results_d.lg[complete.cases(results_d.lg), ]

results_d.lg[c(1:6,9:13,16), ] <- purrr::modify_if(results_d.lg[c(1:6,9:13,16), ], ~is.numeric(.), ~round(., 2))
results_d.lg[c(14:15), ] <- purrr::modify_if(results_d.lg[c(14:15), ], ~is.numeric(.), ~round(., 0))

results_d.lg[7,] <- p_judge(results_d.lg[7,])
results_d.lg[8,] <- p_judge(results_d.lg[8,])

results_d.lg <- results_d.lg[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_d.lg, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_d.lg)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 3.5}
#model data
model_data <- plot_model_data_list$plot_d.lg
#mean data
mean_data <- raw_mean_data_list$plot_d.lg %>%
  filter(Driving_z_n >= 50)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Driving_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x, size = 0.5) +
   labs(title="Driving", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_d.lg.sex <- results_table_list$results_d.lg.sex
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "sex_Std.Error2")
results_d.lg.sex <- results_d.lg.sex[!(row.names(results_d.lg.sex) %in% remove),]
rownames(results_d.lg.sex)[rownames(results_d.lg.sex)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_d.lg.sex)[rownames(results_d.lg.sex)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_d.lg.sex)[rownames(results_d.lg.sex)=="sex_Std.Error1"] <- "sex_Std.Error"
results_d.lg.sex <- results_d.lg.sex[, colSums(is.na(results_d.lg.sex)) != nrow(results_d.lg.sex)]
results_d.lg.sex <- results_d.lg.sex[complete.cases(results_d.lg.sex), ]

results_d.lg.sex[c(1:9,13:17,20), ] <- purrr::modify_if(results_d.lg.sex[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_d.lg.sex[c(18:19), ] <- purrr::modify_if(results_d.lg.sex[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_d.lg.sex[10,] <- p_judge(results_d.lg.sex[10,])
results_d.lg.sex[11,] <- p_judge(results_d.lg.sex[11,])
results_d.lg.sex[12,] <- p_judge(results_d.lg.sex[12,])

results_d.lg.sex <- results_d.lg.sex[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "sex_Estimate","sex_Std.Error", "sex_t.value", "sex_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_d.lg.sex, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_d.lg.sex)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 3.5}
#model data
model_data <- plot_model_data_list$plot_d.lg.sex
#mean data
mean_data <- raw_mean_data_list$plot_d.lg.sex %>%
  filter(Driving_z_n >= 50)

model_data[,"sex"] <- ifelse(model_data$sex == 1, "female", "male")
mean_data[,"sex"] <- ifelse(mean_data$sex == 1, "female", "male")

ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Driving_z_mean, group=sex, colour=Panel, pch=sex), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=sex, colour=Panel, linetype = sex), method = "lm", formula = y ~ x, size = 0.5) +
   labs(title="Driving", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender interaction model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_d.lg.inter <- results_table_list$results_d.lg.inter
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "sex_Std.Error2", "d_c_age:sex_Std.Error2")
results_d.lg.inter <- results_d.lg.inter[!(row.names(results_d.lg.inter) %in% remove),]
rownames(results_d.lg.inter)[rownames(results_d.lg.inter)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_d.lg.inter)[rownames(results_d.lg.inter)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_d.lg.inter)[rownames(results_d.lg.inter)=="sex_Std.Error1"] <- "sex_Std.Error"
rownames(results_d.lg.inter)[rownames(results_d.lg.inter)=="d_c_age:sex_Std.Error1"] <- "d_c_age:sex_Std.Error"
results_d.lg.inter <- results_d.lg.inter[, colSums(is.na(results_d.lg.inter)) != nrow(results_d.lg.inter)]
results_d.lg.inter <- results_d.lg.inter[complete.cases(results_d.lg.inter), ]

results_d.lg.inter[c(1:12,17:21,24), ] <- purrr::modify_if(results_d.lg.inter[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_d.lg.inter[c(22:23), ] <- purrr::modify_if(results_d.lg.inter[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_d.lg.inter[13,] <- p_judge(results_d.lg.inter[13,])
results_d.lg.inter[14,] <- p_judge(results_d.lg.inter[14,])
results_d.lg.inter[15,] <- p_judge(results_d.lg.inter[15,])
results_d.lg.inter[16,] <- p_judge(results_d.lg.inter[16,])

results_d.lg.inter <- results_d.lg.inter[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "sex_Estimate", "sex_Std.Error", "sex_t.value", "sex_p.value", "d_c_age:sex_Estimate", "d_c_age:sex_Std.Error", "d_c_age:sex_t.value", "d_c_age:sex_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_d.lg.inter, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_d.lg.inter)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 3.5}
#model data
model_data <- plot_model_data_list$plot_d.lg.inter
#mean data
mean_data <- raw_mean_data_list$plot_d.lg.inter %>%
  filter(Driving_z_n >= 50)

model_data[,"sex"] <- ifelse(model_data$sex == 1, "female", "male")
mean_data[,"sex"] <- ifelse(mean_data$sex == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Driving_z_mean, group=sex, colour=Panel, pch=sex), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=sex, colour=Panel, linetype = sex), method = "lm", formula = y ~ x, size = 0.5) +
   labs(title="Driving", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


### 4.3. Financial risk-taking{.tabset}

#### Intercept only model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_f.int <- results_table_list$results_f.int
remove <- c("Intercept_Std.Error2")
results_f.int <- results_f.int[!(row.names(results_f.int) %in% remove),]
rownames(results_f.int)[rownames(results_f.int)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
results_f.int <- results_f.int[, colSums(is.na(results_f.int)) != nrow(results_f.int)]
results_f.int <- results_f.int[complete.cases(results_f.int), ]
results_f.int[c(1:3,5:8,11), ] <- purrr::modify_if(results_f.int[c(1:3,5:8,11), ], ~is.numeric(.), ~round(., 2))
results_f.int[c(9:10),] <- purrr::modify_if(results_f.int[c(9:10), ], ~is.numeric(.), ~round(., 0))
results_f.int[4,] <- p_judge(results_f.int[4,])

datatable(results_f.int, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_f.int)))))
```

<div style="margin-bottom:40px;">
</div>


#### Fixed effect model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_f.fixed <- results_table_list$results_f.fixed
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_f.fixed <- results_f.fixed[!(row.names(results_f.fixed) %in% remove),]
rownames(results_f.fixed)[rownames(results_f.fixed)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_f.fixed)[rownames(results_f.fixed)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_f.fixed <- results_f.fixed[, colSums(is.na(results_f.fixed)) != nrow(results_f.fixed)]
results_f.fixed <- results_f.fixed[complete.cases(results_f.fixed), ]

results_f.fixed[c(1:6,9:10,13), ] <- purrr::modify_if(results_f.fixed[c(1:6,9:10,13), ], ~is.numeric(.), ~round(., 2))
results_f.fixed[c(11:12), ] <- purrr::modify_if(results_f.fixed[c(11:12), ], ~is.numeric(.), ~round(., 0))

results_f.fixed[7,] <- p_judge(results_f.fixed[7,])
results_f.fixed[8,] <- p_judge(results_f.fixed[8,])

results_f.fixed <- results_f.fixed[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "N.group", "N.obs", "LL"),]

datatable(results_f.fixed, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_f.fixed)))))
```

<div style="margin-bottom:40px;">
</div>


#### Linear model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_f.lg <- results_table_list$results_f.lg
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_f.lg <- results_f.lg[!(row.names(results_f.lg) %in% remove),]
rownames(results_f.lg)[rownames(results_f.lg)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_f.lg)[rownames(results_f.lg)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_f.lg <- results_f.lg[, colSums(is.na(results_f.lg)) != nrow(results_f.lg)]
results_f.lg <- results_f.lg[complete.cases(results_f.lg), ]

results_f.lg[c(1:6,9:13,16), ] <- purrr::modify_if(results_f.lg[c(1:6,9:13,16), ], ~is.numeric(.), ~round(., 2))
results_f.lg[c(14:15), ] <- purrr::modify_if(results_f.lg[c(14:15), ], ~is.numeric(.), ~round(., 0))

results_f.lg[7,] <- p_judge(results_f.lg[7,])
results_f.lg[8,] <- p_judge(results_f.lg[8,])

results_f.lg <- results_f.lg[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_f.lg, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_f.lg)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 15.5}
#model data
model_data <- plot_model_data_list$plot_f.lg
#mean data
mean_data <- raw_mean_data_list$plot_f.lg %>%
  filter(Financial_z_n >= 50)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Financial_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x, size = 0.5) +
   labs(title="Financial", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~Panel, nrow = 7)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_f.lg.sex <- results_table_list$results_f.lg.sex
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "sex_Std.Error2")
results_f.lg.sex <- results_f.lg.sex[!(row.names(results_f.lg.sex) %in% remove),]
rownames(results_f.lg.sex)[rownames(results_f.lg.sex)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_f.lg.sex)[rownames(results_f.lg.sex)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_f.lg.sex)[rownames(results_f.lg.sex)=="sex_Std.Error1"] <- "sex_Std.Error"
results_f.lg.sex <- results_f.lg.sex[, colSums(is.na(results_f.lg.sex)) != nrow(results_f.lg.sex)]
results_f.lg.sex <- results_f.lg.sex[complete.cases(results_f.lg.sex), ]

results_f.lg.sex[c(1:9,13:17,20), ] <- purrr::modify_if(results_f.lg.sex[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_f.lg.sex[c(18:19), ] <- purrr::modify_if(results_f.lg.sex[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_f.lg.sex[10,] <- p_judge(results_f.lg.sex[10,])
results_f.lg.sex[11,] <- p_judge(results_f.lg.sex[11,])
results_f.lg.sex[12,] <- p_judge(results_f.lg.sex[12,])

results_f.lg.sex <- results_f.lg.sex[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "sex_Estimate","sex_Std.Error", "sex_t.value", "sex_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_f.lg.sex, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_f.lg.sex)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 15.5}
#model data
model_data <- plot_model_data_list$plot_f.lg.sex
#mean data
mean_data <- raw_mean_data_list$plot_f.lg.sex %>%
  filter(Financial_z_n >= 50)

model_data[,"sex"] <- ifelse(model_data$sex == 1, "female", "male")
mean_data[,"sex"] <- ifelse(mean_data$sex == 1, "female", "male")

ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Financial_z_mean, group=sex, colour=Panel, pch=sex), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=sex, colour=Panel, linetype = sex), method = "lm", formula = y ~ x, size = 0.5) +
   labs(title="Financial", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 7)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender interaction model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_f.lg.inter <- results_table_list$results_f.lg.inter
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "sex_Std.Error2", "d_c_age:sex_Std.Error2")
results_f.lg.inter <- results_f.lg.inter[!(row.names(results_f.lg.inter) %in% remove),]
rownames(results_f.lg.inter)[rownames(results_f.lg.inter)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_f.lg.inter)[rownames(results_f.lg.inter)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_f.lg.inter)[rownames(results_f.lg.inter)=="sex_Std.Error1"] <- "sex_Std.Error"
rownames(results_f.lg.inter)[rownames(results_f.lg.inter)=="d_c_age:sex_Std.Error1"] <- "d_c_age:sex_Std.Error"
results_f.lg.inter <- results_f.lg.inter[, colSums(is.na(results_f.lg.inter)) != nrow(results_f.lg.inter)]
results_f.lg.inter <- results_f.lg.inter[complete.cases(results_f.lg.inter), ]

results_f.lg.inter[c(1:12,17:21,24), ] <- purrr::modify_if(results_f.lg.inter[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_f.lg.inter[c(22:23), ] <- purrr::modify_if(results_f.lg.inter[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_f.lg.inter[13,] <- p_judge(results_f.lg.inter[13,])
results_f.lg.inter[14,] <- p_judge(results_f.lg.inter[14,])
results_f.lg.inter[15,] <- p_judge(results_f.lg.inter[15,])
results_f.lg.inter[16,] <- p_judge(results_f.lg.inter[16,])

results_f.lg.inter <- results_f.lg.inter[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "sex_Estimate", "sex_Std.Error", "sex_t.value", "sex_p.value", "d_c_age:sex_Estimate", "d_c_age:sex_Std.Error", "d_c_age:sex_t.value", "d_c_age:sex_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_f.lg.inter, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_f.lg.inter)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 15.5}
#model data
model_data <- plot_model_data_list$plot_f.lg.inter
#mean data
mean_data <- raw_mean_data_list$plot_f.lg.inter %>%
  filter(Financial_z_n >= 50)

model_data[,"sex"] <- ifelse(model_data$sex == 1, "female", "male")
mean_data[,"sex"] <- ifelse(mean_data$sex == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Financial_z_mean, group=sex, colour=Panel, pch=sex), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=sex, colour=Panel, linetype = sex), method = "lm", formula = y ~ x, size = 0.5) +
   labs(title="Financial", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 7)
```

<div style="margin-bottom:40px;">
</div>


#### Quadratic model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_f.quad <- results_table_list$results_f.quad
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "I(d_c_age^2)_Std.Error2")
results_f.quad <- results_f.quad[!(row.names(results_f.quad) %in% remove),]
rownames(results_f.quad)[rownames(results_f.quad)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_f.quad)[rownames(results_f.quad)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_f.quad)[rownames(results_f.quad)=="I(d_c_age^2)_Std.Error1"] <- "I(d_c_age^2)_Std.Error"
results_f.quad <- results_f.quad[, colSums(is.na(results_f.quad)) != nrow(results_f.quad)]
results_f.quad <- results_f.quad[complete.cases(results_f.quad), ]

results_f.quad[c(1:9,13:17,20), ] <- purrr::modify_if(results_f.quad[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_f.quad[c(18:19), ] <- purrr::modify_if(results_f.quad[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_f.quad[10,] <- p_judge(results_f.quad[10,])
results_f.quad[11,] <- p_judge(results_f.quad[11,])
results_f.quad[12,] <- p_judge(results_f.quad[12,])


results_f.quad <- results_f.quad[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "I(d_c_age^2)_Estimate", "I(d_c_age^2)_Std.Error", "I(d_c_age^2)_t.value", "I(d_c_age^2)_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_f.quad, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_f.quad)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 11.5}
#model data
model_data <- plot_model_data_list$plot_f.quad
#mean data
mean_data <- raw_mean_data_list$plot_f.quad %>%
  filter(Financial_z_n >= 50)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Financial_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x + I(x^2), size = 0.5) +
   labs(title="Financial", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~Panel, nrow = 5)
```

<div style="margin-bottom:40px;">
</div>


#### Quadratic with gender model

##### **Models results**

```{r, echo = F, warning = FALSE, message = FALSE}
results_f.quad.sex <- results_table_list$results_f.quad.sex
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "I(d_c_age^2)_Std.Error2","sex_Std.Error2")
results_f.quad.sex <- results_f.quad.sex[!(row.names(results_f.quad.sex) %in% remove),]
rownames(results_f.quad.sex)[rownames(results_f.quad.sex)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_f.quad.sex)[rownames(results_f.quad.sex)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_f.quad.sex)[rownames(results_f.quad.sex)=="I(d_c_age^2)_Std.Error1"] <- "I(d_c_age^2)_Std.Error"
rownames(results_f.quad.sex)[rownames(results_f.quad.sex)=="sex_Std.Error1"] <- "sex_Std.Error1"
results_f.quad.sex <- results_f.quad.sex[, colSums(is.na(results_f.quad.sex)) != nrow(results_f.quad.sex)]
results_f.quad.sex <- results_f.quad.sex[complete.cases(results_f.quad.sex), ]

results_f.quad.sex[c(1:12,17:21,24), ] <- purrr::modify_if(results_f.quad.sex[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_f.quad.sex[c(22:23), ] <- purrr::modify_if(results_f.quad.sex[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_f.quad.sex[13,] <- p_judge(results_f.quad.sex[13,])
results_f.quad.sex[14,] <- p_judge(results_f.quad.sex[14,])
results_f.quad.sex[15,] <- p_judge(results_f.quad.sex[15,])
results_f.quad.sex[16,] <- p_judge(results_f.quad.sex[16,])


results_f.quad.sex <- results_f.quad.sex[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "I(d_c_age^2)_Estimate", "I(d_c_age^2)_Std.Error", "I(d_c_age^2)_t.value", "I(d_c_age^2)_p.value", "sex_Estimate", "sex_Std.Error", "sex_t.value", "sex_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_f.quad.sex, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_f.quad.sex)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 11.5}
#model data
model_data <- plot_model_data_list$plot_f.quad.sex
#mean data
mean_data <- raw_mean_data_list$plot_f.quad.sex %>%
  filter(Financial_z_n >= 50)

model_data[,"sex"] <- ifelse(model_data$sex == 1, "female", "male")
mean_data[,"sex"] <- ifelse(mean_data$sex == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Financial_z_mean, group=sex, colour=Panel, pch=sex), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=sex, colour=Panel, linetype = sex), method = "lm", formula = y ~ x + I(x^2), size = 0.5) +
   labs(title="Financial", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 5)
```

<div style="margin-bottom:40px;">
</div>


### 4.4. Recreational risk-taking{.tabset}

#### Intercept only model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_r.int <- results_table_list$results_r.int
remove <- c("Intercept_Std.Error2")
results_r.int <- results_r.int[!(row.names(results_r.int) %in% remove),]
rownames(results_r.int)[rownames(results_r.int)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
results_r.int <- results_r.int[, colSums(is.na(results_r.int)) != nrow(results_r.int)]
results_r.int <- results_r.int[complete.cases(results_r.int), ]
results_r.int[c(1:3,5:8,11), ] <- purrr::modify_if(results_r.int[c(1:3,5:8,11), ], ~is.numeric(.), ~round(., 2))
results_r.int[c(9:10),] <- purrr::modify_if(results_r.int[c(9:10), ], ~is.numeric(.), ~round(., 0))
results_r.int[4,] <- p_judge(results_r.int[4,])

datatable(results_r.int, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_r.int)))))
```

<div style="margin-bottom:40px;">
</div>


#### Fixed effect model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_r.fixed <- results_table_list$results_r.fixed
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_r.fixed <- results_r.fixed[!(row.names(results_r.fixed) %in% remove),]
rownames(results_r.fixed)[rownames(results_r.fixed)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_r.fixed)[rownames(results_r.fixed)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_r.fixed <- results_r.fixed[, colSums(is.na(results_r.fixed)) != nrow(results_r.fixed)]
results_r.fixed <- results_r.fixed[complete.cases(results_r.fixed), ]

results_r.fixed[c(1:6,9:10,13), ] <- purrr::modify_if(results_r.fixed[c(1:6,9:10,13), ], ~is.numeric(.), ~round(., 2))
results_r.fixed[c(11:12), ] <- purrr::modify_if(results_r.fixed[c(11:12), ], ~is.numeric(.), ~round(., 0))

results_r.fixed[7,] <- p_judge(results_r.fixed[7,])
results_r.fixed[8,] <- p_judge(results_r.fixed[8,])

results_r.fixed <- results_r.fixed[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "N.group", "N.obs", "LL"),]

datatable(results_r.fixed, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_r.fixed)))))
```

<div style="margin-bottom:40px;">
</div>


#### Linear model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_r.lg <- results_table_list$results_r.lg
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_r.lg <- results_r.lg[!(row.names(results_r.lg) %in% remove),]
rownames(results_r.lg)[rownames(results_r.lg)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_r.lg)[rownames(results_r.lg)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_r.lg <- results_r.lg[, colSums(is.na(results_r.lg)) != nrow(results_r.lg)]
results_r.lg <- results_r.lg[complete.cases(results_r.lg), ]

results_r.lg[c(1:6,9:13,16), ] <- purrr::modify_if(results_r.lg[c(1:6,9:13,16), ], ~is.numeric(.), ~round(., 2))
results_r.lg[c(14:15), ] <- purrr::modify_if(results_r.lg[c(14:15), ], ~is.numeric(.), ~round(., 0))

results_r.lg[7,] <- p_judge(results_r.lg[7,])
results_r.lg[8,] <- p_judge(results_r.lg[8,])

results_r.lg <- results_r.lg[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_r.lg, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_r.lg)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 3.5}
#model data
model_data <- plot_model_data_list$plot_r.lg
#mean data
mean_data <- raw_mean_data_list$plot_r.lg %>%
  filter(Recreational_z_n >= 50)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Recreational_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x, size = 0.5) +
   labs(title="Recreational", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_r.lg.sex <- results_table_list$results_r.lg.sex
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "sex_Std.Error2")
results_r.lg.sex <- results_r.lg.sex[!(row.names(results_r.lg.sex) %in% remove),]
rownames(results_r.lg.sex)[rownames(results_r.lg.sex)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_r.lg.sex)[rownames(results_r.lg.sex)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_r.lg.sex)[rownames(results_r.lg.sex)=="sex_Std.Error1"] <- "sex_Std.Error"
results_r.lg.sex <- results_r.lg.sex[, colSums(is.na(results_r.lg.sex)) != nrow(results_r.lg.sex)]
results_r.lg.sex <- results_r.lg.sex[complete.cases(results_r.lg.sex), ]

results_r.lg.sex[c(1:9,13:17,20), ] <- purrr::modify_if(results_r.lg.sex[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_r.lg.sex[c(18:19), ] <- purrr::modify_if(results_r.lg.sex[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_r.lg.sex[10,] <- p_judge(results_r.lg.sex[10,])
results_r.lg.sex[11,] <- p_judge(results_r.lg.sex[11,])
results_r.lg.sex[12,] <- p_judge(results_r.lg.sex[12,])

results_r.lg.sex <- results_r.lg.sex[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "sex_Estimate","sex_Std.Error", "sex_t.value", "sex_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_r.lg.sex, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_r.lg.sex)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 3.5}
#model data
model_data <- plot_model_data_list$plot_r.lg.sex
#mean data
mean_data <- raw_mean_data_list$plot_r.lg.sex %>%
  filter(Recreational_z_n >= 50)

model_data[,"sex"] <- ifelse(model_data$sex == 1, "female", "male")
mean_data[,"sex"] <- ifelse(mean_data$sex == 1, "female", "male")

ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Recreational_z_mean, group=sex, colour=Panel, pch=sex), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=sex, colour=Panel, linetype = sex), method = "lm", formula = y ~ x, size = 0.5) +
   labs(title="Recreational", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender interaction model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_r.lg.inter <- results_table_list$results_r.lg.inter
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "sex_Std.Error2", "d_c_age:sex_Std.Error2")
results_r.lg.inter <- results_r.lg.inter[!(row.names(results_r.lg.inter) %in% remove),]
rownames(results_r.lg.inter)[rownames(results_r.lg.inter)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_r.lg.inter)[rownames(results_r.lg.inter)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_r.lg.inter)[rownames(results_r.lg.inter)=="sex_Std.Error1"] <- "sex_Std.Error"
rownames(results_r.lg.inter)[rownames(results_r.lg.inter)=="d_c_age:sex_Std.Error1"] <- "d_c_age:sex_Std.Error"
results_r.lg.inter <- results_r.lg.inter[, colSums(is.na(results_r.lg.inter)) != nrow(results_r.lg.inter)]
results_r.lg.inter <- results_r.lg.inter[complete.cases(results_r.lg.inter), ]

results_r.lg.inter[c(1:12,17:21,24), ] <- purrr::modify_if(results_r.lg.inter[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_r.lg.inter[c(22:23), ] <- purrr::modify_if(results_r.lg.inter[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_r.lg.inter[13,] <- p_judge(results_r.lg.inter[13,])
results_r.lg.inter[14,] <- p_judge(results_r.lg.inter[14,])
results_r.lg.inter[15,] <- p_judge(results_r.lg.inter[15,])
results_r.lg.inter[16,] <- p_judge(results_r.lg.inter[16,])

results_r.lg.inter <- results_r.lg.inter[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "sex_Estimate", "sex_Std.Error", "sex_t.value", "sex_p.value", "d_c_age:sex_Estimate", "d_c_age:sex_Std.Error", "d_c_age:sex_t.value", "d_c_age:sex_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_r.lg.inter, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_r.lg.inter)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 3.5}
#model data
model_data <- plot_model_data_list$plot_r.lg.inter
#mean data
mean_data <- raw_mean_data_list$plot_r.lg.inter %>%
  filter(Recreational_z_n >= 50)

model_data[,"sex"] <- ifelse(model_data$sex == 1, "female", "male")
mean_data[,"sex"] <- ifelse(mean_data$sex == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Recreational_z_mean, group=sex, colour=Panel, pch=sex), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=sex, colour=Panel, linetype = sex), method = "lm", formula = y ~ x, size = 0.5) +
   labs(title="Recreational", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


### 4.5. Occupational risk-taking{.tabset}

#### Intercept only model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_o.int <- results_table_list$results_o.int
remove <- c("Intercept_Std.Error2")
results_o.int <- results_o.int[!(row.names(results_o.int) %in% remove),]
rownames(results_o.int)[rownames(results_o.int)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
results_o.int <- results_o.int[, colSums(is.na(results_o.int)) != nrow(results_o.int)]
results_o.int <- results_o.int[complete.cases(results_o.int), ]
results_o.int[c(1:3,5:8,11), ] <- purrr::modify_if(results_o.int[c(1:3,5:8,11), ], ~is.numeric(.), ~round(., 2))
results_o.int[c(9:10),] <- purrr::modify_if(results_o.int[c(9:10), ], ~is.numeric(.), ~round(., 0))
results_o.int[4,] <- p_judge(results_o.int[4,])

datatable(results_o.int, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_o.int)))))
```

<div style="margin-bottom:40px;">
</div>


#### Fixed effect model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_o.fixed <- results_table_list$results_o.fixed
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_o.fixed <- results_o.fixed[!(row.names(results_o.fixed) %in% remove),]
rownames(results_o.fixed)[rownames(results_o.fixed)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_o.fixed)[rownames(results_o.fixed)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_o.fixed <- results_o.fixed[, colSums(is.na(results_o.fixed)) != nrow(results_o.fixed)]
results_o.fixed <- results_o.fixed[complete.cases(results_o.fixed), ]

results_o.fixed[c(1:6,9:10,13), ] <- purrr::modify_if(results_o.fixed[c(1:6,9:10,13), ], ~is.numeric(.), ~round(., 2))
results_o.fixed[c(11:12), ] <- purrr::modify_if(results_o.fixed[c(11:12), ], ~is.numeric(.), ~round(., 0))

results_o.fixed[7,] <- p_judge(results_o.fixed[7,])
results_o.fixed[8,] <- p_judge(results_o.fixed[8,])

results_o.fixed <- results_o.fixed[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "N.group", "N.obs", "LL"),]

datatable(results_o.fixed, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_o.fixed)))))
```

<div style="margin-bottom:40px;">
</div>


#### Linear model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_o.lg <- results_table_list$results_o.lg
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_o.lg <- results_o.lg[!(row.names(results_o.lg) %in% remove),]
rownames(results_o.lg)[rownames(results_o.lg)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_o.lg)[rownames(results_o.lg)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_o.lg <- results_o.lg[, colSums(is.na(results_o.lg)) != nrow(results_o.lg)]
results_o.lg <- results_o.lg[complete.cases(results_o.lg), ]

results_o.lg[c(1:6,9:13,16), ] <- purrr::modify_if(results_o.lg[c(1:6,9:13,16), ], ~is.numeric(.), ~round(., 2))
results_o.lg[c(14:15), ] <- purrr::modify_if(results_o.lg[c(14:15), ], ~is.numeric(.), ~round(., 0))

results_o.lg[7,] <- p_judge(results_o.lg[7,])
results_o.lg[8,] <- p_judge(results_o.lg[8,])

results_o.lg <- results_o.lg[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_o.lg, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_o.lg)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 3.5}
#model data
model_data <- plot_model_data_list$plot_o.lg
#mean data
mean_data <- raw_mean_data_list$plot_o.lg %>%
  filter(Occupational_z_n >= 50)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Occupational_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x, size = 0.5) +
   labs(title="Occupational", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_o.lg.sex <- results_table_list$results_o.lg.sex
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "sex_Std.Error2")
results_o.lg.sex <- results_o.lg.sex[!(row.names(results_o.lg.sex) %in% remove),]
rownames(results_o.lg.sex)[rownames(results_o.lg.sex)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_o.lg.sex)[rownames(results_o.lg.sex)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_o.lg.sex)[rownames(results_o.lg.sex)=="sex_Std.Error1"] <- "sex_Std.Error"
results_o.lg.sex <- results_o.lg.sex[, colSums(is.na(results_o.lg.sex)) != nrow(results_o.lg.sex)]
results_o.lg.sex <- results_o.lg.sex[complete.cases(results_o.lg.sex), ]

results_o.lg.sex[c(1:9,13:17,20), ] <- purrr::modify_if(results_o.lg.sex[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_o.lg.sex[c(18:19), ] <- purrr::modify_if(results_o.lg.sex[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_o.lg.sex[10,] <- p_judge(results_o.lg.sex[10,])
results_o.lg.sex[11,] <- p_judge(results_o.lg.sex[11,])
results_o.lg.sex[12,] <- p_judge(results_o.lg.sex[12,])

results_o.lg.sex <- results_o.lg.sex[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "sex_Estimate","sex_Std.Error", "sex_t.value", "sex_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_o.lg.sex, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_o.lg.sex)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 3.5}
#model data
model_data <- plot_model_data_list$plot_o.lg.sex
#mean data
mean_data <- raw_mean_data_list$plot_o.lg.sex %>%
  filter(Occupational_z_n >= 50)

model_data[,"sex"] <- ifelse(model_data$sex == 1, "female", "male")
mean_data[,"sex"] <- ifelse(mean_data$sex == 1, "female", "male")

ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Occupational_z_mean, group=sex, colour=Panel, pch=sex), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=sex, colour=Panel, linetype = sex), method = "lm", formula = y ~ x, size = 0.5) +
   labs(title="Occupational", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender interaction model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_o.lg.inter <- results_table_list$results_o.lg.inter
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "sex_Std.Error2", "d_c_age:sex_Std.Error2")
results_o.lg.inter <- results_o.lg.inter[!(row.names(results_o.lg.inter) %in% remove),]
rownames(results_o.lg.inter)[rownames(results_o.lg.inter)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_o.lg.inter)[rownames(results_o.lg.inter)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_o.lg.inter)[rownames(results_o.lg.inter)=="sex_Std.Error1"] <- "sex_Std.Error"
rownames(results_o.lg.inter)[rownames(results_o.lg.inter)=="d_c_age:sex_Std.Error1"] <- "d_c_age:sex_Std.Error"
results_o.lg.inter <- results_o.lg.inter[, colSums(is.na(results_o.lg.inter)) != nrow(results_o.lg.inter)]
results_o.lg.inter <- results_o.lg.inter[complete.cases(results_o.lg.inter), ]

results_o.lg.inter[c(1:12,17:21,24), ] <- purrr::modify_if(results_o.lg.inter[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_o.lg.inter[c(22:23), ] <- purrr::modify_if(results_o.lg.inter[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_o.lg.inter[13,] <- p_judge(results_o.lg.inter[13,])
results_o.lg.inter[14,] <- p_judge(results_o.lg.inter[14,])
results_o.lg.inter[15,] <- p_judge(results_o.lg.inter[15,])
results_o.lg.inter[16,] <- p_judge(results_o.lg.inter[16,])

results_o.lg.inter <- results_o.lg.inter[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "sex_Estimate", "sex_Std.Error", "sex_t.value", "sex_p.value", "d_c_age:sex_Estimate", "d_c_age:sex_Std.Error", "d_c_age:sex_t.value", "d_c_age:sex_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_o.lg.inter, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_o.lg.inter)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 3.5}
#model data
model_data <- plot_model_data_list$plot_o.lg.inter
#mean data
mean_data <- raw_mean_data_list$plot_o.lg.inter %>%
  filter(Occupational_z_n >= 50)

model_data[,"sex"] <- ifelse(model_data$sex == 1, "female", "male")
mean_data[,"sex"] <- ifelse(mean_data$sex == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Occupational_z_mean, group=sex, colour=Panel, pch=sex), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=sex, colour=Panel, linetype = sex), method = "lm", formula = y ~ x, size = 0.5) +
   labs(title="Occupational", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


### 4.6. Health risk-taking{.tabset}

#### Intercept only model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_h.int <- results_table_list$results_h.int
remove <- c("Intercept_Std.Error2")
results_h.int <- results_h.int[!(row.names(results_h.int) %in% remove),]
rownames(results_h.int)[rownames(results_h.int)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
results_h.int <- results_h.int[, colSums(is.na(results_h.int)) != nrow(results_h.int)]
results_h.int <- results_h.int[complete.cases(results_h.int), ]
results_h.int[c(1:3,5:8,11), ] <- purrr::modify_if(results_h.int[c(1:3,5:8,11), ], ~is.numeric(.), ~round(., 2))
results_h.int[c(9:10),] <- purrr::modify_if(results_h.int[c(9:10), ], ~is.numeric(.), ~round(., 0))
results_h.int[4,] <- p_judge(results_h.int[4,])

datatable(results_h.int, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_h.int)))))
```

<div style="margin-bottom:40px;">
</div>


#### Fixed effect model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_h.fixed <- results_table_list$results_h.fixed
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_h.fixed <- results_h.fixed[!(row.names(results_h.fixed) %in% remove),]
rownames(results_h.fixed)[rownames(results_h.fixed)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_h.fixed)[rownames(results_h.fixed)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_h.fixed <- results_h.fixed[, colSums(is.na(results_h.fixed)) != nrow(results_h.fixed)]
results_h.fixed <- results_h.fixed[complete.cases(results_h.fixed), ]

results_h.fixed[c(1:6,9:10,13), ] <- purrr::modify_if(results_h.fixed[c(1:6,9:10,13), ], ~is.numeric(.), ~round(., 2))
results_h.fixed[c(11:12), ] <- purrr::modify_if(results_h.fixed[c(11:12), ], ~is.numeric(.), ~round(., 0))

results_h.fixed[7,] <- p_judge(results_h.fixed[7,])
results_h.fixed[8,] <- p_judge(results_h.fixed[8,])

results_h.fixed <- results_h.fixed[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "N.group", "N.obs", "LL"),]

datatable(results_h.fixed, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_h.fixed)))))
```

<div style="margin-bottom:40px;">
</div>


#### Linear model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_h.lg <- results_table_list$results_h.lg
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2")
results_h.lg <- results_h.lg[!(row.names(results_h.lg) %in% remove),]
rownames(results_h.lg)[rownames(results_h.lg)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_h.lg)[rownames(results_h.lg)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
results_h.lg <- results_h.lg[, colSums(is.na(results_h.lg)) != nrow(results_h.lg)]
results_h.lg <- results_h.lg[complete.cases(results_h.lg), ]

results_h.lg[c(1:6,9:13,16), ] <- purrr::modify_if(results_h.lg[c(1:6,9:13,16), ], ~is.numeric(.), ~round(., 2))
results_h.lg[c(14:15), ] <- purrr::modify_if(results_h.lg[c(14:15), ], ~is.numeric(.), ~round(., 0))

results_h.lg[7,] <- p_judge(results_h.lg[7,])
results_h.lg[8,] <- p_judge(results_h.lg[8,])

results_h.lg <- results_h.lg[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_h.lg, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_h.lg)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 3.5}
#model data
model_data <- plot_model_data_list$plot_h.lg
#mean data
mean_data <- raw_mean_data_list$plot_h.lg %>%
  filter(Health_z_n >= 50)

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Health_z_mean, group=Panel, colour=Panel, pch=Panel),size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   scale_shape_manual(values = rep(c(0:25), times=2), drop=FALSE, limits = levels(colordata$Panel)) + 
   stat_smooth(data = model_data, aes(x = age, y = fit, group=Panel, colour=Panel), method = "lm", formula = y ~ x, size = 0.5) +
   labs(title="Health", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_h.lg.sex <- results_table_list$results_h.lg.sex
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "sex_Std.Error2")
results_h.lg.sex <- results_h.lg.sex[!(row.names(results_h.lg.sex) %in% remove),]
rownames(results_h.lg.sex)[rownames(results_h.lg.sex)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_h.lg.sex)[rownames(results_h.lg.sex)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_h.lg.sex)[rownames(results_h.lg.sex)=="sex_Std.Error1"] <- "sex_Std.Error"
results_h.lg.sex <- results_h.lg.sex[, colSums(is.na(results_h.lg.sex)) != nrow(results_h.lg.sex)]
results_h.lg.sex <- results_h.lg.sex[complete.cases(results_h.lg.sex), ]

results_h.lg.sex[c(1:9,13:17,20), ] <- purrr::modify_if(results_h.lg.sex[c(1:9,13:17,20), ], ~is.numeric(.), ~round(., 2))
results_h.lg.sex[c(18:19), ] <- purrr::modify_if(results_h.lg.sex[c(18:19), ], ~is.numeric(.), ~round(., 0))

results_h.lg.sex[10,] <- p_judge(results_h.lg.sex[10,])
results_h.lg.sex[11,] <- p_judge(results_h.lg.sex[11,])
results_h.lg.sex[12,] <- p_judge(results_h.lg.sex[12,])

results_h.lg.sex <- results_h.lg.sex[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "sex_Estimate","sex_Std.Error", "sex_t.value", "sex_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_h.lg.sex, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_h.lg.sex)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 3.5}
#model data
model_data <- plot_model_data_list$plot_h.lg.sex
#mean data
mean_data <- raw_mean_data_list$plot_h.lg.sex %>%
  filter(Health_z_n >= 50)

model_data[,"sex"] <- ifelse(model_data$sex == 1, "female", "male")
mean_data[,"sex"] <- ifelse(mean_data$sex == 1, "female", "male")

ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Health_z_mean, group=sex, colour=Panel, pch=sex), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=sex, colour=Panel, linetype = sex), method = "lm", formula = y ~ x, size = 0.5) +
   labs(title="Health", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>


#### Linear with gender interaction model

##### **Models results**
```{r, echo = F, warning = FALSE, message = FALSE}
results_h.lg.inter <- results_table_list$results_h.lg.inter
remove <- c("Intercept_Std.Error2", "d_c_age_Std.Error2", "sex_Std.Error2", "d_c_age:sex_Std.Error2")
results_h.lg.inter <- results_h.lg.inter[!(row.names(results_h.lg.inter) %in% remove),]
rownames(results_h.lg.inter)[rownames(results_h.lg.inter)=="Intercept_Std.Error1"] <- "Intercept_Std.Error"
rownames(results_h.lg.inter)[rownames(results_h.lg.inter)=="d_c_age_Std.Error1"] <- "d_c_age_Std.Error"
rownames(results_h.lg.inter)[rownames(results_h.lg.inter)=="sex_Std.Error1"] <- "sex_Std.Error"
rownames(results_h.lg.inter)[rownames(results_h.lg.inter)=="d_c_age:sex_Std.Error1"] <- "d_c_age:sex_Std.Error"
results_h.lg.inter <- results_h.lg.inter[, colSums(is.na(results_h.lg.inter)) != nrow(results_h.lg.inter)]
results_h.lg.inter <- results_h.lg.inter[complete.cases(results_h.lg.inter), ]

results_h.lg.inter[c(1:12,17:21,24), ] <- purrr::modify_if(results_h.lg.inter[c(1:12,17:21,24), ], ~is.numeric(.), ~round(., 2))
results_h.lg.inter[c(22:23), ] <- purrr::modify_if(results_h.lg.inter[c(22:23), ], ~is.numeric(.), ~round(., 0))

results_h.lg.inter[13,] <- p_judge(results_h.lg.inter[13,])
results_h.lg.inter[14,] <- p_judge(results_h.lg.inter[14,])
results_h.lg.inter[15,] <- p_judge(results_h.lg.inter[15,])
results_h.lg.inter[16,] <- p_judge(results_h.lg.inter[16,])

results_h.lg.inter <- results_h.lg.inter[c("Intercept_Estimate", "Intercept_Std.Error", "Intercept_t.value", "Intercept_p.value", "d_c_age_Estimate", "d_c_age_Std.Error", "d_c_age_t.value", "d_c_age_p.value", "sex_Estimate", "sex_Std.Error", "sex_t.value", "sex_p.value", "d_c_age:sex_Estimate", "d_c_age:sex_Std.Error", "d_c_age:sex_t.value", "d_c_age:sex_p.value", "Within-group-variance", "Between-group-variance", "Random-slope-variance", "Slope-Intercept-covariance", "Slope-Intercept-correlation", "N.group", "N.obs", "LL"),]

datatable(results_h.lg.inter, options = list(columnDefs = list(list(className = 'dt-center', targets = 1:ncol(results_h.lg.inter)))))
```

<div style="margin-bottom:20px;">
</div>


##### **Plot**
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 9, fig.height = 3.5}
#model data
model_data <- plot_model_data_list$plot_h.lg.inter
#mean data
mean_data <- raw_mean_data_list$plot_h.lg.inter %>%
  filter(Health_z_n >= 50)

model_data[,"sex"] <- ifelse(model_data$sex == 1, "female", "male")
mean_data[,"sex"] <- ifelse(mean_data$sex == 1, "female", "male")

 ggplot() + 
   geom_point(data = mean_data, aes(x = win_mid, y = Health_z_mean, group=sex, colour=Panel, pch=sex), size = 1, alpha = 0.5) +
   scale_colour_discrete(drop=FALSE,limits = levels(colordata$Panel)) +
   stat_smooth(data = model_data, aes(x = age, y = fit,  group=sex, colour=Panel, linetype = sex), method = "lm", formula = y ~ x, size = 0.5) +
   labs(title="Health", x= "Age", y= "Risk propensity") +
   #scale_x_continuous(breaks = c(10, 25, 40, 55, 70, 85, 100))+
   coord_cartesian(xlim = c(0,120), ylim = c(-1.5,1.5))+
   theme_bw() +
   theme(legend.position = "none") +
   theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
   theme(panel.border = element_rect(colour = "black", fill=NA)) +
   facet_wrap(~ Panel, nrow = 1)
```

<div style="margin-bottom:40px;">
</div>



### 4.7. Social risk-taking{.tabset}

<div style="margin-bottom:40px;">
</div>
 
 

## 5. Meta-analysis results

### 5.1. General risk-taking{.tabset}

#### Intercept only model

##### **Meta analysis**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list <- readRDS(file = "meta_results_list.Rds")
meta_g.int <- meta_results_list$meta_g.int
meta_g.int_icc <- meta_g.int$icc
summary(meta_g.int_icc)
```

<div style="margin-bottom:40px;">
</div>


##### **Meta analysis with continent**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list_continent <- readRDS(file = "meta_results_list_continent.Rds")
meta_g.int_continent <- meta_results_list_continent$meta_g.int
meta_g.int_continent_icc <- meta_g.int_continent$icc
summary(meta_g.int_continent_icc)
```

<div style="margin-bottom:40px;">
</div>


##### **Meta analysis with mean age**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list_mean.age <- readRDS(file = "meta_results_list_mean.age.Rds")
meta_g.int_mean.age <- meta_results_list_mean.age$meta_g.int
meta_g.int_mean.age_icc <- meta_g.int_mean.age$icc
summary(meta_g.int_mean.age_icc)
```

<div style="margin-bottom:40px;">
</div>


##### **Meta analysis with scale**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list_scale <- readRDS(file = "meta_results_list_scale.Rds")
meta_g.int_scale <- meta_results_list_scale$meta_g.int
meta_g.int_scale_icc <- meta_g.int_scale$icc
summary(meta_g.int_scale_icc)
```

<div style="margin-bottom:40px;">
</div>



#### Fixed effect model

##### **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.fixed <- meta_results_list$meta_g.fixed
meta_g.fixed_age <- meta_g.fixed$age
summary(meta_g.fixed_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.fixed_continent <- meta_results_list_continent$meta_g.fixed
meta_g.fixed_continent_age <- meta_g.fixed_continent$age
summary(meta_g.fixed_continent_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.fixed_mean.age <- meta_results_list_mean.age$meta_g.fixed
meta_g.fixed_mean.age_age <- meta_g.fixed_mean.age$age
summary(meta_g.fixed_mean.age_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.fixed_scale <- meta_results_list_scale$meta_g.fixed
meta_g.fixed_scale_age <- meta_g.fixed_scale$age
summary(meta_g.fixed_scale_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg <- meta_results_list$meta_g.lg
meta_g.lg_age <- meta_g.lg$age
summary(meta_g.lg_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg_continent <- meta_results_list_continent$meta_g.lg
meta_g.lg_continent_age <- meta_g.lg_continent$age
summary(meta_g.lg_continent_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg_mean.age <- meta_results_list_mean.age$meta_g.lg
meta_g.lg_mean.age_age <- meta_g.lg_mean.age$age
summary(meta_g.lg_mean.age_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg_scale <- meta_results_list_scale$meta_g.lg
meta_g.lg_scale_age <- meta_g.lg_scale$age
summary(meta_g.lg_scale_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.sex <- meta_results_list$meta_g.lg.sex
meta_g.lg.sex_age <- meta_g.lg.sex$age
summary(meta_g.lg.sex_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.sex <- meta_results_list$meta_g.lg.sex
meta_g.lg.sex_sex <- meta_g.lg.sex$sex
summary(meta_g.lg.sex_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.sex_continent <- meta_results_list_continent$meta_g.lg.sex
meta_g.lg.sex_continent_age <- meta_g.lg.sex_continent$age
summary(meta_g.lg.sex_continent_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.sex_continent <- meta_results_list_continent$meta_g.lg.sex
meta_g.lg.sex_continent_sex <- meta_g.lg.sex_continent$sex
summary(meta_g.lg.sex_continent_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.sex_mean.age <- meta_results_list_mean.age$meta_g.lg.sex
meta_g.lg.sex_mean.age_age <- meta_g.lg.sex_mean.age$age
summary(meta_g.lg.sex_mean.age_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.sex_mean.age <- meta_results_list_mean.age$meta_g.lg.sex
meta_g.lg.sex_mean.age_sex <- meta_g.lg.sex_mean.age$sex
summary(meta_g.lg.sex_mean.age_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.sex_scale <- meta_results_list_scale$meta_g.lg.sex
meta_g.lg.sex_scale_age <- meta_g.lg.sex_scale$age
summary(meta_g.lg.sex_scale_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.sex_scale <- meta_results_list_scale$meta_g.lg.sex
meta_g.lg.sex_scale_sex <- meta_g.lg.sex_scale$sex
summary(meta_g.lg.sex_scale_sex)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender interaction model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.inter <- meta_results_list$meta_g.lg.inter
meta_g.lg.inter_age <- meta_g.lg.inter$age
summary(meta_g.lg.inter_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.inter <- meta_results_list$meta_g.lg.inter
meta_g.lg.inter_sex <- meta_g.lg.inter$sex
summary(meta_g.lg.inter_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.inter <- meta_results_list$meta_g.lg.inter
meta_g.lg.inter_age_sex <- meta_g.lg.inter$age_sex
summary(meta_g.lg.inter_age_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.inter_continent <- meta_results_list_continent$meta_g.lg.inter
meta_g.lg.inter_continent_age <- meta_g.lg.inter_continent$age
summary(meta_g.lg.inter_continent_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.inter_continent <- meta_results_list_continent$meta_g.lg.inter
meta_g.lg.inter_continent_sex <- meta_g.lg.inter_continent$sex
summary(meta_g.lg.inter_continent_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.inter_continent <- meta_results_list_continent$meta_g.lg.inter
meta_g.lg.inter_continent_age_sex <- meta_g.lg.inter_continent$age_sex
meta_g.lg.inter_continent_age_sex
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.inter_mean.age <- meta_results_list_mean.age$meta_g.lg.inter
meta_g.lg.inter_mean.age_age <- meta_g.lg.inter_mean.age$age
summary(meta_g.lg.inter_mean.age_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.inter_mean.age <- meta_results_list_mean.age$meta_g.lg.inter
meta_g.lg.inter_mean.age_sex <- meta_g.lg.inter_mean.age$sex
summary(meta_g.lg.inter_mean.age_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.inter_mean.age <- meta_results_list_mean.age$meta_g.lg.inter
meta_g.lg.inter_mean.age_age_sex <- meta_g.lg.inter_mean.age$age_sex
meta_g.lg.inter_mean.age_age_sex
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.inter_scale <- meta_results_list_scale$meta_g.lg.inter
meta_g.lg.inter_scale_age <- meta_g.lg.inter_scale$age
summary(meta_g.lg.inter_scale_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.inter_scale <- meta_results_list_scale$meta_g.lg.inter
meta_g.lg.inter_scale_sex <- meta_g.lg.inter_scale$sex
summary(meta_g.lg.inter_scale_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.lg.inter_scale <- meta_results_list_scale$meta_g.lg.inter
meta_g.lg.inter_scale_age_sex <- meta_g.lg.inter_scale$age_sex
summary(meta_g.lg.inter_scale_age_sex)
```

<div style="margin-bottom:40px;">
</div>



#### Quadratic model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad <- meta_results_list$meta_g.quad
meta_g.quad_age <- meta_g.quad$age
summary(meta_g.quad_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Age${ }^{2}$ effect**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad <- meta_results_list$meta_g.quad
meta_g.quad_age2 <- meta_g.quad$age2
summary(meta_g.quad_age2)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad_continent <- meta_results_list_continent$meta_g.quad
meta_g.quad_continent_age <- meta_g.quad_continent$age
summary(meta_g.quad_continent_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Age${ }^{2}$ effect**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad_continent <- meta_results_list_continent$meta_g.quad
meta_g.quad_continent_age2 <- meta_g.quad_continent$age2
summary(meta_g.quad_continent_age2)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad_mean.age <- meta_results_list_mean.age$meta_g.quad
meta_g.quad_mean.age_age <- meta_g.quad_mean.age$age
summary(meta_g.quad_mean.age_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Age${ }^{2}$ effect**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad_mean.age <- meta_results_list_mean.age$meta_g.quad
meta_g.quad_mean.age_age2 <- meta_g.quad_mean.age$age2
summary(meta_g.quad_mean.age_age2)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad_scale <- meta_results_list_scale$meta_g.quad
meta_g.quad_scale_age <- meta_g.quad_scale$age
summary(meta_g.quad_scale_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Age${ }^{2}$ effect**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad_scale <- meta_results_list_scale$meta_g.quad
meta_g.quad_scale_age2 <- meta_g.quad_scale$age2
summary(meta_g.quad_scale_age2)
```

<div style="margin-bottom:40px;">
</div>



#### Quadratic with gender model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad.sex <- meta_results_list$meta_g.quad.sex
meta_g.quad.sex_age <- meta_g.quad.sex$age
summary(meta_g.quad.sex_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Age${ }^{2}$ effect**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad.sex <- meta_results_list$meta_g.quad.sex
meta_g.quad.sex_age2 <- meta_g.quad.sex$age2
summary(meta_g.quad.sex_age2)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad.sex <- meta_results_list$meta_g.quad.sex
meta_g.quad.sex_sex <- meta_g.quad.sex$sex
summary(meta_g.quad.sex_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad.sex_continent <- meta_results_list_continent$meta_g.quad.sex
meta_g.quad.sex_continent_age <- meta_g.quad.sex_continent$age
summary(meta_g.quad.sex_continent_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Age${ }^{2}$ effect**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad.sex_continent <- meta_results_list_continent$meta_g.quad.sex
meta_g.quad.sex_continent_age2 <- meta_g.quad.sex_continent$age2
summary(meta_g.quad.sex_continent_age2)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad.sex_continent <- meta_results_list_continent$meta_g.quad.sex
meta_g.quad.sex_continent_sex <- meta_g.quad.sex_continent$sex
summary(meta_g.quad.sex_continent_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad.sex_mean.age <- meta_results_list_mean.age$meta_g.quad.sex
meta_g.quad.sex_mean.age_age <- meta_g.quad.sex_mean.age$age
summary(meta_g.quad.sex_mean.age_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Age${ }^{2}$ effect**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad.sex_mean.age <- meta_results_list_mean.age$meta_g.quad.sex
meta_g.quad.sex_mean.age_age2 <- meta_g.quad.sex_mean.age$age2
summary(meta_g.quad.sex_mean.age_age2)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad.sex_mean.age <- meta_results_list_mean.age$meta_g.quad.sex
meta_g.quad.sex_mean.age_sex <- meta_g.quad.sex_mean.age$sex
summary(meta_g.quad.sex_mean.age_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad.sex_scale <- meta_results_list_scale$meta_g.quad.sex
meta_g.quad.sex_scale_age <- meta_g.quad.sex_scale$age
summary(meta_g.quad.sex_scale_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Age${ }^{2}$ effect**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad.sex_scale <- meta_results_list_scale$meta_g.quad.sex
meta_g.quad.sex_scale_age2 <- meta_g.quad.sex_scale$age2
summary(meta_g.quad.sex_scale_age2)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_g.quad.sex_scale <- meta_results_list_scale$meta_g.quad.sex
meta_g.quad.sex_scale_sex <- meta_g.quad.sex_scale$sex
summary(meta_g.quad.sex_scale_sex)
```

<div style="margin-bottom:40px;">
</div>



### 5.2. Driving risk-taking{.tabset}

#### Intercept only model

##### **Meta analysis**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list <- readRDS(file = "meta_results_list.Rds")
meta_d.int <- meta_results_list$meta_d.int
meta_d.int_icc <- meta_d.int$icc
summary(meta_d.int_icc)
```

<div style="margin-bottom:40px;">
</div>


##### **Meta analysis with continent**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list_continent <- readRDS(file = "meta_results_list_continent.Rds")
meta_d.int_continent <- meta_results_list_continent$meta_d.int
meta_d.int_continent_icc <- meta_d.int_continent$icc
summary(meta_d.int_continent_icc)
```

<div style="margin-bottom:40px;">
</div>


##### **Meta analysis with mean age**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list_mean.age <- readRDS(file = "meta_results_list_mean.age.Rds")
meta_d.int_mean.age <- meta_results_list_mean.age$meta_d.int
meta_d.int_mean.age_icc <- meta_d.int_mean.age$icc
summary(meta_d.int_mean.age_icc)
```

<div style="margin-bottom:40px;">
</div>


##### **Meta analysis with scale**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list_scale <- readRDS(file = "meta_results_list_scale.Rds")
meta_d.int_scale <- meta_results_list_scale$meta_d.int
meta_d.int_scale_icc <- meta_d.int_scale$icc
summary(meta_d.int_scale_icc)
```

<div style="margin-bottom:40px;">
</div>



#### Fixed effect model

##### **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.fixed <- meta_results_list$meta_d.fixed
meta_d.fixed_age <- meta_d.fixed$age
summary(meta_d.fixed_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.fixed_continent <- meta_results_list_continent$meta_d.fixed
meta_d.fixed_continent_age <- meta_d.fixed_continent$age
summary(meta_d.fixed_continent_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.fixed_mean.age <- meta_results_list_mean.age$meta_d.fixed
meta_d.fixed_mean.age_age <- meta_d.fixed_mean.age$age
summary(meta_d.fixed_mean.age_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.fixed_scale <- meta_results_list_scale$meta_d.fixed
meta_d.fixed_scale_age <- meta_d.fixed_scale$age
summary(meta_d.fixed_scale_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg <- meta_results_list$meta_d.lg
meta_d.lg_age <- meta_d.lg$age
summary(meta_d.lg_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg_continent <- meta_results_list_continent$meta_d.lg
meta_d.lg_continent_age <- meta_d.lg_continent$age
summary(meta_d.lg_continent_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg_mean.age <- meta_results_list_mean.age$meta_d.lg
meta_d.lg_mean.age_age <- meta_d.lg_mean.age$age
summary(meta_d.lg_mean.age_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg_scale <- meta_results_list_scale$meta_d.lg
meta_d.lg_scale_age <- meta_d.lg_scale$age
summary(meta_d.lg_scale_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.sex <- meta_results_list$meta_d.lg.sex
meta_d.lg.sex_age <- meta_d.lg.sex$age
summary(meta_d.lg.sex_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.sex <- meta_results_list$meta_d.lg.sex
meta_d.lg.sex_sex <- meta_d.lg.sex$sex
summary(meta_d.lg.sex_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.sex_continent <- meta_results_list_continent$meta_d.lg.sex
meta_d.lg.sex_continent_age <- meta_d.lg.sex_continent$age
summary(meta_d.lg.sex_continent_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.sex_continent <- meta_results_list_continent$meta_d.lg.sex
meta_d.lg.sex_continent_sex <- meta_d.lg.sex_continent$sex
summary(meta_d.lg.sex_continent_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.sex_mean.age <- meta_results_list_mean.age$meta_d.lg.sex
meta_d.lg.sex_mean.age_age <- meta_d.lg.sex_mean.age$age
summary(meta_d.lg.sex_mean.age_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.sex_mean.age <- meta_results_list_mean.age$meta_d.lg.sex
meta_d.lg.sex_mean.age_sex <- meta_d.lg.sex_mean.age$sex
summary(meta_d.lg.sex_mean.age_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.sex_scale <- meta_results_list_scale$meta_d.lg.sex
meta_d.lg.sex_scale_age <- meta_d.lg.sex_scale$age
summary(meta_d.lg.sex_scale_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.sex_scale <- meta_results_list_scale$meta_d.lg.sex
meta_d.lg.sex_scale_sex <- meta_d.lg.sex_scale$sex
summary(meta_d.lg.sex_scale_sex)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender interaction model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.inter <- meta_results_list$meta_d.lg.inter
meta_d.lg.inter_age <- meta_d.lg.inter$age
summary(meta_d.lg.inter_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.inter <- meta_results_list$meta_d.lg.inter
meta_d.lg.inter_sex <- meta_d.lg.inter$sex
summary(meta_d.lg.inter_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.inter <- meta_results_list$meta_d.lg.inter
meta_d.lg.inter_age_sex <- meta_d.lg.inter$age_sex
summary(meta_d.lg.inter_age_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.inter_continent <- meta_results_list_continent$meta_d.lg.inter
meta_d.lg.inter_continent_age <- meta_d.lg.inter_continent$age
summary(meta_d.lg.inter_continent_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.inter_continent <- meta_results_list_continent$meta_d.lg.inter
meta_d.lg.inter_continent_sex <- meta_d.lg.inter_continent$sex
summary(meta_d.lg.inter_continent_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.inter_continent <- meta_results_list_continent$meta_d.lg.inter
meta_d.lg.inter_continent_age_sex <- meta_d.lg.inter_continent$age_sex
meta_d.lg.inter_continent_age_sex
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.inter_mean.age <- meta_results_list_mean.age$meta_d.lg.inter
meta_d.lg.inter_mean.age_age <- meta_d.lg.inter_mean.age$age
summary(meta_d.lg.inter_mean.age_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.inter_mean.age <- meta_results_list_mean.age$meta_d.lg.inter
meta_d.lg.inter_mean.age_sex <- meta_d.lg.inter_mean.age$sex
summary(meta_d.lg.inter_mean.age_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.inter_mean.age <- meta_results_list_mean.age$meta_d.lg.inter
meta_d.lg.inter_mean.age_age_sex <- meta_d.lg.inter_mean.age$age_sex
meta_d.lg.inter_mean.age_age_sex
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.inter_scale <- meta_results_list_scale$meta_d.lg.inter
meta_d.lg.inter_scale_age <- meta_d.lg.inter_scale$age
summary(meta_d.lg.inter_scale_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.inter_scale <- meta_results_list_scale$meta_d.lg.inter
meta_d.lg.inter_scale_sex <- meta_d.lg.inter_scale$sex
summary(meta_d.lg.inter_scale_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_d.lg.inter_scale <- meta_results_list_scale$meta_d.lg.inter
meta_d.lg.inter_scale_age_sex <- meta_d.lg.inter_scale$age_sex
summary(meta_d.lg.inter_scale_age_sex)
```

<div style="margin-bottom:40px;">
</div>



### 5.3. Financial risk-taking{.tabset}

#### Intercept only model

##### **Meta analysis**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list <- readRDS(file = "meta_results_list.Rds")
meta_f.int <- meta_results_list$meta_f.int
meta_f.int_icc <- meta_f.int$icc
summary(meta_f.int_icc)
```

<div style="margin-bottom:40px;">
</div>


##### **Meta analysis with continent**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list_continent <- readRDS(file = "meta_results_list_continent.Rds")
meta_f.int_continent <- meta_results_list_continent$meta_f.int
meta_f.int_continent_icc <- meta_f.int_continent$icc
summary(meta_f.int_continent_icc)
```

<div style="margin-bottom:40px;">
</div>


##### **Meta analysis with mean age**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list_mean.age <- readRDS(file = "meta_results_list_mean.age.Rds")
meta_f.int_mean.age <- meta_results_list_mean.age$meta_f.int
meta_f.int_mean.age_icc <- meta_f.int_mean.age$icc
summary(meta_f.int_mean.age_icc)
```

<div style="margin-bottom:40px;">
</div>


##### **Meta analysis with scale**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list_scale <- readRDS(file = "meta_results_list_scale.Rds")
meta_f.int_scale <- meta_results_list_scale$meta_f.int
meta_f.int_scale_icc <- meta_f.int_scale$icc
summary(meta_f.int_scale_icc)
```

<div style="margin-bottom:40px;">
</div>



#### Fixed effect model

##### **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.fixed <- meta_results_list$meta_f.fixed
meta_f.fixed_age <- meta_f.fixed$age
summary(meta_f.fixed_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.fixed_continent <- meta_results_list_continent$meta_f.fixed
meta_f.fixed_continent_age <- meta_f.fixed_continent$age
summary(meta_f.fixed_continent_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.fixed_mean.age <- meta_results_list_mean.age$meta_f.fixed
meta_f.fixed_mean.age_age <- meta_f.fixed_mean.age$age
summary(meta_f.fixed_mean.age_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.fixed_scale <- meta_results_list_scale$meta_f.fixed
meta_f.fixed_scale_age <- meta_f.fixed_scale$age
summary(meta_f.fixed_scale_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg <- meta_results_list$meta_f.lg
meta_f.lg_age <- meta_f.lg$age
summary(meta_f.lg_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg_continent <- meta_results_list_continent$meta_f.lg
meta_f.lg_continent_age <- meta_f.lg_continent$age
summary(meta_f.lg_continent_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg_mean.age <- meta_results_list_mean.age$meta_f.lg
meta_f.lg_mean.age_age <- meta_f.lg_mean.age$age
summary(meta_f.lg_mean.age_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg_scale <- meta_results_list_scale$meta_f.lg
meta_f.lg_scale_age <- meta_f.lg_scale$age
summary(meta_f.lg_scale_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.sex <- meta_results_list$meta_f.lg.sex
meta_f.lg.sex_age <- meta_f.lg.sex$age
summary(meta_f.lg.sex_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.sex <- meta_results_list$meta_f.lg.sex
meta_f.lg.sex_sex <- meta_f.lg.sex$sex
summary(meta_f.lg.sex_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.sex_continent <- meta_results_list_continent$meta_f.lg.sex
meta_f.lg.sex_continent_age <- meta_f.lg.sex_continent$age
summary(meta_f.lg.sex_continent_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.sex_continent <- meta_results_list_continent$meta_f.lg.sex
meta_f.lg.sex_continent_sex <- meta_f.lg.sex_continent$sex
summary(meta_f.lg.sex_continent_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.sex_mean.age <- meta_results_list_mean.age$meta_f.lg.sex
meta_f.lg.sex_mean.age_age <- meta_f.lg.sex_mean.age$age
summary(meta_f.lg.sex_mean.age_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.sex_mean.age <- meta_results_list_mean.age$meta_f.lg.sex
meta_f.lg.sex_mean.age_sex <- meta_f.lg.sex_mean.age$sex
summary(meta_f.lg.sex_mean.age_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.sex_scale <- meta_results_list_scale$meta_f.lg.sex
meta_f.lg.sex_scale_age <- meta_f.lg.sex_scale$age
summary(meta_f.lg.sex_scale_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.sex_scale <- meta_results_list_scale$meta_f.lg.sex
meta_f.lg.sex_scale_sex <- meta_f.lg.sex_scale$sex
summary(meta_f.lg.sex_scale_sex)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender interaction model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.inter <- meta_results_list$meta_f.lg.inter
meta_f.lg.inter_age <- meta_f.lg.inter$age
summary(meta_f.lg.inter_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.inter <- meta_results_list$meta_f.lg.inter
meta_f.lg.inter_sex <- meta_f.lg.inter$sex
summary(meta_f.lg.inter_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.inter <- meta_results_list$meta_f.lg.inter
meta_f.lg.inter_age_sex <- meta_f.lg.inter$age_sex
summary(meta_f.lg.inter_age_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.inter_continent <- meta_results_list_continent$meta_f.lg.inter
meta_f.lg.inter_continent_age <- meta_f.lg.inter_continent$age
summary(meta_f.lg.inter_continent_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.inter_continent <- meta_results_list_continent$meta_f.lg.inter
meta_f.lg.inter_continent_sex <- meta_f.lg.inter_continent$sex
summary(meta_f.lg.inter_continent_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.inter_continent <- meta_results_list_continent$meta_f.lg.inter
meta_f.lg.inter_continent_age_sex <- meta_f.lg.inter_continent$age_sex
meta_f.lg.inter_continent_age_sex
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.inter_mean.age <- meta_results_list_mean.age$meta_f.lg.inter
meta_f.lg.inter_mean.age_age <- meta_f.lg.inter_mean.age$age
summary(meta_f.lg.inter_mean.age_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.inter_mean.age <- meta_results_list_mean.age$meta_f.lg.inter
meta_f.lg.inter_mean.age_sex <- meta_f.lg.inter_mean.age$sex
summary(meta_f.lg.inter_mean.age_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.inter_mean.age <- meta_results_list_mean.age$meta_f.lg.inter
meta_f.lg.inter_mean.age_age_sex <- meta_f.lg.inter_mean.age$age_sex
meta_f.lg.inter_mean.age_age_sex
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.inter_scale <- meta_results_list_scale$meta_f.lg.inter
meta_f.lg.inter_scale_age <- meta_f.lg.inter_scale$age
summary(meta_f.lg.inter_scale_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.inter_scale <- meta_results_list_scale$meta_f.lg.inter
meta_f.lg.inter_scale_sex <- meta_f.lg.inter_scale$sex
summary(meta_f.lg.inter_scale_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.lg.inter_scale <- meta_results_list_scale$meta_f.lg.inter
meta_f.lg.inter_scale_age_sex <- meta_f.lg.inter_scale$age_sex
summary(meta_f.lg.inter_scale_age_sex)
```

<div style="margin-bottom:40px;">
</div>



#### Quadratic model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad <- meta_results_list$meta_f.quad
meta_f.quad_age <- meta_f.quad$age
summary(meta_f.quad_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Age${ }^{2}$ effect**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad <- meta_results_list$meta_f.quad
meta_f.quad_age2 <- meta_f.quad$age2
summary(meta_f.quad_age2)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad_continent <- meta_results_list_continent$meta_f.quad
meta_f.quad_continent_age <- meta_f.quad_continent$age
summary(meta_f.quad_continent_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Age${ }^{2}$ effect**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad_continent <- meta_results_list_continent$meta_f.quad
meta_f.quad_continent_age2 <- meta_f.quad_continent$age2
summary(meta_f.quad_continent_age2)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad_mean.age <- meta_results_list_mean.age$meta_f.quad
meta_f.quad_mean.age_age <- meta_f.quad_mean.age$age
summary(meta_f.quad_mean.age_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Age${ }^{2}$ effect**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad_mean.age <- meta_results_list_mean.age$meta_f.quad
meta_f.quad_mean.age_age2 <- meta_f.quad_mean.age$age2
summary(meta_f.quad_mean.age_age2)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad_scale <- meta_results_list_scale$meta_f.quad
meta_f.quad_scale_age <- meta_f.quad_scale$age
summary(meta_f.quad_scale_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Age${ }^{2}$ effect**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad_scale <- meta_results_list_scale$meta_f.quad
meta_f.quad_scale_age2 <- meta_f.quad_scale$age2
summary(meta_f.quad_scale_age2)
```

<div style="margin-bottom:40px;">
</div>



#### Quadratic with gender model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad.sex <- meta_results_list$meta_f.quad.sex
meta_f.quad.sex_age <- meta_f.quad.sex$age
summary(meta_f.quad.sex_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Age${ }^{2}$ effect**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad.sex <- meta_results_list$meta_f.quad.sex
meta_f.quad.sex_age2 <- meta_f.quad.sex$age2
summary(meta_f.quad.sex_age2)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad.sex <- meta_results_list$meta_f.quad.sex
meta_f.quad.sex_sex <- meta_f.quad.sex$sex
summary(meta_f.quad.sex_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad.sex_continent <- meta_results_list_continent$meta_f.quad.sex
meta_f.quad.sex_continent_age <- meta_f.quad.sex_continent$age
summary(meta_f.quad.sex_continent_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Age${ }^{2}$ effect**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad.sex_continent <- meta_results_list_continent$meta_f.quad.sex
meta_f.quad.sex_continent_age2 <- meta_f.quad.sex_continent$age2
summary(meta_f.quad.sex_continent_age2)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad.sex_continent <- meta_results_list_continent$meta_f.quad.sex
meta_f.quad.sex_continent_sex <- meta_f.quad.sex_continent$sex
summary(meta_f.quad.sex_continent_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad.sex_mean.age <- meta_results_list_mean.age$meta_f.quad.sex
meta_f.quad.sex_mean.age_age <- meta_f.quad.sex_mean.age$age
summary(meta_f.quad.sex_mean.age_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Age${ }^{2}$ effect**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad.sex_mean.age <- meta_results_list_mean.age$meta_f.quad.sex
meta_f.quad.sex_mean.age_age2 <- meta_f.quad.sex_mean.age$age2
summary(meta_f.quad.sex_mean.age_age2)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad.sex_mean.age <- meta_results_list_mean.age$meta_f.quad.sex
meta_f.quad.sex_mean.age_sex <- meta_f.quad.sex_mean.age$sex
summary(meta_f.quad.sex_mean.age_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad.sex_scale <- meta_results_list_scale$meta_f.quad.sex
meta_f.quad.sex_scale_age <- meta_f.quad.sex_scale$age
summary(meta_f.quad.sex_scale_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Age${ }^{2}$ effect**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad.sex_scale <- meta_results_list_scale$meta_f.quad.sex
meta_f.quad.sex_scale_age2 <- meta_f.quad.sex_scale$age2
summary(meta_f.quad.sex_scale_age2)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_f.quad.sex_scale <- meta_results_list_scale$meta_f.quad.sex
meta_f.quad.sex_scale_sex <- meta_f.quad.sex_scale$sex
summary(meta_f.quad.sex_scale_sex)
```

<div style="margin-bottom:40px;">
</div>





### 5.4. Recreational risk-taking{.tabset}

#### Intercept only model

##### **Meta analysis**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list <- readRDS(file = "meta_results_list.Rds")
meta_r.int <- meta_results_list$meta_r.int
meta_r.int_icc <- meta_r.int$icc
summary(meta_r.int_icc)
```

<div style="margin-bottom:40px;">
</div>


##### **Meta analysis with continent**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list_continent <- readRDS(file = "meta_results_list_continent.Rds")
meta_r.int_continent <- meta_results_list_continent$meta_r.int
meta_r.int_continent_icc <- meta_r.int_continent$icc
summary(meta_r.int_continent_icc)
```

<div style="margin-bottom:40px;">
</div>


##### **Meta analysis with mean age**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list_mean.age <- readRDS(file = "meta_results_list_mean.age.Rds")
meta_r.int_mean.age <- meta_results_list_mean.age$meta_r.int
meta_r.int_mean.age_icc <- meta_r.int_mean.age$icc
summary(meta_r.int_mean.age_icc)
```

<div style="margin-bottom:40px;">
</div>


##### **Meta analysis with scale**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list_scale <- readRDS(file = "meta_results_list_scale.Rds")
meta_r.int_scale <- meta_results_list_scale$meta_r.int
meta_r.int_scale_icc <- meta_r.int_scale$icc
summary(meta_r.int_scale_icc)
```

<div style="margin-bottom:40px;">
</div>



#### Fixed effect model

##### **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.fixed <- meta_results_list$meta_r.fixed
meta_r.fixed_age <- meta_r.fixed$age
summary(meta_r.fixed_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.fixed_continent <- meta_results_list_continent$meta_r.fixed
meta_r.fixed_continent_age <- meta_r.fixed_continent$age
summary(meta_r.fixed_continent_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.fixed_mean.age <- meta_results_list_mean.age$meta_r.fixed
meta_r.fixed_mean.age_age <- meta_r.fixed_mean.age$age
summary(meta_r.fixed_mean.age_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.fixed_scale <- meta_results_list_scale$meta_r.fixed
meta_r.fixed_scale_age <- meta_r.fixed_scale$age
summary(meta_r.fixed_scale_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg <- meta_results_list$meta_r.lg
meta_r.lg_age <- meta_r.lg$age
summary(meta_r.lg_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg_continent <- meta_results_list_continent$meta_r.lg
meta_r.lg_continent_age <- meta_r.lg_continent$age
summary(meta_r.lg_continent_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg_mean.age <- meta_results_list_mean.age$meta_r.lg
meta_r.lg_mean.age_age <- meta_r.lg_mean.age$age
summary(meta_r.lg_mean.age_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg_scale <- meta_results_list_scale$meta_r.lg
meta_r.lg_scale_age <- meta_r.lg_scale$age
summary(meta_r.lg_scale_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.sex <- meta_results_list$meta_r.lg.sex
meta_r.lg.sex_age <- meta_r.lg.sex$age
summary(meta_r.lg.sex_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.sex <- meta_results_list$meta_r.lg.sex
meta_r.lg.sex_sex <- meta_r.lg.sex$sex
summary(meta_r.lg.sex_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.sex_continent <- meta_results_list_continent$meta_r.lg.sex
meta_r.lg.sex_continent_age <- meta_r.lg.sex_continent$age
summary(meta_r.lg.sex_continent_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.sex_continent <- meta_results_list_continent$meta_r.lg.sex
meta_r.lg.sex_continent_sex <- meta_r.lg.sex_continent$sex
summary(meta_r.lg.sex_continent_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.sex_mean.age <- meta_results_list_mean.age$meta_r.lg.sex
meta_r.lg.sex_mean.age_age <- meta_r.lg.sex_mean.age$age
summary(meta_r.lg.sex_mean.age_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.sex_mean.age <- meta_results_list_mean.age$meta_r.lg.sex
meta_r.lg.sex_mean.age_sex <- meta_r.lg.sex_mean.age$sex
summary(meta_r.lg.sex_mean.age_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.sex_scale <- meta_results_list_scale$meta_r.lg.sex
meta_r.lg.sex_scale_age <- meta_r.lg.sex_scale$age
summary(meta_r.lg.sex_scale_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.sex_scale <- meta_results_list_scale$meta_r.lg.sex
meta_r.lg.sex_scale_sex <- meta_r.lg.sex_scale$sex
summary(meta_r.lg.sex_scale_sex)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender interaction model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.inter <- meta_results_list$meta_r.lg.inter
meta_r.lg.inter_age <- meta_r.lg.inter$age
summary(meta_r.lg.inter_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.inter <- meta_results_list$meta_r.lg.inter
meta_r.lg.inter_sex <- meta_r.lg.inter$sex
summary(meta_r.lg.inter_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.inter <- meta_results_list$meta_r.lg.inter
meta_r.lg.inter_age_sex <- meta_r.lg.inter$age_sex
summary(meta_r.lg.inter_age_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.inter_continent <- meta_results_list_continent$meta_r.lg.inter
meta_r.lg.inter_continent_age <- meta_r.lg.inter_continent$age
summary(meta_r.lg.inter_continent_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.inter_continent <- meta_results_list_continent$meta_r.lg.inter
meta_r.lg.inter_continent_sex <- meta_r.lg.inter_continent$sex
summary(meta_r.lg.inter_continent_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.inter_continent <- meta_results_list_continent$meta_r.lg.inter
meta_r.lg.inter_continent_age_sex <- meta_r.lg.inter_continent$age_sex
meta_r.lg.inter_continent_age_sex
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.inter_mean.age <- meta_results_list_mean.age$meta_r.lg.inter
meta_r.lg.inter_mean.age_age <- meta_r.lg.inter_mean.age$age
summary(meta_r.lg.inter_mean.age_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.inter_mean.age <- meta_results_list_mean.age$meta_r.lg.inter
meta_r.lg.inter_mean.age_sex <- meta_r.lg.inter_mean.age$sex
summary(meta_r.lg.inter_mean.age_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.inter_mean.age <- meta_results_list_mean.age$meta_r.lg.inter
meta_r.lg.inter_mean.age_age_sex <- meta_r.lg.inter_mean.age$age_sex
meta_r.lg.inter_mean.age_age_sex
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.inter_scale <- meta_results_list_scale$meta_r.lg.inter
meta_r.lg.inter_scale_age <- meta_r.lg.inter_scale$age
summary(meta_r.lg.inter_scale_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.inter_scale <- meta_results_list_scale$meta_r.lg.inter
meta_r.lg.inter_scale_sex <- meta_r.lg.inter_scale$sex
summary(meta_r.lg.inter_scale_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_r.lg.inter_scale <- meta_results_list_scale$meta_r.lg.inter
meta_r.lg.inter_scale_age_sex <- meta_r.lg.inter_scale$age_sex
summary(meta_r.lg.inter_scale_age_sex)
```

<div style="margin-bottom:40px;">
</div>



### 5.5. Occupational risk-taking{.tabset}

#### Intercept only model

##### **Meta analysis**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list <- readRDS(file = "meta_results_list.Rds")
meta_o.int <- meta_results_list$meta_o.int
meta_o.int_icc <- meta_o.int$icc
summary(meta_o.int_icc)
```

<div style="margin-bottom:40px;">
</div>


##### **Meta analysis with continent**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list_continent <- readRDS(file = "meta_results_list_continent.Rds")
meta_o.int_continent <- meta_results_list_continent$meta_o.int
meta_o.int_continent_icc <- meta_o.int_continent$icc
summary(meta_o.int_continent_icc)
```

<div style="margin-bottom:40px;">
</div>


##### **Meta analysis with mean age**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list_mean.age <- readRDS(file = "meta_results_list_mean.age.Rds")
meta_o.int_mean.age <- meta_results_list_mean.age$meta_o.int
meta_o.int_mean.age_icc <- meta_o.int_mean.age$icc
summary(meta_o.int_mean.age_icc)
```

<div style="margin-bottom:40px;">
</div>


##### **Meta analysis with scale**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list_scale <- readRDS(file = "meta_results_list_scale.Rds")
meta_o.int_scale <- meta_results_list_scale$meta_o.int
meta_o.int_scale_icc <- meta_o.int_scale$icc
summary(meta_o.int_scale_icc)
```

<div style="margin-bottom:40px;">
</div>



#### Fixed effect model

##### **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.fixed <- meta_results_list$meta_o.fixed
meta_o.fixed_age <- meta_o.fixed$age
summary(meta_o.fixed_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.fixed_continent <- meta_results_list_continent$meta_o.fixed
meta_o.fixed_continent_age <- meta_o.fixed_continent$age
summary(meta_o.fixed_continent_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.fixed_mean.age <- meta_results_list_mean.age$meta_o.fixed
meta_o.fixed_mean.age_age <- meta_o.fixed_mean.age$age
summary(meta_o.fixed_mean.age_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.fixed_scale <- meta_results_list_scale$meta_o.fixed
meta_o.fixed_scale_age <- meta_o.fixed_scale$age
summary(meta_o.fixed_scale_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg <- meta_results_list$meta_o.lg
meta_o.lg_age <- meta_o.lg$age
summary(meta_o.lg_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg_continent <- meta_results_list_continent$meta_o.lg
meta_o.lg_continent_age <- meta_o.lg_continent$age
summary(meta_o.lg_continent_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg_mean.age <- meta_results_list_mean.age$meta_o.lg
meta_o.lg_mean.age_age <- meta_o.lg_mean.age$age
summary(meta_o.lg_mean.age_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg_scale <- meta_results_list_scale$meta_o.lg
meta_o.lg_scale_age <- meta_o.lg_scale$age
summary(meta_o.lg_scale_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.sex <- meta_results_list$meta_o.lg.sex
meta_o.lg.sex_age <- meta_o.lg.sex$age
summary(meta_o.lg.sex_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.sex <- meta_results_list$meta_o.lg.sex
meta_o.lg.sex_sex <- meta_o.lg.sex$sex
summary(meta_o.lg.sex_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.sex_continent <- meta_results_list_continent$meta_o.lg.sex
meta_o.lg.sex_continent_age <- meta_o.lg.sex_continent$age
summary(meta_o.lg.sex_continent_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.sex_continent <- meta_results_list_continent$meta_o.lg.sex
meta_o.lg.sex_continent_sex <- meta_o.lg.sex_continent$sex
summary(meta_o.lg.sex_continent_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.sex_mean.age <- meta_results_list_mean.age$meta_o.lg.sex
meta_o.lg.sex_mean.age_age <- meta_o.lg.sex_mean.age$age
summary(meta_o.lg.sex_mean.age_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.sex_mean.age <- meta_results_list_mean.age$meta_o.lg.sex
meta_o.lg.sex_mean.age_sex <- meta_o.lg.sex_mean.age$sex
summary(meta_o.lg.sex_mean.age_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.sex_scale <- meta_results_list_scale$meta_o.lg.sex
meta_o.lg.sex_scale_age <- meta_o.lg.sex_scale$age
summary(meta_o.lg.sex_scale_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.sex_scale <- meta_results_list_scale$meta_o.lg.sex
meta_o.lg.sex_scale_sex <- meta_o.lg.sex_scale$sex
summary(meta_o.lg.sex_scale_sex)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender interaction model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.inter <- meta_results_list$meta_o.lg.inter
meta_o.lg.inter_age <- meta_o.lg.inter$age
summary(meta_o.lg.inter_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.inter <- meta_results_list$meta_o.lg.inter
meta_o.lg.inter_sex <- meta_o.lg.inter$sex
summary(meta_o.lg.inter_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.inter <- meta_results_list$meta_o.lg.inter
meta_o.lg.inter_age_sex <- meta_o.lg.inter$age_sex
summary(meta_o.lg.inter_age_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.inter_continent <- meta_results_list_continent$meta_o.lg.inter
meta_o.lg.inter_continent_age <- meta_o.lg.inter_continent$age
summary(meta_o.lg.inter_continent_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.inter_continent <- meta_results_list_continent$meta_o.lg.inter
meta_o.lg.inter_continent_sex <- meta_o.lg.inter_continent$sex
summary(meta_o.lg.inter_continent_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.inter_continent <- meta_results_list_continent$meta_o.lg.inter
meta_o.lg.inter_continent_age_sex <- meta_o.lg.inter_continent$age_sex
meta_o.lg.inter_continent_age_sex
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.inter_mean.age <- meta_results_list_mean.age$meta_o.lg.inter
meta_o.lg.inter_mean.age_age <- meta_o.lg.inter_mean.age$age
summary(meta_o.lg.inter_mean.age_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.inter_mean.age <- meta_results_list_mean.age$meta_o.lg.inter
meta_o.lg.inter_mean.age_sex <- meta_o.lg.inter_mean.age$sex
summary(meta_o.lg.inter_mean.age_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.inter_mean.age <- meta_results_list_mean.age$meta_o.lg.inter
meta_o.lg.inter_mean.age_age_sex <- meta_o.lg.inter_mean.age$age_sex
meta_o.lg.inter_mean.age_age_sex
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.inter_scale <- meta_results_list_scale$meta_o.lg.inter
meta_o.lg.inter_scale_age <- meta_o.lg.inter_scale$age
summary(meta_o.lg.inter_scale_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.inter_scale <- meta_results_list_scale$meta_o.lg.inter
meta_o.lg.inter_scale_sex <- meta_o.lg.inter_scale$sex
summary(meta_o.lg.inter_scale_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_o.lg.inter_scale <- meta_results_list_scale$meta_o.lg.inter
meta_o.lg.inter_scale_age_sex <- meta_o.lg.inter_scale$age_sex
summary(meta_o.lg.inter_scale_age_sex)
```

<div style="margin-bottom:40px;">
</div>



### 5.6. Health risk-taking{.tabset}

#### Intercept only model

##### **Meta analysis**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list <- readRDS(file = "meta_results_list.Rds")
meta_h.int <- meta_results_list$meta_h.int
meta_h.int_icc <- meta_h.int$icc
summary(meta_h.int_icc)
```

<div style="margin-bottom:40px;">
</div>


##### **Meta analysis with continent**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list_continent <- readRDS(file = "meta_results_list_continent.Rds")
meta_h.int_continent <- meta_results_list_continent$meta_h.int
meta_h.int_continent_icc <- meta_h.int_continent$icc
summary(meta_h.int_continent_icc)
```

<div style="margin-bottom:40px;">
</div>


##### **Meta analysis with mean age**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list_mean.age <- readRDS(file = "meta_results_list_mean.age.Rds")
meta_h.int_mean.age <- meta_results_list_mean.age$meta_h.int
meta_h.int_mean.age_icc <- meta_h.int_mean.age$icc
summary(meta_h.int_mean.age_icc)
```

<div style="margin-bottom:40px;">
</div>


##### **Meta analysis with scale**

###### **ICC's results**
```{r, echo = F, warning = FALSE, message = FALSE}
setwd("~/Desktop/analysis/meta_analysis_risk_normalized_4/data/results_data")
meta_results_list_scale <- readRDS(file = "meta_results_list_scale.Rds")
meta_h.int_scale <- meta_results_list_scale$meta_h.int
meta_h.int_scale_icc <- meta_h.int_scale$icc
summary(meta_h.int_scale_icc)
```

<div style="margin-bottom:40px;">
</div>



#### Fixed effect model

##### **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.fixed <- meta_results_list$meta_h.fixed
meta_h.fixed_age <- meta_h.fixed$age
summary(meta_h.fixed_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.fixed_continent <- meta_results_list_continent$meta_h.fixed
meta_h.fixed_continent_age <- meta_h.fixed_continent$age
summary(meta_h.fixed_continent_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.fixed_mean.age <- meta_results_list_mean.age$meta_h.fixed
meta_h.fixed_mean.age_age <- meta_h.fixed_mean.age$age
summary(meta_h.fixed_mean.age_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.fixed_scale <- meta_results_list_scale$meta_h.fixed
meta_h.fixed_scale_age <- meta_h.fixed_scale$age
summary(meta_h.fixed_scale_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg <- meta_results_list$meta_h.lg
meta_h.lg_age <- meta_h.lg$age
summary(meta_h.lg_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg_continent <- meta_results_list_continent$meta_h.lg
meta_h.lg_continent_age <- meta_h.lg_continent$age
summary(meta_h.lg_continent_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg_mean.age <- meta_results_list_mean.age$meta_h.lg
meta_h.lg_mean.age_age <- meta_h.lg_mean.age$age
summary(meta_h.lg_mean.age_age)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg_scale <- meta_results_list_scale$meta_h.lg
meta_h.lg_scale_age <- meta_h.lg_scale$age
summary(meta_h.lg_scale_age)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.sex <- meta_results_list$meta_h.lg.sex
meta_h.lg.sex_age <- meta_h.lg.sex$age
summary(meta_h.lg.sex_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.sex <- meta_results_list$meta_h.lg.sex
meta_h.lg.sex_sex <- meta_h.lg.sex$sex
summary(meta_h.lg.sex_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.sex_continent <- meta_results_list_continent$meta_h.lg.sex
meta_h.lg.sex_continent_age <- meta_h.lg.sex_continent$age
summary(meta_h.lg.sex_continent_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.sex_continent <- meta_results_list_continent$meta_h.lg.sex
meta_h.lg.sex_continent_sex <- meta_h.lg.sex_continent$sex
summary(meta_h.lg.sex_continent_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.sex_mean.age <- meta_results_list_mean.age$meta_h.lg.sex
meta_h.lg.sex_mean.age_age <- meta_h.lg.sex_mean.age$age
summary(meta_h.lg.sex_mean.age_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.sex_mean.age <- meta_results_list_mean.age$meta_h.lg.sex
meta_h.lg.sex_mean.age_sex <- meta_h.lg.sex_mean.age$sex
summary(meta_h.lg.sex_mean.age_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.sex_scale <- meta_results_list_scale$meta_h.lg.sex
meta_h.lg.sex_scale_age <- meta_h.lg.sex_scale$age
summary(meta_h.lg.sex_scale_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.sex_scale <- meta_results_list_scale$meta_h.lg.sex
meta_h.lg.sex_scale_sex <- meta_h.lg.sex_scale$sex
summary(meta_h.lg.sex_scale_sex)
```

<div style="margin-bottom:40px;">
</div>



#### Linear with gender interaction model

#####  **Meta analysis**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.inter <- meta_results_list$meta_h.lg.inter
meta_h.lg.inter_age <- meta_h.lg.inter$age
summary(meta_h.lg.inter_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.inter <- meta_results_list$meta_h.lg.inter
meta_h.lg.inter_sex <- meta_h.lg.inter$sex
summary(meta_h.lg.inter_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.inter <- meta_results_list$meta_h.lg.inter
meta_h.lg.inter_age_sex <- meta_h.lg.inter$age_sex
summary(meta_h.lg.inter_age_sex)
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with continent**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.inter_continent <- meta_results_list_continent$meta_h.lg.inter
meta_h.lg.inter_continent_age <- meta_h.lg.inter_continent$age
summary(meta_h.lg.inter_continent_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.inter_continent <- meta_results_list_continent$meta_h.lg.inter
meta_h.lg.inter_continent_sex <- meta_h.lg.inter_continent$sex
summary(meta_h.lg.inter_continent_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.inter_continent <- meta_results_list_continent$meta_h.lg.inter
meta_h.lg.inter_continent_age_sex <- meta_h.lg.inter_continent$age_sex
meta_h.lg.inter_continent_age_sex
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with mean age**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.inter_mean.age <- meta_results_list_mean.age$meta_h.lg.inter
meta_h.lg.inter_mean.age_age <- meta_h.lg.inter_mean.age$age
summary(meta_h.lg.inter_mean.age_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.inter_mean.age <- meta_results_list_mean.age$meta_h.lg.inter
meta_h.lg.inter_mean.age_sex <- meta_h.lg.inter_mean.age$sex
summary(meta_h.lg.inter_mean.age_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.inter_mean.age <- meta_results_list_mean.age$meta_h.lg.inter
meta_h.lg.inter_mean.age_age_sex <- meta_h.lg.inter_mean.age$age_sex
meta_h.lg.inter_mean.age_age_sex
```

<div style="margin-bottom:40px;">
</div>


#####  **Meta analysis with scale**

###### **Age effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.inter_scale <- meta_results_list_scale$meta_h.lg.inter
meta_h.lg.inter_scale_age <- meta_h.lg.inter_scale$age
summary(meta_h.lg.inter_scale_age)
```

<div style="margin-bottom:20px;">
</div>

###### **Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.inter_scale <- meta_results_list_scale$meta_h.lg.inter
meta_h.lg.inter_scale_sex <- meta_h.lg.inter_scale$sex
summary(meta_h.lg.inter_scale_sex)
```

<div style="margin-bottom:20px;">
</div>

###### **Age $\times$ Gender effect results**
```{r, echo = F, warning = FALSE, message = FALSE}
meta_h.lg.inter_scale <- meta_results_list_scale$meta_h.lg.inter
meta_h.lg.inter_scale_age_sex <- meta_h.lg.inter_scale$age_sex
summary(meta_h.lg.inter_scale_age_sex)
```

<div style="margin-bottom:40px;">
</div>



### 5.7. Social risk-taking{.tabset}

<div style="margin-bottom:40px;">
</div>
 


 

## 6. Meta analytic summary of slope estimates {.tabset}

### Intercept-only model
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 5, fig.height = 3}
domains <- c("General", "Driving", "Financial", "Recreational", "Occupational", "Health", "Social")
colordata <- data.frame(matrix(data=NA, nrow=length(domains), ncol = 1)) 
colordata <- as.data.frame(matrix(domains))
colnames(colordata) <- "domains_name"
colordata$domains_name<- as.factor(colordata$domains_name) 

setwd("/Users/yliu/Desktop/analysis/meta_analysis_risk_normalized_4/data")
combine_meta_summary_list <- readRDS(file = "results_data/combine_meta_summary_list.Rds")

plot_data <- combine_meta_summary_list$meta_int$icc
plot_data$Domain = factor(plot_data$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

ggplot(data=plot_data, aes(x = Domain, y = b)) + 
      geom_point(aes(group=Domain, colour=Domain), size  = 3) +
      scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
      geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
      labs(x="Domain", y= "Coefficient", title="ICC") + 
      coord_flip(ylim = c(0,0.6)) +
      theme_minimal() +
      theme(legend.position = "none") +
      theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
      theme(panel.border = element_rect(colour = "black", fill=NA))
```

<div style="margin-bottom:40px;">
</div>



### Fixed effect model
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 5, fig.height = 3}
plot_data <- combine_meta_summary_list$meta_fixed$age
plot_data$Domain = factor(plot_data$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

ggplot(data=plot_data, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Coefficient", title="Age") +
  coord_flip(ylim = c(-0.25,0.05)) +
  theme_minimal() +
  theme(legend.position = "none") +
  theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))

```

<div style="margin-bottom:40px;">
</div>



### Linear model
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 5, fig.height = 3}
plot_data <- combine_meta_summary_list$meta_lg$age
plot_data$Domain = factor(plot_data$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

ggplot(data=plot_data, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Coefficient", title="Age") +
  coord_flip(ylim = c(-0.25,0.05)) +
  theme_minimal() +
  theme(legend.position = "none") +
  theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))
```

<div style="margin-bottom:40px;">
</div>



### Linear with gender model
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 3}
plot_data1 <- combine_meta_summary_list$meta_lg.sex$age
plot_data1$Domain = factor(plot_data1$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

plot_data2 <- combine_meta_summary_list$meta_lg.sex$sex
plot_data2$Domain = factor(plot_data2$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

p1 <- ggplot(data=plot_data1, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Coefficient", title="Age") +
  coord_flip(ylim = c(-0.25,0.05)) +
  theme_minimal() +
  theme(legend.position = "none") +
  theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))

p2 <- ggplot(data=plot_data2, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Coefficient", title="Gender") +
  coord_flip(ylim = c(-0.5,0.05)) +
  theme_minimal() +
  theme(legend.position = "none") +
  theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))+
  theme(axis.title.y = element_blank(), axis.text.y=element_blank())

grid.arrange(p1, p2, ncol=2)

```

<div style="margin-bottom:40px;">
</div>



### Linear with gender interaction model
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 15, fig.height = 3}
plot_data1 <- combine_meta_summary_list$meta_lg.inter$age
plot_data1$Domain = factor(plot_data1$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

plot_data2 <- combine_meta_summary_list$meta_lg.inter$sex
plot_data2$Domain = factor(plot_data2$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))
      
plot_data3 <- combine_meta_summary_list$meta_lg.inter$age_sex
plot_data3$Domain = factor(plot_data3$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General")) 

p1 <- ggplot(data=plot_data1, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Coefficient", title="Age") +
  coord_flip(ylim = c(-0.25,0.05)) +
  theme_minimal() +
  theme(legend.position = "none") +
  theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))

p2 <- ggplot(data=plot_data2, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Coefficient", title="Gender") +
  coord_flip(ylim = c(-0.5,0.05)) +
  theme_minimal() +
  theme(legend.position = "none") +
  theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))+
  theme(axis.title.y = element_blank(), axis.text.y=element_blank())

p3 <- ggplot(data=plot_data3, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Coefficient", title=TeX("Age $\\times$ Gender")) +
  coord_flip(ylim = c(-0.1, 0.1)) +
  theme_minimal() +
  theme(legend.position = "none") +
  theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))+
  theme(axis.title.y = element_blank(), axis.text.y=element_blank())

grid.arrange(p1, p2, p3, ncol=3)
```
<div style="margin-bottom:40px;">
</div>



### Quadratic model
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 10, fig.height = 3}
plot_data1 <- combine_meta_summary_list$meta_quad$age
plot_data1$Domain = factor(plot_data1$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

plot_data2 <- combine_meta_summary_list$meta_quad$age2
plot_data2$Domain = factor(plot_data2$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

p1 <- ggplot(data=plot_data1, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Coefficient", title=TeX('$\\mathrm{Age}^{\\,}$')) +
  coord_flip(ylim = c(-0.2, 0.05)) +
  theme_minimal() +
  theme(legend.position = "none") +
  theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))

p2 <- ggplot(data=plot_data2, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Coefficient", title=TeX('$\\mathrm{Age} ^{2}$')) +
  coord_flip(ylim = c(-0.02, 0.02)) +
  theme_minimal() +
  theme(legend.position = "none") +
  theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA)) +
  theme(axis.title.y = element_blank(), axis.text.y=element_blank())

grid.arrange(p1, p2, ncol=2)
```

<div style="margin-bottom:40px;">
</div>



### Quadratic with gender model
```{r, echo = F, warning = FALSE, message = FALSE, fig.width = 15, fig.height = 3}
plot_data1 <- combine_meta_summary_list$meta_quad.sex$age
plot_data1$Domain = factor(plot_data1$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

plot_data2 <- combine_meta_summary_list$meta_quad.sex$age2
plot_data1$Domain = factor(plot_data2$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))
  
plot_data3 <- combine_meta_summary_list$meta_quad.sex$sex
plot_data3$Domain = factor(plot_data3$Domain, levels = c("Social", "Health", "Occupational", "Recreational", "Financial", "Driving","General"))

p1 <- ggplot(data=plot_data1, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Coefficient", title=expression("Age")) +
  coord_flip(ylim = c(-0.2, 0.05)) +
  theme_minimal() +
  theme(legend.position = "none") +
  theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))

p2 <- ggplot(data=plot_data2, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) + 
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Coefficient", title=expression("Age"^2)) +
  coord_flip(ylim = c(-0.02, 0.02)) +
  theme_minimal() +
  theme(legend.position = "none") +
  theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA))+
  theme(axis.title.y = element_blank(), axis.text.y=element_blank())

p3 <- ggplot(data=plot_data3, aes(x = Domain, y = b)) + 
  geom_point(aes(group=Domain, colour=Domain), size  = 3) +
  scale_colour_discrete(drop=FALSE,limits = levels(colordata$domains_name)) +
  geom_errorbar(aes(ymin = CI.lb, ymax = CI.ub, group=Domain, colour=Domain), width = 0.4, size  = 0.7) +
  geom_hline(yintercept = 0, linetype = 2, size = 0.8) +
  labs(x="Domain", y= "Coefficient", title=expression("Gender")) +
  coord_flip(ylim = c(-0.5, 0.05)) +
  theme_minimal() +
  theme(legend.position = "none") +
  theme(axis.text=element_text(size=9.5), strip.text = element_text(size = 9.5),axis.title.x = element_text(size = 15, face="bold"),axis.title.y = element_text(size = 15, face="bold"), plot.title = element_text(size=16, hjust = 0, vjust = 2, face="bold")) +
  theme(panel.border = element_rect(colour = "black", fill=NA)) +
  theme(legend.position = "none") +
  theme(axis.title.y = element_blank(), axis.text.y=element_blank())

grid.arrange(p1, p2, p3, ncol=3)
```

<div style="margin-bottom:40px;">
</div>


